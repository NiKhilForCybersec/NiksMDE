<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ASR Rule Reference | MDE Ultimate Guide</title>
    <link rel="stylesheet" href="main.css">
</head>
<body>
    <header class="header">
        <div class="header-left">
            <button class="mobile-menu-btn" aria-label="Toggle menu">â˜°</button>
            <a href="index.html" class="logo">
                <div class="logo-icon">MDE</div>
                <div class="logo-text"><span>MDE</span> Ultimate Guide</div>
            </a>
        </div>
        <div class="search-container">
            <button class="search-btn">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="11" cy="11" r="8"></circle>
                    <path d="M21 21l-4.35-4.35"></path>
                </svg>
                <span>Search documentation...</span>
                <span class="search-shortcut"><kbd>âŒ˜</kbd><kbd>K</kbd></span>
            </button>
        </div>
        <div class="header-right">
            <a href="12-2-interview-questions.html" class="header-link">Interview Prep</a>
            <a href="5-3-kql-fundamentals.html" class="header-link">KQL Guide</a>
        </div>
    </header>

    <div class="sidebar-overlay"></div>
    <aside class="sidebar"></aside>

    <main class="main-content">
        <div class="content-wrapper">
            <div class="overview-box">
                <h4>ğŸ¯ What This Page Covers</h4>
                <p>Complete reference for all Attack Surface Reduction (ASR) rules. Includes GUIDs, descriptions, MITRE ATT&CK mappings, and recommended configurations.</p>
            </div>

            <h1>ASR Rule Reference</h1>

            <p>This page provides a comprehensive reference for all Attack Surface Reduction rules available in Microsoft Defender for Endpoint.</p>

            <h2>Rule Modes</h2>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">ASR Rule Modes</span>
                    <button class="code-copy">ğŸ“‹ Copy</button>
                </div>
                <div class="code-content">
<pre><code>ASR RULE MODES:

MODE          VALUE    BEHAVIOR
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Disabled      0        Rule is off, no action taken
Block         1        Rule enforced, action blocked
Audit         2        Rule logs only, no blocking
Warn          6        User warned, can proceed

RECOMMENDATION:
1. Deploy all rules in Audit mode (2)
2. Monitor for 2-4 weeks
3. Create exclusions for legitimate blocks
4. Enable Block mode (1) for validated rules
5. Continue monitoring after enabling</code></pre>
                </div>
            </div>

            <h2>Office Application Rules</h2>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">Office Rules</span>
                    <button class="code-copy">ğŸ“‹ Copy</button>
                </div>
                <div class="code-content">
<pre><code>BLOCK OFFICE APPS FROM CREATING CHILD PROCESSES
GUID: D4F940AB-401B-4EFC-AADC-AD5F3C50688A
â”œâ”€â”€ Blocks: Office apps spawning cmd, PowerShell, etc.
â”œâ”€â”€ MITRE: T1204.002 (Malicious File)
â”œâ”€â”€ Impact: May block legitimate macros
â””â”€â”€ Recommendation: Block (with exclusions)

BLOCK OFFICE APPS FROM CREATING EXECUTABLE CONTENT
GUID: 3B576869-A4EC-4529-8536-B80A7769E899
â”œâ”€â”€ Blocks: Office writing EXE, DLL, scripts
â”œâ”€â”€ MITRE: T1204.002 (Malicious File)
â”œâ”€â”€ Impact: Blocks macro-created executables
â””â”€â”€ Recommendation: Block

BLOCK OFFICE APPS FROM INJECTING CODE INTO OTHER PROCESSES
GUID: 75668C1F-73B5-4CF0-BB93-3ECF5CB7CC84
â”œâ”€â”€ Blocks: Office process injection
â”œâ”€â”€ MITRE: T1055 (Process Injection)
â”œâ”€â”€ Impact: Low, injection is rarely legitimate
â””â”€â”€ Recommendation: Block

BLOCK WIN32 API CALLS FROM OFFICE MACROS
GUID: 92E97FA1-2EDF-4476-BDD6-9DD0B4DDDC7B
â”œâ”€â”€ Blocks: Win32 API calls from VBA
â”œâ”€â”€ MITRE: T1106 (Native API)
â”œâ”€â”€ Impact: May break some macros
â””â”€â”€ Recommendation: Audit first, then Block

BLOCK OFFICE COMMUNICATION APPS FROM CREATING CHILD PROCESSES
GUID: 26190899-1602-49E8-8B27-EB1D0A1CE869
â”œâ”€â”€ Blocks: Outlook spawning processes
â”œâ”€â”€ MITRE: T1566.001 (Spearphishing Attachment)
â”œâ”€â”€ Impact: Low for most users
â””â”€â”€ Recommendation: Block</code></pre>
                </div>
            </div>

            <h2>Script & Email Rules</h2>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">Script and Email Rules</span>
                    <button class="code-copy">ğŸ“‹ Copy</button>
                </div>
                <div class="code-content">
<pre><code>BLOCK JAVASCRIPT OR VBSCRIPT FROM LAUNCHING DOWNLOADED CONTENT
GUID: D3E037E1-3EB8-44C8-A917-57927947596D
â”œâ”€â”€ Blocks: JS/VBS executing downloads
â”œâ”€â”€ MITRE: T1059.005, T1059.007 (Scripting)
â”œâ”€â”€ Impact: Blocks drive-by downloads
â””â”€â”€ Recommendation: Block

BLOCK EXECUTION OF POTENTIALLY OBFUSCATED SCRIPTS
GUID: 5BEB7EFE-FD9A-4556-801D-275E5FFC04CC
â”œâ”€â”€ Blocks: Obfuscated script execution
â”œâ”€â”€ MITRE: T1027 (Obfuscated Files)
â”œâ”€â”€ Impact: May affect legitimate obfuscated code
â””â”€â”€ Recommendation: Block (with exclusions)

BLOCK EXECUTABLE CONTENT FROM EMAIL CLIENT AND WEBMAIL
GUID: BE9BA2D9-53EA-4CDC-84E5-9B1EEEE46550
â”œâ”€â”€ Blocks: Executables from Outlook, webmail
â”œâ”€â”€ MITRE: T1566.001 (Spearphishing)
â”œâ”€â”€ Impact: Low, executables in email are risky
â””â”€â”€ Recommendation: Block

BLOCK UNTRUSTED AND UNSIGNED PROCESSES FROM USB
GUID: B2B3F03D-6A65-4F7B-A9C7-1C7EF74A9BA4
â”œâ”€â”€ Blocks: Unsigned executables from USB
â”œâ”€â”€ MITRE: T1091 (Replication Through Removable)
â”œâ”€â”€ Impact: May block legitimate USB tools
â””â”€â”€ Recommendation: Block (with exclusions)</code></pre>
                </div>
            </div>

            <h2>Credential & Lateral Movement Rules</h2>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">Credential Protection Rules</span>
                    <button class="code-copy">ğŸ“‹ Copy</button>
                </div>
                <div class="code-content">
<pre><code>BLOCK CREDENTIAL STEALING FROM LSASS
GUID: 9E6C4E1F-7D60-472F-BA1A-A39EF669E4B2
â”œâ”€â”€ Blocks: Suspicious LSASS access
â”œâ”€â”€ MITRE: T1003.001 (LSASS Memory)
â”œâ”€â”€ Impact: May block security tools
â”œâ”€â”€ Exclusions: Known security products
â””â”€â”€ Recommendation: Block (critical rule)

BLOCK PROCESS CREATIONS FROM PSEXEC AND WMI COMMANDS
GUID: D1E49AAC-8F56-4280-B9BA-993A6D77406C
â”œâ”€â”€ Blocks: PsExec/WMI remote execution
â”œâ”€â”€ MITRE: T1047, T1569.002 (WMI, Service Exec)
â”œâ”€â”€ Impact: May block admin tools
â”œâ”€â”€ Exclusions: Authorized management tools
â””â”€â”€ Recommendation: Block (with exclusions)

BLOCK PERSISTENCE THROUGH WMI EVENT SUBSCRIPTION
GUID: E6DB77E5-3DF2-4CF1-B95A-636979351E5B
â”œâ”€â”€ Blocks: WMI persistence mechanisms
â”œâ”€â”€ MITRE: T1546.003 (WMI Event Subscription)
â”œâ”€â”€ Impact: Low, rarely legitimate
â””â”€â”€ Recommendation: Block</code></pre>
                </div>
            </div>

            <h2>Ransomware & Exploit Rules</h2>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">Ransomware Protection Rules</span>
                    <button class="code-copy">ğŸ“‹ Copy</button>
                </div>
                <div class="code-content">
<pre><code>USE ADVANCED PROTECTION AGAINST RANSOMWARE
GUID: C1DB55AB-C21A-4637-BB3F-A12568109D35
â”œâ”€â”€ Blocks: Ransomware-like behavior
â”œâ”€â”€ MITRE: T1486 (Data Encrypted for Impact)
â”œâ”€â”€ Impact: Low false positive rate
â”œâ”€â”€ Uses: Machine learning detection
â””â”€â”€ Recommendation: Block

BLOCK ABUSE OF EXPLOITED VULNERABLE SIGNED DRIVERS
GUID: 56A863A9-875E-4185-98A7-B882C64B5CE5
â”œâ”€â”€ Blocks: Known vulnerable drivers
â”œâ”€â”€ MITRE: T1068 (Exploitation for Privilege)
â”œâ”€â”€ Impact: May block legitimate old drivers
â”œâ”€â”€ Updates: Microsoft updates blocklist
â””â”€â”€ Recommendation: Block

BLOCK EXECUTABLE FILES FROM RUNNING UNLESS THEY MEET CRITERIA
GUID: 01443614-CD74-433A-B99E-2ECDC07BFC25
â”œâ”€â”€ Blocks: Unsigned/untrusted executables
â”œâ”€â”€ MITRE: Multiple techniques
â”œâ”€â”€ Impact: HIGH - very restrictive
â”œâ”€â”€ Note: Requires prevalence/age/trusted list
â””â”€â”€ Recommendation: Audit first, careful deployment

BLOCK ADOBE READER FROM CREATING CHILD PROCESSES
GUID: 7674BA52-37EB-4A4F-A9A1-F0F9A1619A2C
â”œâ”€â”€ Blocks: Adobe Reader spawning processes
â”œâ”€â”€ MITRE: T1203 (Exploitation for Client Exec)
â”œâ”€â”€ Impact: Blocks PDF exploits
â””â”€â”€ Recommendation: Block</code></pre>
                </div>
            </div>

            <h2>Complete GUID Reference</h2>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">All ASR Rule GUIDs</span>
                    <button class="code-copy">ğŸ“‹ Copy</button>
                </div>
                <div class="code-content">
<pre><code>COMPLETE ASR RULE GUID LIST:

# Office Rules
D4F940AB-401B-4EFC-AADC-AD5F3C50688A  # Block Office child processes
3B576869-A4EC-4529-8536-B80A7769E899  # Block Office executable content
75668C1F-73B5-4CF0-BB93-3ECF5CB7CC84  # Block Office code injection
92E97FA1-2EDF-4476-BDD6-9DD0B4DDDC7B  # Block Win32 API from macros
26190899-1602-49E8-8B27-EB1D0A1CE869  # Block Outlook child processes

# Script Rules
D3E037E1-3EB8-44C8-A917-57927947596D  # Block JS/VBS downloads
5BEB7EFE-FD9A-4556-801D-275E5FFC04CC  # Block obfuscated scripts

# Email Rules
BE9BA2D9-53EA-4CDC-84E5-9B1EEEE46550  # Block email executables

# Credential Rules
9E6C4E1F-7D60-472F-BA1A-A39EF669E4B2  # Block LSASS credential theft

# Lateral Movement Rules
D1E49AAC-8F56-4280-B9BA-993A6D77406C  # Block PSExec/WMI
E6DB77E5-3DF2-4CF1-B95A-636979351E5B  # Block WMI persistence

# USB Rules
B2B3F03D-6A65-4F7B-A9C7-1C7EF74A9BA4  # Block unsigned USB executables

# Ransomware Rules
C1DB55AB-C21A-4637-BB3F-A12568109D35  # Advanced ransomware protection

# Exploit Rules
56A863A9-875E-4185-98A7-B882C64B5CE5  # Block vulnerable drivers
01443614-CD74-433A-B99E-2ECDC07BFC25  # Block untrusted executables
7674BA52-37EB-4A4F-A9A1-F0F9A1619A2C  # Block Adobe Reader child processes</code></pre>
                </div>
            </div>

            <h2>PowerShell Configuration</h2>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">PowerShell ASR Commands</span>
                    <button class="code-copy">ğŸ“‹ Copy</button>
                </div>
                <div class="code-content">
<pre><code><span class="comment"># View current ASR rules status</span>
Get-MpPreference | Select-Object -ExpandProperty AttackSurfaceReductionRules_Ids
Get-MpPreference | Select-Object -ExpandProperty AttackSurfaceReductionRules_Actions

<span class="comment"># Enable rule in Block mode</span>
Add-MpPreference -AttackSurfaceReductionRules_Ids "D4F940AB-401B-4EFC-AADC-AD5F3C50688A" `
    -AttackSurfaceReductionRules_Actions Enabled

<span class="comment"># Enable rule in Audit mode</span>
Add-MpPreference -AttackSurfaceReductionRules_Ids "D4F940AB-401B-4EFC-AADC-AD5F3C50688A" `
    -AttackSurfaceReductionRules_Actions AuditMode

<span class="comment"># Enable all recommended rules in Block mode</span>
$rules = @(
    "BE9BA2D9-53EA-4CDC-84E5-9B1EEEE46550",
    "D4F940AB-401B-4EFC-AADC-AD5F3C50688A",
    "3B576869-A4EC-4529-8536-B80A7769E899",
    "75668C1F-73B5-4CF0-BB93-3ECF5CB7CC84",
    "D3E037E1-3EB8-44C8-A917-57927947596D",
    "5BEB7EFE-FD9A-4556-801D-275E5FFC04CC",
    "92E97FA1-2EDF-4476-BDD6-9DD0B4DDDC7B",
    "9E6C4E1F-7D60-472F-BA1A-A39EF669E4B2",
    "B2B3F03D-6A65-4F7B-A9C7-1C7EF74A9BA4",
    "D1E49AAC-8F56-4280-B9BA-993A6D77406C",
    "E6DB77E5-3DF2-4CF1-B95A-636979351E5B",
    "C1DB55AB-C21A-4637-BB3F-A12568109D35"
)
foreach ($rule in $rules) {
    Add-MpPreference -AttackSurfaceReductionRules_Ids $rule `
        -AttackSurfaceReductionRules_Actions Enabled
}

<span class="comment"># Add exclusion for specific rule</span>
Add-MpPreference -AttackSurfaceReductionOnlyExclusions "C:\Program Files\TrustedApp\"</code></pre>
                </div>
            </div>

            <div class="callout tip">
                <div class="callout-icon">ğŸ’¡</div>
                <div class="callout-content">
                    <h5>Deployment Strategy</h5>
                    <ul>
                        <li><strong>Phase 1</strong>: Enable all rules in Audit mode</li>
                        <li><strong>Phase 2</strong>: Monitor for 2-4 weeks, create exclusions</li>
                        <li><strong>Phase 3</strong>: Enable low-impact rules in Block mode</li>
                        <li><strong>Phase 4</strong>: Enable remaining rules incrementally</li>
                        <li><strong>Ongoing</strong>: Monitor and adjust exclusions as needed</li>
                    </ul>
                </div>
            </div>

            <!-- Interview Tips -->
            <div class="interview-tips">
                <h3>ğŸ’¡ Key Interview Points</h3>
                <ul>
                    <li><strong>Rule modes</strong>: Disabled (0), Block (1), Audit (2), Warn (6)</li>
                    <li><strong>Top rules</strong>: LSASS protection, Office child processes, ransomware protection</li>
                    <li><strong>Deployment</strong>: Audit first, then Block after validation</li>
                    <li><strong>Configuration</strong>: GPO, Intune, or PowerShell</li>
                    <li><strong>Key GUIDs</strong>: Know the purpose of major rules by GUID</li>
                </ul>
            </div>

            <nav class="page-nav">
                <a href="3-2-attack-surface-reduction.html" class="page-nav-link prev">
                    <span class="page-nav-label">â† Previous</span>
                    <span class="page-nav-title">Attack Surface Reduction</span>
                </a>
                <a href="3-4-controlled-folder-access.html" class="page-nav-link next">
                    <span class="page-nav-label">Next â†’</span>
                    <span class="page-nav-title">Controlled Folder Access</span>
                </a>
            </nav>
        </div>
    </main>

    <div class="search-modal">
        <div class="search-modal-content">
            <div class="search-modal-input-wrapper">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="11" cy="11" r="8"></circle>
                    <path d="M21 21l-4.35-4.35"></path>
                </svg>
                <input type="text" class="search-modal-input" placeholder="Search pages..." autofocus>
                <button class="search-modal-close">ESC</button>
            </div>
            <div class="search-results"></div>
        </div>
    </div>
    <script src="main.js"></script>
</body>
</html>
