<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Exploit Protection | MDE Ultimate Guide</title>
    <link rel="stylesheet" href="main.css">
</head>
<body>
    <header class="header">
        <div class="header-left">
            <button class="mobile-menu-btn" aria-label="Toggle menu">â˜°</button>
            <a href="index.html" class="logo">
                <div class="logo-icon">MDE</div>
                <div class="logo-text"><span>MDE</span> Ultimate Guide</div>
            </a>
        </div>
        <div class="search-container">
            <button class="search-btn">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="11" cy="11" r="8"></circle>
                    <path d="M21 21l-4.35-4.35"></path>
                </svg>
                <span>Search documentation...</span>
                <span class="search-shortcut"><kbd>âŒ˜</kbd><kbd>K</kbd></span>
            </button>
        </div>
        <div class="header-right">
            <a href="12-2-interview-questions.html" class="header-link">Interview Prep</a>
            <a href="5-3-kql-fundamentals.html" class="header-link">KQL Guide</a>
        </div>
    </header>

    <div class="sidebar-overlay"></div>
    <aside class="sidebar"></aside>

    <main class="main-content">
        <div class="content-wrapper">
            <div class="overview-box">
                <h4>ğŸ¯ What This Page Covers</h4>
                <p>Complete guide to Exploit Protection in MDE. Learn system-level and application-level mitigations, how they prevent exploitation techniques, configuration methods, and troubleshooting.</p>
            </div>

            <h1>Exploit Protection</h1>

            <p>Exploit Protection applies exploit mitigation techniques to protect against memory corruption and code execution attacks. It's the successor to EMET (Enhanced Mitigation Experience Toolkit) and is built into Windows 10/11.</p>

            <h2>Protection Types</h2>

            <div class="flow-diagram">
                <div class="diagram-title">Exploit Protection Categories</div>
<pre>
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    EXPLOIT PROTECTION MITIGATIONS                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  SYSTEM-LEVEL MITIGATIONS (Apply to entire OS)                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ â€¢ Control Flow Guard (CFG)      â€¢ Data Execution Prevention    â”‚   â”‚
â”‚  â”‚ â€¢ Force randomization (ASLR)    â€¢ Randomize memory allocations â”‚   â”‚
â”‚  â”‚ â€¢ Validate exception chains     â€¢ Validate heap integrity      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                          â”‚
â”‚  APPLICATION-LEVEL MITIGATIONS (Per-application settings)               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ â€¢ Arbitrary code guard (ACG)    â€¢ Block low integrity images    â”‚   â”‚
â”‚  â”‚ â€¢ Block remote images           â€¢ Block untrusted fonts         â”‚   â”‚
â”‚  â”‚ â€¢ Code integrity guard          â€¢ Disable extension points      â”‚   â”‚
â”‚  â”‚ â€¢ Disable Win32k system calls   â€¢ Don't allow child processes   â”‚   â”‚
â”‚  â”‚ â€¢ Export address filtering      â€¢ Import address filtering      â”‚   â”‚
â”‚  â”‚ â€¢ Simulate execution (SimExec)  â€¢ Validate API invocation       â”‚   â”‚
â”‚  â”‚ â€¢ Validate stack integrity      â€¢ Validate image dependency     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</pre>
            </div>

            <h2>Key Mitigations Explained</h2>

            <div class="table-wrapper">
                <table>
                    <thead>
                        <tr>
                            <th>Mitigation</th>
                            <th>Protection</th>
                            <th>Attack Prevented</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>DEP (Data Execution Prevention)</strong></td>
                            <td>Marks memory as non-executable</td>
                            <td>Buffer overflow code execution</td>
                        </tr>
                        <tr>
                            <td><strong>ASLR (Address Space Layout Randomization)</strong></td>
                            <td>Randomizes memory addresses</td>
                            <td>Return-oriented programming (ROP)</td>
                        </tr>
                        <tr>
                            <td><strong>CFG (Control Flow Guard)</strong></td>
                            <td>Validates indirect call targets</td>
                            <td>Control flow hijacking</td>
                        </tr>
                        <tr>
                            <td><strong>ACG (Arbitrary Code Guard)</strong></td>
                            <td>Prevents dynamic code generation</td>
                            <td>JIT spraying, shellcode</td>
                        </tr>
                        <tr>
                            <td><strong>EAF (Export Address Filtering)</strong></td>
                            <td>Protects export address table</td>
                            <td>Shellcode API resolution</td>
                        </tr>
                        <tr>
                            <td><strong>IAF (Import Address Filtering)</strong></td>
                            <td>Protects import address table</td>
                            <td>IAT hooking attacks</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <h2>Configuration Methods</h2>

            <h3>Windows Security App</h3>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">GUI Configuration</span>
                    <button class="code-copy">ğŸ“‹ Copy</button>
                </div>
                <div class="code-content">
<pre><code>ACCESS EXPLOIT PROTECTION:
Windows Security â†’ App & browser control â†’ Exploit protection settings

SYSTEM SETTINGS:
â”œâ”€â”€ Control flow guard (CFG): On by default
â”œâ”€â”€ Data Execution Prevention (DEP): On by default
â”œâ”€â”€ Force randomization for images (ASLR): On by default
â”œâ”€â”€ Randomize memory allocations: On by default
â”œâ”€â”€ Validate exception chains (SEHOP): On by default
â””â”€â”€ Validate heap integrity: On by default

PROGRAM SETTINGS:
â”œâ”€â”€ Add program to customize
â”œâ”€â”€ Override system settings per-app
â”œâ”€â”€ Can enable additional protections
â””â”€â”€ Can disable if causing issues</code></pre>
                </div>
            </div>

            <h3>PowerShell Configuration</h3>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">PowerShell - Exploit Protection</span>
                    <button class="code-copy">ğŸ“‹ Copy</button>
                </div>
                <div class="code-content">
<pre><code><span class="comment"># View current system settings</span>
<span class="function">Get-ProcessMitigation</span> <span class="variable">-System</span>

<span class="comment"># View settings for specific application</span>
<span class="function">Get-ProcessMitigation</span> <span class="variable">-Name</span> <span class="string">"chrome.exe"</span>

<span class="comment"># Enable DEP for an application</span>
<span class="function">Set-ProcessMitigation</span> <span class="variable">-Name</span> <span class="string">"app.exe"</span> <span class="variable">-Enable</span> DEP

<span class="comment"># Enable ASLR for an application</span>
<span class="function">Set-ProcessMitigation</span> <span class="variable">-Name</span> <span class="string">"app.exe"</span> <span class="variable">-Enable</span> ForceRelocateImages

<span class="comment"># Enable CFG for an application</span>
<span class="function">Set-ProcessMitigation</span> <span class="variable">-Name</span> <span class="string">"app.exe"</span> <span class="variable">-Enable</span> CFG

<span class="comment"># Disable a mitigation (if causing issues)</span>
<span class="function">Set-ProcessMitigation</span> <span class="variable">-Name</span> <span class="string">"legacy.exe"</span> <span class="variable">-Disable</span> DEP

<span class="comment"># Export current configuration</span>
<span class="function">Get-ProcessMitigation</span> <span class="variable">-RegistryConfigFilePath</span> <span class="string">"C:\EP-Config.xml"</span>

<span class="comment"># Import configuration</span>
<span class="function">Set-ProcessMitigation</span> <span class="variable">-PolicyFilePath</span> <span class="string">"C:\EP-Config.xml"</span></code></pre>
                </div>
            </div>

            <h3>Intune Configuration</h3>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">Intune Deployment</span>
                    <button class="code-copy">ğŸ“‹ Copy</button>
                </div>
                <div class="code-content">
<pre><code>INTUNE CONFIGURATION:

PATH:
Endpoint security â†’ Attack surface reduction â†’ Create policy
Platform: Windows 10 and later
Profile: Exploit protection

SYSTEM-LEVEL SETTINGS:
â”œâ”€â”€ Control flow guard (CFG): Use default (On)
â”œâ”€â”€ Data Execution Prevention (DEP): Use default (On)
â”œâ”€â”€ Force randomization for images: Use default (On)
â”œâ”€â”€ Randomize memory allocations: Use default (On)
â”œâ”€â”€ Validate exception chains: Use default (On)
â””â”€â”€ Validate heap integrity: Use default (On)

APPLICATION-LEVEL:
â”œâ”€â”€ Add applications by name or path
â”œâ”€â”€ Configure per-app mitigations
â””â”€â”€ Can use XML for complex configs

IMPORTING XML CONFIG:
â”œâ”€â”€ Create XML with desired settings
â”œâ”€â”€ Devices â†’ Configuration profiles â†’ Create
â”œâ”€â”€ Templates â†’ Custom
â”œâ”€â”€ OMA-URI for exploit protection
â””â”€â”€ Upload XML file</code></pre>
                </div>
            </div>

            <h2>Application-Specific Settings</h2>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">Recommended App Protections</span>
                    <button class="code-copy">ğŸ“‹ Copy</button>
                </div>
                <div class="code-content">
<pre><code>HIGH-RISK APPLICATIONS TO PROTECT:

WEB BROWSERS:
â”œâ”€â”€ chrome.exe, msedge.exe, firefox.exe
â”œâ”€â”€ Recommended: All mitigations enabled
â””â”€â”€ Most support all protections

OFFICE APPLICATIONS:
â”œâ”€â”€ WINWORD.EXE, EXCEL.EXE, POWERPNT.EXE, OUTLOOK.EXE
â”œâ”€â”€ Recommended: 
â”‚   â”œâ”€â”€ DEP: On
â”‚   â”œâ”€â”€ ASLR: On
â”‚   â”œâ”€â”€ CFG: On
â”‚   â””â”€â”€ Block child processes: Consider for high security
â””â”€â”€ Test before enforcing strict settings

PDF READERS:
â”œâ”€â”€ AcroRd32.exe, Acrobat.exe
â”œâ”€â”€ Recommended: All standard mitigations
â””â”€â”€ High target for exploits

JAVA:
â”œâ”€â”€ java.exe, javaw.exe
â”œâ”€â”€ Apply mitigations carefully
â””â”€â”€ May break some applications

LEGACY APPLICATIONS:
â”œâ”€â”€ May not support all mitigations
â”œâ”€â”€ Test thoroughly
â”œâ”€â”€ Use Audit mode first
â””â”€â”€ Document exceptions</code></pre>
                </div>
            </div>

            <h2>Troubleshooting</h2>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">Common Issues</span>
                    <button class="code-copy">ğŸ“‹ Copy</button>
                </div>
                <div class="code-content">
<pre><code>ISSUE: Application crashes after enabling protection
SOLUTION:
â”œâ”€â”€ Identify which mitigation causes crash
â”œâ”€â”€ Event Viewer â†’ Windows Logs â†’ Application
â”œâ”€â”€ Look for fault in app or ntdll.dll
â”œâ”€â”€ Disable specific mitigation for that app
â””â”€â”€ Report to application vendor

ISSUE: Application won't start
SOLUTION:
â”œâ”€â”€ Check DEP compatibility
â”œâ”€â”€ Try disabling bottom-up ASLR
â”œâ”€â”€ Legacy apps may need DEP disabled
â””â”€â”€ Run in compatibility mode

ISSUE: Performance degradation
SOLUTION:
â”œâ”€â”€ CFG can impact some apps
â”œâ”€â”€ ACG affects JIT-compiled apps
â”œâ”€â”€ Consider per-app exceptions
â””â”€â”€ Monitor CPU usage

CHECKING PROTECTION STATUS:
<span class="comment"># Check if process has mitigations</span>
<span class="function">Get-Process</span> <span class="string">"processname"</span> <span class="operator">|</span> <span class="function">Select-Object</span> ProcessName, @{
    Name=<span class="string">'DEP'</span>; Expression={<span class="variable">$_</span>.DEPEnabled}
}

<span class="comment"># Detailed mitigation status</span>
<span class="function">Get-ProcessMitigation</span> <span class="variable">-Name</span> <span class="string">"processname.exe"</span> <span class="variable">-RunningProcesses</span></code></pre>
                </div>
            </div>

            <h2>KQL Queries</h2>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">KQL - Exploit Protection Events</span>
                    <button class="code-copy">ğŸ“‹ Copy</button>
                </div>
                <div class="code-content">
<pre><code><span class="comment">// Exploit protection blocks</span>
<span class="variable">DeviceEvents</span>
<span class="operator">|</span> <span class="keyword">where</span> Timestamp <span class="operator">></span> <span class="function">ago</span>(<span class="number">7</span>d)
<span class="operator">|</span> <span class="keyword">where</span> ActionType <span class="function">startswith</span> <span class="string">"ExploitGuard"</span>
<span class="operator">|</span> <span class="keyword">summarize</span> Count <span class="operator">=</span> <span class="function">count</span>() <span class="keyword">by</span> ActionType, FileName
<span class="operator">|</span> <span class="keyword">order by</span> Count <span class="keyword">desc</span>

<span class="comment">// Specific mitigation triggers</span>
<span class="variable">DeviceEvents</span>
<span class="operator">|</span> <span class="keyword">where</span> ActionType <span class="operator">==</span> <span class="string">"ExploitGuardAcgEnforced"</span>
<span class="operator">|</span> <span class="keyword">project</span> Timestamp, DeviceName, FileName, ProcessCommandLine</code></pre>
                </div>
            </div>

            <!-- Day-to-Day Section -->
            <div class="day-to-day">
                <h3>ğŸ”§ Day-to-Day Tasks</h3>
                <ul>
                    <li>Configure exploit protection policies</li>
                    <li>Troubleshoot application compatibility issues</li>
                    <li>Create per-app exceptions when needed</li>
                    <li>Monitor for exploit protection events</li>
                </ul>
            </div>

            <!-- Interview Tips -->
            <div class="interview-tips">
                <h3>ğŸ’¡ Key Interview Points</h3>
                <ul>
                    <li><strong>Purpose</strong>: Prevent memory corruption exploits</li>
                    <li><strong>DEP</strong>: Prevents code execution from data pages</li>
                    <li><strong>ASLR</strong>: Randomizes memory layout to prevent ROP</li>
                    <li><strong>CFG</strong>: Validates control flow to prevent hijacking</li>
                    <li><strong>Successor to EMET</strong>: Built into Windows 10/11</li>
                    <li><strong>Configuration</strong>: System-level and per-application settings</li>
                </ul>
            </div>

            <nav class="page-nav">
                <a href="3-3-controlled-folder-access.html" class="page-nav-link prev">
                    <span class="page-nav-label">â† Previous</span>
                    <span class="page-nav-title">Controlled Folder Access</span>
                </a>
                <a href="3-5-network-protection.html" class="page-nav-link next">
                    <span class="page-nav-label">Next â†’</span>
                    <span class="page-nav-title">Network Protection</span>
                </a>
            </nav>
        </div>
    </main>

    <div class="search-modal">
        <div class="search-modal-content">
            <div class="search-modal-input-wrapper">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="11" cy="11" r="8"></circle>
                    <path d="M21 21l-4.35-4.35"></path>
                </svg>
                <input type="text" class="search-modal-input" placeholder="Search pages..." autofocus>
                <button class="search-modal-close">ESC</button>
            </div>
            <div class="search-results"></div>
        </div>
    </div>
    <script src="main.js"></script>
</body>
</html>
