<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Device Control | MDE Ultimate Guide</title>
    <link rel="stylesheet" href="main.css">
</head>
<body>
    <header class="header">
        <div class="header-left">
            <button class="mobile-menu-btn" aria-label="Toggle menu">â˜°</button>
            <a href="index.html" class="logo">
                <div class="logo-icon">MDE</div>
                <div class="logo-text"><span>MDE</span> Ultimate Guide</div>
            </a>
        </div>
        <div class="search-container">
            <button class="search-btn">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="11" cy="11" r="8"></circle>
                    <path d="M21 21l-4.35-4.35"></path>
                </svg>
                <span>Search documentation...</span>
                <span class="search-shortcut"><kbd>âŒ˜</kbd><kbd>K</kbd></span>
            </button>
        </div>
        <div class="header-right">
            <a href="12-2-interview-questions.html" class="header-link">Interview Prep</a>
            <a href="5-3-kql-fundamentals.html" class="header-link">KQL Guide</a>
        </div>
    </header>

    <div class="sidebar-overlay"></div>
    <aside class="sidebar"></aside>

    <main class="main-content">
        <div class="content-wrapper">
            <div class="overview-box">
                <h4>ğŸ¯ What This Page Covers</h4>
                <p>Complete guide to Device Control in MDE for managing USB drives, removable storage, Bluetooth, and other peripheral devices. Learn policy configuration, deployment via Intune/GPO, and monitoring device usage.</p>
            </div>

            <h1>Device Control</h1>

            <p>Device Control in MDE enables organizations to manage and restrict the use of removable storage devices, preventing data exfiltration and blocking malware delivery via USB drives and other peripherals.</p>

            <h2>Device Control Overview</h2>

            <div class="flow-diagram">
                <div class="diagram-title">Device Control Architecture</div>
<pre>
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        DEVICE CONTROL POLICY                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚   DEVICE TYPES                    ACTIONS                               â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚   â”‚ Removable Storageâ”‚            â”‚ Allow           â”‚                   â”‚
â”‚   â”‚ â€¢ USB drives    â”‚            â”‚ Block           â”‚                   â”‚
â”‚   â”‚ â€¢ SD cards      â”‚            â”‚ Audit only      â”‚                   â”‚
â”‚   â”‚ â€¢ External HDD  â”‚            â”‚ Allow read-only â”‚                   â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚   â”‚ Portable Devices â”‚                                                  â”‚
â”‚   â”‚ â€¢ Cameras       â”‚            ENFORCEMENT                           â”‚
â”‚   â”‚ â€¢ Media players â”‚            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤            â”‚ Intune policy   â”‚                   â”‚
â”‚   â”‚ Bluetooth       â”‚            â”‚ Group Policy    â”‚                   â”‚
â”‚   â”‚ â€¢ All BT devicesâ”‚            â”‚ Custom OMA-URI  â”‚                   â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚   â”‚ Printers        â”‚                                                   â”‚
â”‚   â”‚ â€¢ USB printers  â”‚            EXCEPTIONS                            â”‚
â”‚   â”‚ â€¢ Network print â”‚            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚ Approved devicesâ”‚                   â”‚
â”‚                                   â”‚ (by VID/PID,   â”‚                   â”‚
â”‚                                   â”‚ serial number) â”‚                   â”‚
â”‚                                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</pre>
            </div>

            <h2>Policy Configuration Options</h2>

            <h3>Access Control Levels</h3>

            <div class="table-wrapper">
                <table>
                    <thead>
                        <tr>
                            <th>Access Level</th>
                            <th>Read</th>
                            <th>Write</th>
                            <th>Execute</th>
                            <th>Use Case</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Allow</strong></td>
                            <td>âœ…</td>
                            <td>âœ…</td>
                            <td>âœ…</td>
                            <td>Trusted devices, approved groups</td>
                        </tr>
                        <tr>
                            <td><strong>Read Only</strong></td>
                            <td>âœ…</td>
                            <td>âŒ</td>
                            <td>âŒ</td>
                            <td>View data but prevent copying TO device</td>
                        </tr>
                        <tr>
                            <td><strong>Block</strong></td>
                            <td>âŒ</td>
                            <td>âŒ</td>
                            <td>âŒ</td>
                            <td>Complete restriction</td>
                        </tr>
                        <tr>
                            <td><strong>Audit Only</strong></td>
                            <td>âœ…</td>
                            <td>âœ…</td>
                            <td>âœ…</td>
                            <td>Monitor without blocking (testing)</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <h2>Deployment via Intune</h2>

            <h3>Creating a Device Control Policy</h3>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">Intune Configuration</span>
                    <button class="code-copy">ğŸ“‹ Copy</button>
                </div>
                <div class="code-content">
<pre><code>Navigation:
Microsoft Intune admin center â†’ Endpoint security â†’ 
Attack surface reduction â†’ Create policy

Platform: Windows 10 and later
Profile: Device control

Settings:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ REMOVABLE STORAGE                                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Removable Disk Deny Write Access          [Enabled/Disabled]    â”‚
â”‚ Removable Disk Deny Read Access           [Enabled/Disabled]    â”‚
â”‚ Removable Disk Deny Execute Access        [Enabled/Disabled]    â”‚
â”‚                                                                  â”‚
â”‚ CD/DVD                                                          â”‚
â”‚ CD and DVD Deny Write Access              [Enabled/Disabled]    â”‚
â”‚ CD and DVD Deny Read Access               [Enabled/Disabled]    â”‚
â”‚                                                                  â”‚
â”‚ FLOPPY                                                          â”‚
â”‚ Floppy Drives Deny Write Access           [Enabled/Disabled]    â”‚
â”‚ Floppy Drives Deny Read Access            [Enabled/Disabled]    â”‚
â”‚                                                                  â”‚
â”‚ WPD DEVICES (Cameras, Media Players)                            â”‚
â”‚ WPD Devices Deny Write Access             [Enabled/Disabled]    â”‚
â”‚ WPD Devices Deny Read Access              [Enabled/Disabled]    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre>
                </div>
            </div>

            <h3>Advanced Device Control with Reusable Settings</h3>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">Intune - Reusable Device Groups</span>
                    <button class="code-copy">ğŸ“‹ Copy</button>
                </div>
                <div class="code-content">
<pre><code>Navigation:
Intune â†’ Endpoint security â†’ Attack surface reduction â†’ 
Reusable settings â†’ Create

Step 1: Create Device Group (Approved USB drives)
Name: Approved USB Drives
Type: Removable Storage

Device Properties:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Match Type: MatchAny (OR logic)                                  â”‚
â”‚                                                                  â”‚
â”‚ Descriptor 1:                                                    â”‚
â”‚   VendorId: 0781  (SanDisk)                                     â”‚
â”‚   ProductId: 5583 (Cruzer Glide)                                â”‚
â”‚                                                                  â”‚
â”‚ Descriptor 2:                                                    â”‚
â”‚   VendorId: 0951  (Kingston)                                    â”‚
â”‚   ProductId: 1666 (DataTraveler)                                â”‚
â”‚                                                                  â”‚
â”‚ Descriptor 3:                                                    â”‚
â”‚   SerialNumber: ABC123456789                                    â”‚
â”‚   (Specific approved device)                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Step 2: Create Policy Using the Group
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Rule 1: Allow Approved Devices                                   â”‚
â”‚   Device Group: Approved USB Drives                             â”‚
â”‚   Access: Allow (Read, Write, Execute)                          â”‚
â”‚                                                                  â”‚
â”‚ Rule 2: Block All Other Removable Storage                       â”‚
â”‚   Device Type: Removable Storage                                â”‚
â”‚   Access: Block                                                  â”‚
â”‚   Notification: Show toast message                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre>
                </div>
            </div>

            <h2>Deployment via Group Policy</h2>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">Group Policy Settings</span>
                    <button class="code-copy">ğŸ“‹ Copy</button>
                </div>
                <div class="code-content">
<pre><code>Group Policy Path:
Computer Configuration â†’ Administrative Templates â†’ 
System â†’ Removable Storage Access

Available Settings:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ All Removable Storage classes: Deny all access                   â”‚
â”‚ All Removable Storage: Allow direct access in remote sessions   â”‚
â”‚                                                                  â”‚
â”‚ CD and DVD: Deny execute access                                  â”‚
â”‚ CD and DVD: Deny read access                                     â”‚
â”‚ CD and DVD: Deny write access                                    â”‚
â”‚                                                                  â”‚
â”‚ Custom Classes: Deny read access                                 â”‚
â”‚ Custom Classes: Deny write access                                â”‚
â”‚                                                                  â”‚
â”‚ Floppy Drives: Deny execute access                              â”‚
â”‚ Floppy Drives: Deny read access                                  â”‚
â”‚ Floppy Drives: Deny write access                                 â”‚
â”‚                                                                  â”‚
â”‚ Removable Disks: Deny execute access                            â”‚
â”‚ Removable Disks: Deny read access                                â”‚
â”‚ Removable Disks: Deny write access                               â”‚
â”‚                                                                  â”‚
â”‚ Tape Drives: Deny execute access                                 â”‚
â”‚ Tape Drives: Deny read access                                    â”‚
â”‚ Tape Drives: Deny write access                                   â”‚
â”‚                                                                  â”‚
â”‚ WPD Devices: Deny read access                                    â”‚
â”‚ WPD Devices: Deny write access                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre>
                </div>
            </div>

            <h2>Finding Device Identifiers</h2>

            <h3>PowerShell - Get USB Device Info</h3>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">PowerShell</span>
                    <button class="code-copy">ğŸ“‹ Copy</button>
                </div>
                <div class="code-content">
<pre><code><span class="comment"># List all USB storage devices</span>
<span class="function">Get-WmiObject</span> Win32_DiskDrive <span class="operator">|</span> 
    <span class="function">Where-Object</span> { <span class="variable">$_</span>.InterfaceType <span class="operator">-eq</span> <span class="string">"USB"</span> } <span class="operator">|</span>
    <span class="function">Select-Object</span> Model, SerialNumber, PNPDeviceID

<span class="comment"># Get VID/PID from device</span>
<span class="function">Get-PnpDevice</span> <span class="operator">|</span> 
    <span class="function">Where-Object</span> { <span class="variable">$_</span>.Class <span class="operator">-eq</span> <span class="string">"DiskDrive"</span> } <span class="operator">|</span>
    <span class="function">Select-Object</span> FriendlyName, InstanceId

<span class="comment"># Parse VID/PID from InstanceId</span>
<span class="comment"># Format: USB\VID_0781&PID_5583\ABC123456789</span>
<span class="comment"># VID_0781 = Vendor ID 0781</span>
<span class="comment"># PID_5583 = Product ID 5583</span>
<span class="comment"># ABC123456789 = Serial Number</span>

<span class="comment"># Detailed device info</span>
<span class="function">Get-PnpDeviceProperty</span> <span class="variable">-InstanceId</span> <span class="string">"USB\VID_0781&PID_5583\ABC123"</span> <span class="operator">|</span> 
    <span class="function">Format-Table</span> KeyName, Data</code></pre>
                </div>
            </div>

            <h2>Monitoring Device Control Events</h2>

            <h3>KQL Queries for Device Control</h3>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">KQL - USB Device Activity</span>
                    <button class="code-copy">ğŸ“‹ Copy</button>
                </div>
                <div class="code-content">
<pre><code><span class="comment">// All removable device mount events</span>
<span class="variable">DeviceEvents</span>
<span class="operator">|</span> <span class="keyword">where</span> Timestamp <span class="operator">></span> <span class="function">ago</span>(<span class="number">7</span>d)
<span class="operator">|</span> <span class="keyword">where</span> ActionType <span class="operator">==</span> <span class="string">"PnpDeviceConnected"</span>
<span class="operator">|</span> <span class="keyword">extend</span> DeviceInfo <span class="operator">=</span> <span class="function">parse_json</span>(AdditionalFields)
<span class="operator">|</span> <span class="keyword">where</span> DeviceInfo.ClassName <span class="operator">==</span> <span class="string">"DiskDrive"</span>
<span class="operator">|</span> <span class="keyword">project</span> Timestamp, DeviceName, AccountName,
         VendorId <span class="operator">=</span> DeviceInfo.VendorId,
         ProductId <span class="operator">=</span> DeviceInfo.ProductId,
         SerialNumber <span class="operator">=</span> DeviceInfo.SerialNumber

<span class="comment">// Device control policy blocks</span>
<span class="variable">DeviceEvents</span>
<span class="operator">|</span> <span class="keyword">where</span> Timestamp <span class="operator">></span> <span class="function">ago</span>(<span class="number">7</span>d)
<span class="operator">|</span> <span class="keyword">where</span> ActionType <span class="operator">==</span> <span class="string">"RemovableStoragePolicyTriggered"</span>
<span class="operator">|</span> <span class="keyword">extend</span> PolicyInfo <span class="operator">=</span> <span class="function">parse_json</span>(AdditionalFields)
<span class="operator">|</span> <span class="keyword">project</span> Timestamp, DeviceName, AccountName,
         PolicyAction <span class="operator">=</span> PolicyInfo.PolicyAction,
         DeviceClass <span class="operator">=</span> PolicyInfo.DeviceClass
<span class="operator">|</span> <span class="keyword">summarize</span> BlockCount <span class="operator">=</span> <span class="function">count</span>() <span class="keyword">by</span> DeviceName, AccountName, PolicyAction

<span class="comment">// Files copied to USB</span>
<span class="variable">DeviceFileEvents</span>
<span class="operator">|</span> <span class="keyword">where</span> Timestamp <span class="operator">></span> <span class="function">ago</span>(<span class="number">7</span>d)
<span class="operator">|</span> <span class="keyword">where</span> ActionType <span class="operator">==</span> <span class="string">"FileCreated"</span>
<span class="operator">|</span> <span class="keyword">where</span> FolderPath <span class="function">matches regex</span> <span class="string">@"^[D-Z]:\\"</span>  <span class="comment">// Non-C drives</span>
<span class="operator">|</span> <span class="keyword">where</span> FolderPath <span class="operator">!</span><span class="function">startswith</span> <span class="string">"C:\\"</span>
<span class="operator">|</span> <span class="keyword">project</span> Timestamp, DeviceName, AccountName, FileName, FolderPath, FileSize
<span class="operator">|</span> <span class="keyword">summarize</span> 
    FileCount <span class="operator">=</span> <span class="function">count</span>(),
    TotalSize <span class="operator">=</span> <span class="function">sum</span>(FileSize)
    <span class="keyword">by</span> DeviceName, AccountName, <span class="function">bin</span>(Timestamp, <span class="number">1</span>h)</code></pre>
                </div>
            </div>

            <h2>Common Implementation Scenarios</h2>

            <h3>Scenario 1: Block All USB, Allow Approved</h3>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">Policy Configuration</span>
                    <button class="code-copy">ğŸ“‹ Copy</button>
                </div>
                <div class="code-content">
<pre><code>POLICY: Corporate USB Control

Rule Order Matters! (First match wins)

Rule 1: Allow Corporate-Approved USB Drives
â”œâ”€â”€ Condition: VendorId = 0781 AND ProductId = 5583
â”œâ”€â”€ OR: SerialNumber in ApprovedList
â”œâ”€â”€ Access: Allow (Read, Write, Execute)
â””â”€â”€ Notification: None

Rule 2: Allow Encrypted USB Drives
â”œâ”€â”€ Condition: Device is BitLocker encrypted
â”œâ”€â”€ Access: Allow (Read, Write, Execute)
â””â”€â”€ Notification: None

Rule 3: Block All Other Removable Storage
â”œâ”€â”€ Condition: Device Type = Removable Storage
â”œâ”€â”€ Access: Deny (Read, Write, Execute)
â””â”€â”€ Notification: "USB devices are not permitted. 
    Contact IT for approved devices."</code></pre>
                </div>
            </div>

            <h3>Scenario 2: Read-Only for All USB</h3>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">Policy Configuration</span>
                    <button class="code-copy">ğŸ“‹ Copy</button>
                </div>
                <div class="code-content">
<pre><code>POLICY: USB Read-Only (Prevent Data Exfiltration)

Rule 1: Read-Only for All Removable Storage
â”œâ”€â”€ Condition: Device Type = Removable Storage
â”œâ”€â”€ Access: 
â”‚   â”œâ”€â”€ Read: Allow
â”‚   â”œâ”€â”€ Write: Deny
â”‚   â””â”€â”€ Execute: Deny
â””â”€â”€ Notification: "Write access to USB devices is blocked.
    Data cannot be copied to removable media."

Result:
âœ… Users can read files FROM USB drives
âŒ Users cannot write files TO USB drives
âŒ Users cannot run executables from USB drives</code></pre>
                </div>
            </div>

            <div class="callout warning">
                <div class="callout-icon">âš ï¸</div>
                <div class="callout-content">
                    <h5>Testing Recommendation</h5>
                    <p>Always deploy Device Control policies in Audit mode first to identify legitimate business use cases before enforcing Block mode. Review DeviceEvents for "RemovableStoragePolicyTriggered" events.</p>
                </div>
            </div>

            <!-- Day-to-Day Section -->
            <div class="day-to-day">
                <h3>ğŸ”§ Security Engineer Day-to-Day Tasks</h3>
                
                <h4>Device Control Operations</h4>
                <ul>
                    <li>Process requests for USB device approvals</li>
                    <li>Add approved devices to allowlist (by VID/PID or serial)</li>
                    <li>Monitor blocked device events</li>
                    <li>Investigate high-volume file transfers to USB</li>
                    <li>Review and update device control policies</li>
                </ul>

                <h4>Common Tickets</h4>
                <div class="ticket-item">
                    <span class="ticket-type">"USB drive not working"</span>
                    <span class="ticket-solution">â†’ Check device control events, verify if blocked by policy, process exception if legitimate</span>
                </div>
                <div class="ticket-item">
                    <span class="ticket-type">"Need to use USB for project"</span>
                    <span class="ticket-solution">â†’ Get device serial number, add to approved list, or provide encrypted corporate USB</span>
                </div>
                <div class="ticket-item">
                    <span class="ticket-type">"Large data transfer to USB detected"</span>
                    <span class="ticket-solution">â†’ Investigate user and files transferred, verify business justification</span>
                </div>
            </div>

            <!-- Interview Tips -->
            <div class="interview-tips">
                <h3>ğŸ’¡ Key Interview Points</h3>
                <ul>
                    <li><strong>Device identification</strong>: VID (Vendor ID), PID (Product ID), Serial Number</li>
                    <li><strong>Access levels</strong>: Allow, Block, Read-Only, Audit</li>
                    <li><strong>Deployment</strong>: Intune (preferred), Group Policy, custom OMA-URI</li>
                    <li><strong>Rule order</strong>: First match wins - put allow rules before deny rules</li>
                    <li><strong>Testing</strong>: Use Audit mode before Block mode</li>
                    <li><strong>Monitoring</strong>: DeviceEvents table with ActionType "RemovableStoragePolicyTriggered"</li>
                </ul>
            </div>

            <nav class="page-nav">
                <a href="3-6-network-protection.html" class="page-nav-link prev">
                    <span class="page-nav-label">â† Previous</span>
                    <span class="page-nav-title">Network Protection</span>
                </a>
                <a href="3-8-firewall-integration.html" class="page-nav-link next">
                    <span class="page-nav-label">Next â†’</span>
                    <span class="page-nav-title">Firewall Integration</span>
                </a>
            </nav>
        </div>
    </main>

    <div class="search-modal">
        <div class="search-modal-content">
            <div class="search-modal-input-wrapper">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="11" cy="11" r="8"></circle>
                    <path d="M21 21l-4.35-4.35"></path>
                </svg>
                <input type="text" class="search-modal-input" placeholder="Search pages..." autofocus>
                <button class="search-modal-close">ESC</button>
            </div>
            <div class="search-results"></div>
        </div>
    </div>
    <script src="main.js"></script>
</body>
</html>
