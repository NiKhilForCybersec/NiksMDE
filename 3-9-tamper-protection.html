<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tamper Protection | MDE Ultimate Guide</title>
    <link rel="stylesheet" href="main.css">
</head>
<body>
    <header class="header">
        <div class="header-left">
            <button class="mobile-menu-btn" aria-label="Toggle menu">â˜°</button>
            <a href="index.html" class="logo">
                <div class="logo-icon">MDE</div>
                <div class="logo-text"><span>MDE</span> Ultimate Guide</div>
            </a>
        </div>
        <div class="search-container">
            <button class="search-btn">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="11" cy="11" r="8"></circle>
                    <path d="M21 21l-4.35-4.35"></path>
                </svg>
                <span>Search documentation...</span>
                <span class="search-shortcut"><kbd>âŒ˜</kbd><kbd>K</kbd></span>
            </button>
        </div>
        <div class="header-right">
            <a href="12-2-interview-questions.html" class="header-link">Interview Prep</a>
            <a href="5-3-kql-fundamentals.html" class="header-link">KQL Guide</a>
        </div>
    </header>

    <div class="sidebar-overlay"></div>
    <aside class="sidebar"></aside>

    <main class="main-content">
        <div class="content-wrapper">
            <div class="overview-box">
                <h4>ğŸ¯ What This Page Covers</h4>
                <p>Complete guide to Tamper Protection in MDE. Learn how it prevents attackers from disabling security features, what it protects, how to manage it, and troubleshoot tamper protection issues.</p>
            </div>

            <h1>Tamper Protection</h1>

            <p>Tamper Protection prevents malicious apps and attackers from disabling Microsoft Defender Antivirus security features. It locks down critical settings so they can only be changed through authorized management channels.</p>

            <h2>What Tamper Protection Protects</h2>

            <div class="flow-diagram">
                <div class="diagram-title">Tamper Protection Coverage</div>
<pre>
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    TAMPER PROTECTION COVERAGE                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  PROTECTED SETTINGS (Cannot be changed locally when enabled)            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚   â”‚
â”‚  â”‚  â”‚ Real-time Protection â”‚  â”‚ Cloud Protection     â”‚            â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ Cannot be disabled â”‚  â”‚ â€¢ Cannot be disabled â”‚            â”‚   â”‚
â”‚  â”‚  â”‚   via PowerShell     â”‚  â”‚   locally            â”‚            â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ Cannot be disabled â”‚  â”‚                      â”‚            â”‚   â”‚
â”‚  â”‚  â”‚   via registry       â”‚  â”‚                      â”‚            â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚   â”‚
â”‚  â”‚  â”‚ Behavior Monitoring  â”‚  â”‚ Virus Definitions    â”‚            â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ Protected          â”‚  â”‚ â€¢ Cannot be deleted  â”‚            â”‚   â”‚
â”‚  â”‚  â”‚                      â”‚  â”‚ â€¢ Cannot be reverted â”‚            â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚   â”‚
â”‚  â”‚  â”‚ IOAV Protection      â”‚  â”‚ MDE Sensor           â”‚            â”‚   â”‚
â”‚  â”‚  â”‚ (Office files)       â”‚  â”‚ â€¢ Service protected  â”‚            â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ Protected          â”‚  â”‚ â€¢ Cannot be stopped  â”‚            â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                          â”‚
â”‚  WHAT'S BLOCKED:                                                        â”‚
â”‚  â”œâ”€â”€ PowerShell: Set-MpPreference -DisableRealtimeMonitoring $true     â”‚
â”‚  â”œâ”€â”€ Registry: HKLM\...\Windows Defender modifications                  â”‚
â”‚  â”œâ”€â”€ Services: Stopping WinDefend, Sense services                       â”‚
â”‚  â”œâ”€â”€ Group Policy: Local GP overrides (when cloud-managed)              â”‚
â”‚  â””â”€â”€ WMI: Attempting to modify settings via WMI                         â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</pre>
            </div>

            <h2>How It Works</h2>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">Tamper Protection Mechanism</span>
                    <button class="code-copy">ğŸ“‹ Copy</button>
                </div>
                <div class="code-content">
<pre><code>PROTECTION MECHANISM:

LOCAL LOCKDOWN:
â”œâ”€â”€ Registry keys are protected from modification
â”œâ”€â”€ Service control is blocked for protected services
â”œâ”€â”€ PowerShell cmdlets are intercepted and blocked
â”œâ”€â”€ Group Policy local overrides are ignored
â””â”€â”€ WMI modifications are blocked

MANAGEMENT CHANNELS (Still work):
â”œâ”€â”€ Microsoft Endpoint Manager (Intune)
â”œâ”€â”€ Microsoft Defender Security Center portal
â”œâ”€â”€ Configuration Manager with tenant attach
â””â”€â”€ Microsoft 365 Defender settings

ATTACK SCENARIO PREVENTED:
Attacker gains access
    â†“
Tries: Set-MpPreference -DisableRealtimeMonitoring $true
    â†“
Result: Operation BLOCKED - Tamper protection active
    â†“
Defender stays enabled
    â†“
Attacker's malware is detected and blocked

WITHOUT TAMPER PROTECTION:
Attacker gains access
    â†“
Runs: Set-MpPreference -DisableRealtimeMonitoring $true
    â†“
Result: Defender DISABLED
    â†“
Attacker drops malware undetected
    â†“
Full compromise</code></pre>
                </div>
            </div>

            <h2>Enabling Tamper Protection</h2>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">Configuration Methods</span>
                    <button class="code-copy">ğŸ“‹ Copy</button>
                </div>
                <div class="code-content">
<pre><code>METHOD 1: MICROSOFT 365 DEFENDER PORTAL (Recommended)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
security.microsoft.com â†’ Settings â†’ Endpoints â†’ Advanced features
â””â”€â”€ Tamper protection: ON

This enables for ALL onboarded devices automatically.

METHOD 2: INTUNE
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Endpoint security â†’ Antivirus â†’ Create policy
Platform: Windows 10 and later
Profile: Windows Security experience

Settings:
â””â”€â”€ Tamper Protection: Enabled

METHOD 3: WINDOWS SECURITY (Individual device)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Windows Security â†’ Virus & threat protection
â†’ Virus & threat protection settings â†’ Manage settings
â†’ Tamper Protection: ON

Note: This can be managed by Intune/SCCM to prevent local changes.

CHECK CURRENT STATUS:
<span class="function">Get-MpComputerStatus</span> <span class="operator">|</span> <span class="function">Select-Object</span> IsTamperProtected
<span class="comment"># True = Enabled, False = Disabled</span>

REGISTRY CHECK:
<span class="function">Get-ItemProperty</span> <span class="string">"HKLM:\SOFTWARE\Microsoft\Windows Defender\Features"</span> <span class="variable">-Name</span> TamperProtection
<span class="comment"># 5 = Enabled, 4 = Disabled, 0 = Not configured</span></code></pre>
                </div>
            </div>

            <h2>Management Considerations</h2>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">Operational Impact</span>
                    <button class="code-copy">ğŸ“‹ Copy</button>
                </div>
                <div class="code-content">
<pre><code>THINGS THAT STILL WORK:

LEGITIMATE MANAGEMENT:
â”œâ”€â”€ Intune policies apply normally
â”œâ”€â”€ SCCM with tenant attach works
â”œâ”€â”€ Microsoft 365 Defender portal settings work
â”œâ”€â”€ Windows Security app (when allowed)
â””â”€â”€ Exclusions via Intune/SCCM still work

THINGS THAT ARE BLOCKED:

LOCAL CHANGES:
â”œâ”€â”€ PowerShell Set-MpPreference (protected settings)
â”œâ”€â”€ Registry modifications to Defender keys
â”œâ”€â”€ Service stop/disable commands
â”œâ”€â”€ Local Group Policy for protected settings
â””â”€â”€ Third-party tools trying to disable Defender

IMPACT ON IT OPERATIONS:
â”œâ”€â”€ Cannot disable Defender locally for troubleshooting
â”œâ”€â”€ Must use cloud management for changes
â”œâ”€â”€ Scripts that modify Defender settings may fail
â””â”€â”€ Some third-party tools may report errors

WORKAROUNDS FOR LEGITIMATE NEEDS:
â”œâ”€â”€ Use Intune/SCCM for configuration changes
â”œâ”€â”€ Create proper exclusion policies
â”œâ”€â”€ Use device groups for different configurations
â””â”€â”€ Temporarily disable via portal if absolutely necessary</code></pre>
                </div>
            </div>

            <h2>Tamper Protection Events</h2>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">Monitoring Tamper Attempts</span>
                    <button class="code-copy">ğŸ“‹ Copy</button>
                </div>
                <div class="code-content">
<pre><code>EVENT LOG:
Microsoft-Windows-Windows Defender/Operational

KEY EVENT IDS:
â”œâ”€â”€ 5013: Tamper protection blocked a change
â”œâ”€â”€ 5014: Tamper protection audit (would have blocked)
â””â”€â”€ 5007: Configuration changed

POWERSHELL - VIEW TAMPER EVENTS:
<span class="function">Get-WinEvent</span> <span class="variable">-LogName</span> <span class="string">"Microsoft-Windows-Windows Defender/Operational"</span> <span class="operator">|</span>
    <span class="function">Where-Object</span> { <span class="variable">$_</span>.Id <span class="operator">-in</span> @(<span class="number">5013</span>, <span class="number">5014</span>) } <span class="operator">|</span>
    <span class="function">Select-Object</span> TimeCreated, Id, Message

KQL - TAMPER ATTEMPTS IN MDE:
<span class="variable">DeviceEvents</span>
<span class="operator">|</span> <span class="keyword">where</span> Timestamp <span class="operator">></span> <span class="function">ago</span>(<span class="number">7</span>d)
<span class="operator">|</span> <span class="keyword">where</span> ActionType <span class="operator">==</span> <span class="string">"TamperProtection"</span>
<span class="operator">|</span> <span class="keyword">project</span> Timestamp, DeviceName, InitiatingProcessFileName, 
         InitiatingProcessCommandLine, AccountName
<span class="operator">|</span> <span class="keyword">order by</span> Timestamp <span class="keyword">desc</span>

ALERT ON TAMPER ATTEMPTS:
â”œâ”€â”€ MDE generates alerts for tamper attempts
â”œâ”€â”€ High severity - indicates active attack
â”œâ”€â”€ Investigate immediately
â””â”€â”€ Check what process attempted the tampering</code></pre>
                </div>
            </div>

            <h2>Troubleshooting</h2>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">Common Issues</span>
                    <button class="code-copy">ğŸ“‹ Copy</button>
                </div>
                <div class="code-content">
<pre><code>ISSUE: Can't disable Defender for testing
SOLUTION:
â”œâ”€â”€ Use Intune/SCCM to create test policy
â”œâ”€â”€ Create exclusion for test file/folder
â”œâ”€â”€ Use dedicated test device group
â””â”€â”€ If urgent, temporarily disable via portal

ISSUE: Third-party security tool conflicts
SOLUTION:
â”œâ”€â”€ Check if tool is compatible with tamper protection
â”œâ”€â”€ Contact vendor for updated version
â”œâ”€â”€ May need to configure tool to work with Defender
â””â”€â”€ Don't disable tamper protection as workaround

ISSUE: IT script failing to run
SOLUTION:
â”œâ”€â”€ Review what the script is trying to do
â”œâ”€â”€ If modifying Defender settings, use Intune instead
â”œâ”€â”€ If creating exclusions, use proper policy
â””â”€â”€ Update script to work with tamper protection

ISSUE: Tamper protection not enabling
CHECK:
â”œâ”€â”€ Device onboarded to MDE?
â”œâ”€â”€ Cloud connectivity working?
â”œâ”€â”€ Conflicting Group Policy?
â”œâ”€â”€ Third-party AV blocking?
â””â”€â”€ Check event logs for errors

ISSUE: Need to disable for break/fix
PROCESS:
â”œâ”€â”€ Portal: Settings â†’ Endpoints â†’ Advanced features
â”œâ”€â”€ Temporarily disable
â”œâ”€â”€ Fix the issue
â”œâ”€â”€ Re-enable IMMEDIATELY
â””â”€â”€ Document the change</code></pre>
                </div>
            </div>

            <div class="callout warning">
                <div class="callout-icon">âš ï¸</div>
                <div class="callout-content">
                    <h5>Security Warning</h5>
                    <ul>
                        <li><strong>Never disable tamper protection permanently</strong></li>
                        <li><strong>Tamper attempts = active attack indicator</strong></li>
                        <li><strong>Investigate all tamper alerts immediately</strong></li>
                        <li><strong>If disabled, re-enable within minutes</strong></li>
                    </ul>
                </div>
            </div>

            <!-- Day-to-Day Section -->
            <div class="day-to-day">
                <h3>ğŸ”§ Security Engineer Day-to-Day Tasks</h3>
                
                <h4>Tamper Protection Operations</h4>
                <ul>
                    <li>Verify tamper protection is enabled org-wide</li>
                    <li>Monitor and investigate tamper attempts</li>
                    <li>Handle IT requests that conflict with tamper protection</li>
                    <li>Educate teams on proper management channels</li>
                    <li>Document any temporary disabling with justification</li>
                </ul>

                <h4>Common Scenarios</h4>
                <div class="ticket-item">
                    <span class="ticket-type">"Tamper protection alert generated"</span>
                    <span class="ticket-solution">â†’ INVESTIGATE IMMEDIATELY. Check what process attempted tampering. Likely attack.</span>
                </div>
                <div class="ticket-item">
                    <span class="ticket-type">"IT can't modify Defender settings"</span>
                    <span class="ticket-solution">â†’ Explain tamper protection. Guide them to use Intune/SCCM for changes.</span>
                </div>
                <div class="ticket-item">
                    <span class="ticket-type">"Need to disable for vendor testing"</span>
                    <span class="ticket-solution">â†’ Create isolated test group. Use exclusions if possible. If must disable, document and time-limit.</span>
                </div>
            </div>

            <!-- Interview Tips -->
            <div class="interview-tips">
                <h3>ğŸ’¡ Key Interview Points</h3>
                <ul>
                    <li><strong>Purpose</strong>: Prevents attackers from disabling security features</li>
                    <li><strong>What's protected</strong>: Real-time protection, cloud protection, behavior monitoring, services</li>
                    <li><strong>Management</strong>: Intune/SCCM/Portal still work, local changes blocked</li>
                    <li><strong>Attacks blocked</strong>: Set-MpPreference, registry changes, service stops</li>
                    <li><strong>Enable via</strong>: Microsoft 365 Defender portal â†’ Settings â†’ Advanced features</li>
                    <li><strong>Tamper alerts</strong>: High priority - indicates active attack attempt</li>
                    <li><strong>Best practice</strong>: Always enabled, never disable except emergency</li>
                </ul>
            </div>

            <nav class="page-nav">
                <a href="3-8-firewall-integration.html" class="page-nav-link prev">
                    <span class="page-nav-label">â† Previous</span>
                    <span class="page-nav-title">Firewall Integration</span>
                </a>
                <a href="3-10-exclusions-management.html" class="page-nav-link next">
                    <span class="page-nav-label">Next â†’</span>
                    <span class="page-nav-title">Exclusions Management</span>
                </a>
            </nav>
        </div>
    </main>

    <div class="search-modal">
        <div class="search-modal-content">
            <div class="search-modal-input-wrapper">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="11" cy="11" r="8"></circle>
                    <path d="M21 21l-4.35-4.35"></path>
                </svg>
                <input type="text" class="search-modal-input" placeholder="Search pages..." autofocus>
                <button class="search-modal-close">ESC</button>
            </div>
            <div class="search-results"></div>
        </div>
    </div>
    <script src="main.js"></script>
</body>
</html>
