<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Detection Sources | MDE Ultimate Guide</title>
    <link rel="stylesheet" href="main.css">
</head>
<body>
    <header class="header">
        <div class="header-left">
            <button class="mobile-menu-btn" aria-label="Toggle menu">â˜°</button>
            <a href="index.html" class="logo">
                <div class="logo-icon">MDE</div>
                <div class="logo-text"><span>MDE</span> Ultimate Guide</div>
            </a>
        </div>
        <div class="search-container">
            <button class="search-btn">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="11" cy="11" r="8"></circle>
                    <path d="M21 21l-4.35-4.35"></path>
                </svg>
                <span>Search documentation...</span>
                <span class="search-shortcut"><kbd>âŒ˜</kbd><kbd>K</kbd></span>
            </button>
        </div>
        <div class="header-right">
            <a href="12-2-interview-questions.html" class="header-link">Interview Prep</a>
            <a href="5-3-kql-fundamentals.html" class="header-link">KQL Guide</a>
        </div>
    </header>

    <div class="sidebar-overlay"></div>
    <aside class="sidebar"></aside>

    <main class="main-content">
        <div class="content-wrapper">
            <div class="overview-box">
                <h4>ğŸ¯ What This Page Covers</h4>
                <p>Complete guide to MDE detection sources and types. Learn how different detection engines work, what each detection source covers, and how to interpret alerts from various sources.</p>
            </div>

            <h1>Detection Sources</h1>

            <p>Microsoft Defender for Endpoint uses multiple detection engines and sources to identify threats. Understanding these sources helps analysts properly investigate and respond to alerts.</p>

            <h2>Detection Source Overview</h2>

            <div class="flow-diagram">
                <div class="diagram-title">MDE Detection Engine Architecture</div>
<pre>
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      MDE DETECTION SOURCES                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  ENDPOINT-BASED DETECTION                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚  â”‚ Antivirus   â”‚  â”‚ EDR         â”‚  â”‚ ASR / Exploit          â”‚ â”‚   â”‚
â”‚  â”‚  â”‚ (AV)        â”‚  â”‚ Behavioral  â”‚  â”‚ Protection             â”‚ â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ Signaturesâ”‚  â”‚ â€¢ Behavior  â”‚  â”‚ â€¢ Rule-based blocks    â”‚ â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ Heuristicsâ”‚  â”‚ â€¢ ML models â”‚  â”‚ â€¢ Exploit mitigations  â”‚ â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ Cloud     â”‚  â”‚ â€¢ Anomalies â”‚  â”‚ â€¢ Memory protections   â”‚ â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚  â”‚ Network     â”‚  â”‚ SmartScreen â”‚  â”‚ Custom                  â”‚ â”‚   â”‚
â”‚  â”‚  â”‚ Protection  â”‚  â”‚             â”‚  â”‚ Detections              â”‚ â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ Malicious â”‚  â”‚ â€¢ URL rep   â”‚  â”‚ â€¢ Your KQL rules        â”‚ â”‚   â”‚
â”‚  â”‚  â”‚   IPs/URLs  â”‚  â”‚ â€¢ Download  â”‚  â”‚ â€¢ Org-specific threats  â”‚ â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                          â”‚
â”‚  CLOUD-BASED DETECTION                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚  â”‚ Microsoft Threat    â”‚  â”‚ Automated Investigation         â”‚   â”‚   â”‚
â”‚  â”‚  â”‚ Intelligence        â”‚  â”‚ & Response (AIR)                â”‚   â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ Global threat dataâ”‚  â”‚ â€¢ Correlation                   â”‚   â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ Emerging threats  â”‚  â”‚ â€¢ Root cause analysis           â”‚   â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ Campaign tracking â”‚  â”‚ â€¢ Auto-remediation              â”‚   â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</pre>
            </div>

            <h2>Detection Sources Explained</h2>

            <h3>Antivirus (AV)</h3>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">Antivirus Detection</span>
                    <button class="code-copy">ğŸ“‹ Copy</button>
                </div>
                <div class="code-content">
<pre><code>DETECTION METHODS:

SIGNATURE-BASED:
â”œâ”€â”€ Known malware hash matching
â”œâ”€â”€ Pattern/signature matching
â”œâ”€â”€ Threat family identification
â””â”€â”€ Fastest detection for known threats

HEURISTIC:
â”œâ”€â”€ Suspicious code patterns
â”œâ”€â”€ Packer detection
â”œâ”€â”€ Obfuscation indicators
â””â”€â”€ Catches variants of known malware

CLOUD PROTECTION (MAPS):
â”œâ”€â”€ Real-time cloud lookup
â”œâ”€â”€ Unknown file analysis
â”œâ”€â”€ Machine learning models
â”œâ”€â”€ Block at First Sight (BAFS)

ALERT CHARACTERISTICS:
â€¢ Source: Microsoft Defender Antivirus
â€¢ Typically immediate blocking
â€¢ Clear malware identification
â€¢ File path and hash available
â€¢ Action usually automatic (quarantine)</code></pre>
                </div>
            </div>

            <h3>EDR (Endpoint Detection and Response)</h3>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">EDR Detection</span>
                    <button class="code-copy">ğŸ“‹ Copy</button>
                </div>
                <div class="code-content">
<pre><code>DETECTION METHODS:

BEHAVIORAL ANALYSIS:
â”œâ”€â”€ Process behavior monitoring
â”œâ”€â”€ Suspicious process chains
â”œâ”€â”€ Anomalous network activity
â”œâ”€â”€ Registry persistence detection
â””â”€â”€ Living-off-the-land detection

MACHINE LEARNING:
â”œâ”€â”€ Trained on billions of signals
â”œâ”€â”€ Anomaly detection
â”œâ”€â”€ Pattern recognition
â”œâ”€â”€ Evolves with new threats

THREAT INTELLIGENCE:
â”œâ”€â”€ Known bad indicators
â”œâ”€â”€ Threat actor TTPs
â”œâ”€â”€ Campaign correlation
â””â”€â”€ Global telemetry insights

ALERT CHARACTERISTICS:
â€¢ Source: EDR
â€¢ Behavior-based (may need investigation)
â€¢ Rich context and timeline
â€¢ MITRE ATT&CK mapping
â€¢ May not have file hash (fileless attacks)</code></pre>
                </div>
            </div>

            <h3>Attack Surface Reduction (ASR)</h3>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">ASR Detection</span>
                    <button class="code-copy">ğŸ“‹ Copy</button>
                </div>
                <div class="code-content">
<pre><code>DETECTION METHODS:

RULE-BASED BLOCKING:
â”œâ”€â”€ Pre-defined attack patterns
â”œâ”€â”€ Configurable rules
â”œâ”€â”€ Block or Audit mode
â””â”€â”€ GUID-identified rules

COMMON ASR ALERTS:
â”œâ”€â”€ Office app spawning child process
â”œâ”€â”€ Script obfuscation detected
â”œâ”€â”€ Credential stealing from LSASS
â”œâ”€â”€ Ransomware behavior blocked
â””â”€â”€ Executable content blocked

ALERT CHARACTERISTICS:
â€¢ Source: ASR
â€¢ Preventive (blocks before damage)
â€¢ Rule ID in alert
â€¢ Clear action (Block/Audit)
â€¢ May be FP for legitimate tools</code></pre>
                </div>
            </div>

            <h3>Network Protection</h3>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">Network Protection Detection</span>
                    <button class="code-copy">ğŸ“‹ Copy</button>
                </div>
                <div class="code-content">
<pre><code>DETECTION METHODS:

URL/IP REPUTATION:
â”œâ”€â”€ Known malicious domains
â”œâ”€â”€ C2 infrastructure
â”œâ”€â”€ Phishing sites
â”œâ”€â”€ Malware distribution

WEB CONTENT FILTERING:
â”œâ”€â”€ Category-based blocking
â”œâ”€â”€ Custom indicators
â”œâ”€â”€ Adult content blocking
â””â”€â”€ Policy-based restrictions

ALERT CHARACTERISTICS:
â€¢ Source: Network Protection
â€¢ Connection blocked or warned
â€¢ Remote IP/URL in evidence
â€¢ Initiating process identified
â€¢ May indicate C2 or phishing</code></pre>
                </div>
            </div>

            <h3>Custom Detections</h3>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">Custom Detection</span>
                    <button class="code-copy">ğŸ“‹ Copy</button>
                </div>
                <div class="code-content">
<pre><code>DETECTION METHODS:

KQL-BASED RULES:
â”œâ”€â”€ Your hunting queries as alerts
â”œâ”€â”€ Scheduled execution
â”œâ”€â”€ Custom logic and thresholds
â””â”€â”€ Organization-specific threats

INDICATOR MATCHES:
â”œâ”€â”€ Custom IOCs you've added
â”œâ”€â”€ File hashes
â”œâ”€â”€ IP addresses
â”œâ”€â”€ Domains/URLs

ALERT CHARACTERISTICS:
â€¢ Source: Custom detection
â€¢ Rule name you defined
â€¢ Your severity and category
â€¢ Mapped entities from query
â€¢ Your response actions</code></pre>
                </div>
            </div>

            <h2>Detection Source Comparison</h2>

            <div class="table-wrapper">
                <table>
                    <thead>
                        <tr>
                            <th>Source</th>
                            <th>Speed</th>
                            <th>Coverage</th>
                            <th>FP Rate</th>
                            <th>Investigation Need</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Antivirus</strong></td>
                            <td>Immediate</td>
                            <td>Known malware</td>
                            <td>Very Low</td>
                            <td>Low (usually clear verdict)</td>
                        </tr>
                        <tr>
                            <td><strong>EDR Behavioral</strong></td>
                            <td>Near real-time</td>
                            <td>Suspicious behavior</td>
                            <td>Medium</td>
                            <td>High (requires analysis)</td>
                        </tr>
                        <tr>
                            <td><strong>ASR Rules</strong></td>
                            <td>Immediate</td>
                            <td>Attack patterns</td>
                            <td>Medium</td>
                            <td>Medium (verify legitimacy)</td>
                        </tr>
                        <tr>
                            <td><strong>Network Protection</strong></td>
                            <td>Immediate</td>
                            <td>Malicious network</td>
                            <td>Low</td>
                            <td>Medium (check intent)</td>
                        </tr>
                        <tr>
                            <td><strong>Custom Detections</strong></td>
                            <td>Scheduled</td>
                            <td>Org-specific</td>
                            <td>Varies</td>
                            <td>Varies (your tuning)</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <h2>Alert Investigation by Source</h2>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">Investigation Approach</span>
                    <button class="code-copy">ğŸ“‹ Copy</button>
                </div>
                <div class="code-content">
<pre><code>AV ALERT INVESTIGATION:
1. Check threat name - research the malware family
2. Verify file was quarantined
3. Check device timeline for how file arrived
4. Look for lateral spread
5. Usually straightforward - verify remediation

EDR BEHAVIORAL ALERT INVESTIGATION:
1. Review the alert story and timeline
2. Understand the full process chain
3. Analyze command lines in detail
4. Check network connections
5. Correlate with user activity
6. May require hunting for scope

ASR ALERT INVESTIGATION:
1. Identify which ASR rule triggered
2. Check if blocked action was legitimate
3. Common FP: IT tools, dev activities
4. If FP, consider exclusion for that app
5. If TP, investigate full attack chain

NETWORK PROTECTION INVESTIGATION:
1. Check what URL/IP was blocked
2. Identify the connecting process
3. Research the destination reputation
4. Check for prior successful connections
5. May indicate already compromised</code></pre>
                </div>
            </div>

            <h2>Identifying Source in Alerts</h2>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">KQL - Detection Source Analysis</span>
                    <button class="code-copy">ğŸ“‹ Copy</button>
                </div>
                <div class="code-content">
<pre><code><span class="comment">// Alert count by detection source</span>
<span class="variable">AlertInfo</span>
<span class="operator">|</span> <span class="keyword">where</span> Timestamp <span class="operator">></span> <span class="function">ago</span>(<span class="number">30</span>d)
<span class="operator">|</span> <span class="keyword">summarize</span> Count <span class="operator">=</span> <span class="function">count</span>() <span class="keyword">by</span> DetectionSource
<span class="operator">|</span> <span class="keyword">order by</span> Count <span class="keyword">desc</span>

<span class="comment">// AV detections specifically</span>
<span class="variable">AlertInfo</span>
<span class="operator">|</span> <span class="keyword">where</span> Timestamp <span class="operator">></span> <span class="function">ago</span>(<span class="number">7</span>d)
<span class="operator">|</span> <span class="keyword">where</span> DetectionSource <span class="operator">==</span> <span class="string">"Antivirus"</span>
<span class="operator">|</span> <span class="keyword">project</span> Timestamp, Title, Severity

<span class="comment">// EDR behavioral detections</span>
<span class="variable">AlertInfo</span>
<span class="operator">|</span> <span class="keyword">where</span> Timestamp <span class="operator">></span> <span class="function">ago</span>(<span class="number">7</span>d)
<span class="operator">|</span> <span class="keyword">where</span> DetectionSource <span class="operator">==</span> <span class="string">"EDR"</span>
<span class="operator">|</span> <span class="keyword">summarize</span> Count <span class="operator">=</span> <span class="function">count</span>() <span class="keyword">by</span> Title
<span class="operator">|</span> <span class="keyword">order by</span> Count <span class="keyword">desc</span></code></pre>
                </div>
            </div>

            <!-- Day-to-Day Section -->
            <div class="day-to-day">
                <h3>ğŸ”§ Security Engineer Day-to-Day Tasks</h3>
                
                <h4>Detection Analysis</h4>
                <ul>
                    <li>Review alerts and identify detection source</li>
                    <li>Adjust investigation approach based on source</li>
                    <li>Tune ASR rules based on FP patterns</li>
                    <li>Create custom detections for gaps</li>
                    <li>Monitor detection source metrics</li>
                </ul>

                <h4>Common Patterns</h4>
                <div class="ticket-item">
                    <span class="ticket-type">"AV detection on server"</span>
                    <span class="ticket-solution">â†’ Usually clear-cut. Verify quarantine, check arrival vector, scan for spread.</span>
                </div>
                <div class="ticket-item">
                    <span class="ticket-type">"EDR behavioral alert"</span>
                    <span class="ticket-solution">â†’ Requires investigation. Check timeline, process tree, user context.</span>
                </div>
                <div class="ticket-item">
                    <span class="ticket-type">"ASR block on IT admin"</span>
                    <span class="ticket-solution">â†’ Likely FP for legitimate tool. Verify, then create exclusion if valid.</span>
                </div>
            </div>

            <!-- Interview Tips -->
            <div class="interview-tips">
                <h3>ğŸ’¡ Key Interview Points</h3>
                <ul>
                    <li><strong>AV</strong>: Signature/heuristic/cloud - fast, known malware, low FP</li>
                    <li><strong>EDR</strong>: Behavioral analysis - catches unknown threats, needs investigation</li>
                    <li><strong>ASR</strong>: Rule-based prevention - blocks attack patterns, may have FPs</li>
                    <li><strong>Network Protection</strong>: Blocks malicious network connections</li>
                    <li><strong>Custom</strong>: Your KQL queries as automated alerts</li>
                    <li><strong>Investigation approach</strong>: Varies by source - AV is quick, EDR needs depth</li>
                </ul>
            </div>

            <nav class="page-nav">
                <a href="4-1-edr-overview.html" class="page-nav-link prev">
                    <span class="page-nav-label">â† Previous</span>
                    <span class="page-nav-title">EDR Overview</span>
                </a>
                <a href="4-3-alert-investigation.html" class="page-nav-link next">
                    <span class="page-nav-label">Next â†’</span>
                    <span class="page-nav-title">Alert Investigation</span>
                </a>
            </nav>
        </div>
    </main>

    <div class="search-modal">
        <div class="search-modal-content">
            <div class="search-modal-input-wrapper">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="11" cy="11" r="8"></circle>
                    <path d="M21 21l-4.35-4.35"></path>
                </svg>
                <input type="text" class="search-modal-input" placeholder="Search pages..." autofocus>
                <button class="search-modal-close">ESC</button>
            </div>
            <div class="search-results"></div>
        </div>
    </div>
    <script src="main.js"></script>
</body>
</html>
