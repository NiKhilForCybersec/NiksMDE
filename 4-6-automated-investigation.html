<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Automated Investigation | MDE Ultimate Guide</title>
    <link rel="stylesheet" href="main.css">
</head>
<body>
    <header class="header">
        <div class="header-left">
            <button class="mobile-menu-btn" aria-label="Toggle menu">â˜°</button>
            <a href="index.html" class="logo">
                <div class="logo-icon">MDE</div>
                <div class="logo-text"><span>MDE</span> Ultimate Guide</div>
            </a>
        </div>
        <div class="search-container">
            <button class="search-btn">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="11" cy="11" r="8"></circle>
                    <path d="M21 21l-4.35-4.35"></path>
                </svg>
                <span>Search documentation...</span>
                <span class="search-shortcut"><kbd>âŒ˜</kbd><kbd>K</kbd></span>
            </button>
        </div>
        <div class="header-right">
            <a href="12-2-interview-questions.html" class="header-link">Interview Prep</a>
            <a href="5-3-kql-fundamentals.html" class="header-link">KQL Guide</a>
        </div>
    </header>

    <div class="sidebar-overlay"></div>
    <aside class="sidebar"></aside>

    <main class="main-content">
        <div class="content-wrapper">
            <div class="overview-box">
                <h4>ğŸ¯ What This Page Covers</h4>
                <p>Complete guide to Automated Investigation and Response (AIR) in MDE. Learn how AIR analyzes alerts, determines verdicts, takes remediation actions, and how to configure automation levels for your organization.</p>
            </div>

            <h1>Automated Investigation and Response (AIR)</h1>

            <p>AIR automatically investigates alerts, analyzes evidence, determines verdicts, and can remediate threats without analyst intervention. It acts like a virtual analyst working 24/7 to reduce investigation workload and response time.</p>

            <h2>How AIR Works</h2>

            <div class="flow-diagram">
                <div class="diagram-title">Automated Investigation Flow</div>
<pre>
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              AUTOMATED INVESTIGATION AND RESPONSE FLOW                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  TRIGGER                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Alert Generated â”‚ Analyst Request â”‚ API Trigger â”‚ Incident      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                               â”‚                                          â”‚
â”‚                               â–¼                                          â”‚
â”‚  INVESTIGATION                                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚   â”‚
â”‚  â”‚  â”‚ Collect      â”‚â”€â”€â–ºâ”‚ Analyze      â”‚â”€â”€â–ºâ”‚ Correlate    â”‚        â”‚   â”‚
â”‚  â”‚  â”‚ Evidence     â”‚   â”‚ Entities     â”‚   â”‚ Related      â”‚        â”‚   â”‚
â”‚  â”‚  â”‚              â”‚   â”‚              â”‚   â”‚ Alerts       â”‚        â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ Files      â”‚   â”‚ â€¢ Reputation â”‚   â”‚              â”‚        â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ Processes  â”‚   â”‚ â€¢ Behavior   â”‚   â”‚ â€¢ Timeline   â”‚        â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ Registry   â”‚   â”‚ â€¢ Prevalence â”‚   â”‚ â€¢ Other      â”‚        â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ Network    â”‚   â”‚ â€¢ Signatures â”‚   â”‚   devices    â”‚        â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                               â”‚                                          â”‚
â”‚                               â–¼                                          â”‚
â”‚  VERDICT                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚  â”‚ MALICIOUS   â”‚  â”‚ SUSPICIOUS  â”‚  â”‚ NO THREATS FOUND      â”‚   â”‚   â”‚
â”‚  â”‚  â”‚ Confirmed   â”‚  â”‚ Needs reviewâ”‚  â”‚ Clean / False positiveâ”‚   â”‚   â”‚
â”‚  â”‚  â”‚ threat      â”‚  â”‚             â”‚  â”‚                       â”‚   â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â”‚         â”‚                â”‚                      â”‚               â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚            â”‚                â”‚                      â”‚                    â”‚
â”‚            â–¼                â–¼                      â–¼                    â”‚
â”‚  REMEDIATION                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Full Auto:      â”‚ Semi Auto:        â”‚ No Auto:                  â”‚   â”‚
â”‚  â”‚ Auto-remediate  â”‚ Pending approval  â”‚ Manual action             â”‚   â”‚
â”‚  â”‚ immediately     â”‚ in Action Center  â”‚ required                  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</pre>
            </div>

            <h2>Investigation Triggers</h2>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">What Triggers AIR</span>
                    <button class="code-copy">ğŸ“‹ Copy</button>
                </div>
                <div class="code-content">
<pre><code>AUTOMATIC TRIGGERS:

ALERT-BASED:
â”œâ”€â”€ High-severity alerts automatically trigger AIR
â”œâ”€â”€ Medium-severity alerts may trigger based on type
â”œâ”€â”€ Specific detection categories trigger investigation
â””â”€â”€ Examples:
    â”œâ”€â”€ Malware detected
    â”œâ”€â”€ Suspicious PowerShell
    â”œâ”€â”€ Credential theft attempt
    â”œâ”€â”€ Ransomware behavior
    â””â”€â”€ C2 communication

INCIDENT-BASED:
â”œâ”€â”€ New incident created â†’ AIR runs on all alerts
â”œâ”€â”€ Alert added to incident â†’ AIR continues
â””â”€â”€ Correlation discovery â†’ Expanded investigation

MANUAL TRIGGERS:

FROM ALERT PAGE:
â”œâ”€â”€ Click alert â†’ "Investigate"
â”œâ”€â”€ Forces AIR to run on specific alert
â””â”€â”€ Useful when auto didn't trigger

FROM DEVICE PAGE:
â”œâ”€â”€ Device â†’ "Initiate Automated Investigation"
â”œâ”€â”€ Investigates entire device state
â””â”€â”€ Comprehensive device analysis

FROM INCIDENT PAGE:
â”œâ”€â”€ Incident â†’ "Trigger investigation"
â”œâ”€â”€ Runs on all incident evidence
â””â”€â”€ Expands existing investigation

VIA API:
POST /api/machines/{id}/startInvestigation
â””â”€â”€ Automate investigation triggering</code></pre>
                </div>
            </div>

            <h2>Investigation Process</h2>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">What AIR Analyzes</span>
                    <button class="code-copy">ğŸ“‹ Copy</button>
                </div>
                <div class="code-content">
<pre><code>ENTITIES ANALYZED:

FILES:
â”œâ”€â”€ File reputation (cloud lookup)
â”œâ”€â”€ Digital signature verification
â”œâ”€â”€ Prevalence in organization
â”œâ”€â”€ Prevalence globally
â”œâ”€â”€ First seen / last seen dates
â”œâ”€â”€ File behavior (sandbox results)
â”œâ”€â”€ Related alerts
â””â”€â”€ Verdict: Clean, Suspicious, Malicious

PROCESSES:
â”œâ”€â”€ Process tree analysis
â”œâ”€â”€ Command line inspection
â”œâ”€â”€ Parent-child relationships
â”œâ”€â”€ User context
â”œâ”€â”€ Behavior patterns
â”œâ”€â”€ Known attack techniques
â””â”€â”€ Verdict: Normal, Suspicious, Malicious

NETWORK CONNECTIONS:
â”œâ”€â”€ Destination reputation
â”œâ”€â”€ Connection patterns
â”œâ”€â”€ Data volume
â”œâ”€â”€ Known C2 infrastructure
â”œâ”€â”€ DNS queries
â””â”€â”€ Verdict: Safe, Suspicious, Malicious

REGISTRY KEYS:
â”œâ”€â”€ Known persistence locations
â”œâ”€â”€ Value analysis
â”œâ”€â”€ Creation timeline
â”œâ”€â”€ Associated processes
â””â”€â”€ Verdict: Normal, Suspicious, Malicious

USER ACCOUNTS:
â”œâ”€â”€ Account activity
â”œâ”€â”€ Logon patterns
â”œâ”€â”€ Privilege usage
â”œâ”€â”€ Related alerts
â””â”€â”€ Risk assessment

CORRELATION:
â”œâ”€â”€ Other devices with same IOCs
â”œâ”€â”€ Other users affected
â”œâ”€â”€ Related alerts across tenant
â”œâ”€â”€ Timeline correlation
â””â”€â”€ Attack chain reconstruction</code></pre>
                </div>
            </div>

            <h2>Automation Levels</h2>

            <div class="table-wrapper">
                <table>
                    <thead>
                        <tr>
                            <th>Level</th>
                            <th>Behavior</th>
                            <th>Use Case</th>
                            <th>Recommended For</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Full</strong></td>
                            <td>Auto-remediate all threats</td>
                            <td>Maximum speed, minimum manual work</td>
                            <td>Most organizations</td>
                        </tr>
                        <tr>
                            <td><strong>Semi - Core folders</strong></td>
                            <td>Auto-remediate in Windows/Program Files only</td>
                            <td>Protect system, review user files</td>
                            <td>Conservative approach</td>
                        </tr>
                        <tr>
                            <td><strong>Semi - Any folder</strong></td>
                            <td>All remediation needs approval</td>
                            <td>Review everything before action</td>
                            <td>High-control environments</td>
                        </tr>
                        <tr>
                            <td><strong>No automation</strong></td>
                            <td>Investigation only, no remediation</td>
                            <td>Manual response only</td>
                            <td>Not recommended</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">Configuring Automation Levels</span>
                    <button class="code-copy">ğŸ“‹ Copy</button>
                </div>
                <div class="code-content">
<pre><code>CONFIGURATION PATH:
Settings â†’ Endpoints â†’ Device groups

PER DEVICE GROUP:
â”œâ”€â”€ Each device group can have different automation
â”œâ”€â”€ Servers: May want semi-auto
â”œâ”€â”€ Workstations: Full auto OK
â”œâ”€â”€ Critical assets: Higher control
â””â”€â”€ Test groups: Full auto for testing

EXAMPLE CONFIGURATION:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Device Group          â”‚ Automation Level        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ All Workstations      â”‚ Full                    â”‚
â”‚ Windows Servers       â”‚ Semi - any folder       â”‚
â”‚ Domain Controllers    â”‚ No automated response   â”‚
â”‚ Executive Devices     â”‚ Full (fast response)    â”‚
â”‚ Test Lab              â”‚ Full                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

CHANGING AUTOMATION:
1. Settings â†’ Endpoints â†’ Device groups
2. Select device group
3. Edit â†’ Automation level
4. Save changes
5. Changes apply to new investigations</code></pre>
                </div>
            </div>

            <h2>Investigation Status and Verdicts</h2>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">Investigation States</span>
                    <button class="code-copy">ğŸ“‹ Copy</button>
                </div>
                <div class="code-content">
<pre><code>INVESTIGATION STATUS:

RUNNING:
â”œâ”€â”€ Investigation in progress
â”œâ”€â”€ Collecting and analyzing evidence
â”œâ”€â”€ May take 10-60 minutes
â””â”€â”€ Can run in parallel with other work

PENDING ACTION:
â”œâ”€â”€ Investigation complete
â”œâ”€â”€ Remediation actions waiting approval
â”œâ”€â”€ Check Action Center â†’ Pending
â””â”€â”€ Analyst must approve/reject

PARTIALLY REMEDIATED:
â”œâ”€â”€ Some actions completed
â”œâ”€â”€ Some actions failed or pending
â”œâ”€â”€ Review what's left
â””â”€â”€ May need manual intervention

REMEDIATED:
â”œâ”€â”€ All malicious entities remediated
â”œâ”€â”€ Threat contained
â”œâ”€â”€ Verify in timeline
â””â”€â”€ Investigation successful

NO THREATS FOUND:
â”œâ”€â”€ Investigation found nothing malicious
â”œâ”€â”€ May be false positive
â”œâ”€â”€ May need manual review
â””â”€â”€ Consider alert tuning

FAILED:
â”œâ”€â”€ Investigation couldn't complete
â”œâ”€â”€ Check for issues (offline device, etc.)
â”œâ”€â”€ May need manual investigation
â””â”€â”€ Retry or investigate manually

TERMINATED BY SYSTEM:
â”œâ”€â”€ Exceeded time or resource limits
â”œâ”€â”€ May need to split investigation
â””â”€â”€ Investigate manually

TERMINATED BY USER:
â”œâ”€â”€ Analyst cancelled investigation
â”œâ”€â”€ Resources redirected elsewhere
â””â”€â”€ May resume later</code></pre>
                </div>
            </div>

            <h2>Remediation Actions</h2>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">Actions AIR Can Take</span>
                    <button class="code-copy">ğŸ“‹ Copy</button>
                </div>
                <div class="code-content">
<pre><code>AUTOMATED REMEDIATION ACTIONS:

FILE ACTIONS:
â”œâ”€â”€ Quarantine file
â”œâ”€â”€ Remove file
â”œâ”€â”€ Block file (add to indicators)
â”œâ”€â”€ Stop and quarantine
â””â”€â”€ Collect file for analysis

PROCESS ACTIONS:
â”œâ”€â”€ Stop process
â”œâ”€â”€ Block process (hash)
â””â”€â”€ Quarantine associated file

PERSISTENCE ACTIONS:
â”œâ”€â”€ Remove scheduled task
â”œâ”€â”€ Remove registry key
â”œâ”€â”€ Remove service
â”œâ”€â”€ Remove WMI subscription
â””â”€â”€ Remove startup entry

NETWORK ACTIONS:
â”œâ”€â”€ Block IP (add indicator)
â”œâ”€â”€ Block domain (add indicator)
â””â”€â”€ Isolate device (if configured)

USER ACTIONS (with integration):
â”œâ”€â”€ Disable account
â”œâ”€â”€ Require re-authentication
â””â”€â”€ Revoke sessions

ACTION CENTER VISIBILITY:
â”œâ”€â”€ All actions logged
â”œâ”€â”€ Pending actions need approval
â”œâ”€â”€ History shows completed actions
â”œâ”€â”€ Can undo some actions (unquarantine)</code></pre>
                </div>
            </div>

            <h2>Reviewing Investigations</h2>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">Investigation Review Workflow</span>
                    <button class="code-copy">ğŸ“‹ Copy</button>
                </div>
                <div class="code-content">
<pre><code>VIEWING INVESTIGATION RESULTS:

FROM ALERT:
Alert page â†’ Investigation tab
â”œâ”€â”€ Shows investigation status
â”œâ”€â”€ Entities analyzed
â”œâ”€â”€ Verdicts per entity
â”œâ”€â”€ Actions taken/pending
â””â”€â”€ Related investigations

FROM INCIDENT:
Incident â†’ Investigations tab
â”œâ”€â”€ All investigations for incident
â”œâ”€â”€ Aggregated results
â”œâ”€â”€ Combined evidence
â””â”€â”€ Overall status

FROM ACTION CENTER:
Action center â†’ History
â”œâ”€â”€ All completed actions
â”œâ”€â”€ Filter by investigation
â”œâ”€â”€ See what was remediated
â””â”€â”€ Track action success/failure

INVESTIGATION DETAILS PAGE:
â”œâ”€â”€ Investigation graph (visual)
â”œâ”€â”€ Evidence list
â”œâ”€â”€ Entity verdicts
â”œâ”€â”€ Actions taken
â”œâ”€â”€ Timeline of investigation
â””â”€â”€ Related alerts/devices

WHAT TO REVIEW:
1. Were all threats identified?
2. Were verdicts accurate?
3. Did remediation succeed?
4. Any missed indicators?
5. Need additional hunting?
6. Scope fully assessed?</code></pre>
                </div>
            </div>

            <h2>KQL for AIR Analysis</h2>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">KQL - Investigation Queries</span>
                    <button class="code-copy">ğŸ“‹ Copy</button>
                </div>
                <div class="code-content">
<pre><code><span class="comment">// Recent automated investigations</span>
<span class="variable">AlertInfo</span>
<span class="operator">|</span> <span class="keyword">where</span> Timestamp <span class="operator">></span> <span class="function">ago</span>(<span class="number">7</span>d)
<span class="operator">|</span> <span class="keyword">join</span> <span class="keyword">kind=inner</span> <span class="variable">AlertEvidence</span> <span class="keyword">on</span> AlertId
<span class="operator">|</span> <span class="keyword">where</span> <span class="function">isnotempty</span>(InvestigationId)
<span class="operator">|</span> <span class="keyword">summarize</span> by InvestigationId, Title, Severity

<span class="comment">// Remediation actions taken by AIR</span>
<span class="variable">DeviceEvents</span>
<span class="operator">|</span> <span class="keyword">where</span> Timestamp <span class="operator">></span> <span class="function">ago</span>(<span class="number">7</span>d)
<span class="operator">|</span> <span class="keyword">where</span> InitiatingProcessFileName <span class="operator">==</span> <span class="string">"MsSense.exe"</span>
<span class="operator">|</span> <span class="keyword">where</span> ActionType <span class="function">has_any</span> (<span class="string">"Quarantine"</span>, <span class="string">"Block"</span>, <span class="string">"Remediate"</span>)
<span class="operator">|</span> <span class="keyword">project</span> Timestamp, DeviceName, ActionType, FileName

<span class="comment">// Files quarantined by automation</span>
<span class="variable">DeviceEvents</span>
<span class="operator">|</span> <span class="keyword">where</span> Timestamp <span class="operator">></span> <span class="function">ago</span>(<span class="number">7</span>d)
<span class="operator">|</span> <span class="keyword">where</span> ActionType <span class="operator">==</span> <span class="string">"AntivirusDetection"</span>
<span class="operator">|</span> <span class="keyword">extend</span> Fields = <span class="function">parse_json</span>(AdditionalFields)
<span class="operator">|</span> <span class="keyword">where</span> Fields.Action <span class="operator">==</span> <span class="string">"Quarantine"</span>
<span class="operator">|</span> <span class="keyword">project</span> Timestamp, DeviceName, FileName, Fields.ThreatName</code></pre>
                </div>
            </div>

            <div class="callout tip">
                <div class="callout-icon">ğŸ’¡</div>
                <div class="callout-content">
                    <h5>Best Practices</h5>
                    <ul>
                        <li><strong>Use Full automation</strong> for workstations - faster response, proven accuracy</li>
                        <li><strong>Review pending actions daily</strong> - don't let them pile up</li>
                        <li><strong>Monitor investigation failures</strong> - may indicate issues</li>
                        <li><strong>Trust but verify</strong> - spot-check automated verdicts</li>
                        <li><strong>Adjust automation by device type</strong> - critical servers may need review</li>
                    </ul>
                </div>
            </div>

            <!-- Day-to-Day Section -->
            <div class="day-to-day">
                <h3>ğŸ”§ Security Engineer Day-to-Day Tasks</h3>
                
                <h4>AIR Operations</h4>
                <ul>
                    <li>Review pending remediation actions</li>
                    <li>Monitor investigation success rates</li>
                    <li>Validate automated verdicts</li>
                    <li>Trigger manual investigations when needed</li>
                    <li>Configure automation levels per device group</li>
                    <li>Handle failed investigations</li>
                </ul>

                <h4>Common Scenarios</h4>
                <div class="ticket-item">
                    <span class="ticket-type">"Investigation stuck in Running"</span>
                    <span class="ticket-solution">â†’ Check device online, may be collecting evidence. Wait or investigate manually.</span>
                </div>
                <div class="ticket-item">
                    <span class="ticket-type">"Too many pending actions"</span>
                    <span class="ticket-solution">â†’ Review and batch approve legitimate ones. Consider increasing automation level.</span>
                </div>
                <div class="ticket-item">
                    <span class="ticket-type">"AIR missed something"</span>
                    <span class="ticket-solution">â†’ Manual hunting required. AIR is good but not perfect. Add custom detection if gap found.</span>
                </div>
            </div>

            <!-- Interview Tips -->
            <div class="interview-tips">
                <h3>ğŸ’¡ Key Interview Points</h3>
                <ul>
                    <li><strong>Purpose</strong>: Automatically investigate alerts and remediate threats</li>
                    <li><strong>Triggers</strong>: Alerts, incidents, manual request, API</li>
                    <li><strong>What it analyzes</strong>: Files, processes, network, registry, users</li>
                    <li><strong>Automation levels</strong>: Full, Semi (core/any folder), None</li>
                    <li><strong>Verdicts</strong>: Malicious, Suspicious, No threats found</li>
                    <li><strong>Actions</strong>: Quarantine, block, stop process, remove persistence</li>
                    <li><strong>Best practice</strong>: Full automation for workstations, review servers</li>
                </ul>
            </div>

            <nav class="page-nav">
                <a href="4-5-live-response.html" class="page-nav-link prev">
                    <span class="page-nav-label">â† Previous</span>
                    <span class="page-nav-title">Live Response</span>
                </a>
                <a href="4-7-custom-detections.html" class="page-nav-link next">
                    <span class="page-nav-label">Next â†’</span>
                    <span class="page-nav-title">Custom Detections</span>
                </a>
            </nav>
        </div>
    </main>

    <div class="search-modal">
        <div class="search-modal-content">
            <div class="search-modal-input-wrapper">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="11" cy="11" r="8"></circle>
                    <path d="M21 21l-4.35-4.35"></path>
                </svg>
                <input type="text" class="search-modal-input" placeholder="Search pages..." autofocus>
                <button class="search-modal-close">ESC</button>
            </div>
            <div class="search-results"></div>
        </div>
    </div>
    <script src="main.js"></script>
</body>
</html>
