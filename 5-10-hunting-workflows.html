<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hunting Workflows | MDE Ultimate Guide</title>
    <link rel="stylesheet" href="main.css">
</head>
<body>
    <header class="header">
        <div class="header-left">
            <button class="mobile-menu-btn" aria-label="Toggle menu">â˜°</button>
            <a href="index.html" class="logo">
                <div class="logo-icon">MDE</div>
                <div class="logo-text"><span>MDE</span> Ultimate Guide</div>
            </a>
        </div>
        <div class="search-container">
            <button class="search-btn">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="11" cy="11" r="8"></circle>
                    <path d="M21 21l-4.35-4.35"></path>
                </svg>
                <span>Search documentation...</span>
                <span class="search-shortcut"><kbd>âŒ˜</kbd><kbd>K</kbd></span>
            </button>
        </div>
        <div class="header-right">
            <a href="12-2-interview-questions.html" class="header-link">Interview Prep</a>
            <a href="5-3-kql-fundamentals.html" class="header-link">KQL Guide</a>
        </div>
    </header>

    <div class="sidebar-overlay"></div>
    <aside class="sidebar"></aside>

    <main class="main-content">
        <div class="content-wrapper">
            <div class="overview-box">
                <h4>ğŸ¯ What This Page Covers</h4>
                <p>Structured threat hunting workflows and methodologies. Learn hypothesis-driven hunting, scheduled hunts, and how to build an effective threat hunting program.</p>
            </div>

            <h1>Hunting Workflows</h1>

            <p>Effective threat hunting requires structured workflows that combine threat intelligence, hypothesis development, and systematic investigation to proactively identify threats that evade automated detection.</p>

            <h2>Threat Hunting Framework</h2>

            <div class="flow-diagram">
                <div class="diagram-title">Hunting Workflow Cycle</div>
<pre>
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    THREAT HUNTING WORKFLOW                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                  â”‚
â”‚                    â”‚  1. HYPOTHESIS  â”‚                                  â”‚
â”‚                    â”‚   GENERATION    â”‚                                  â”‚
â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                  â”‚
â”‚                             â”‚                                           â”‚
â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚      â–¼                      â–¼                      â–¼                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚ Threat â”‚          â”‚  MITRE     â”‚         â”‚ Anomaly  â”‚              â”‚
â”‚  â”‚ Intel  â”‚          â”‚  ATT&CK    â”‚         â”‚ Based    â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚                             â”‚                                           â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”                                  â”‚
â”‚                    â”‚  2. DATA        â”‚                                  â”‚
â”‚                    â”‚   COLLECTION    â”‚                                  â”‚
â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                  â”‚
â”‚                             â”‚                                           â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”                                  â”‚
â”‚                    â”‚  3. HUNTING     â”‚                                  â”‚
â”‚                    â”‚   EXECUTION     â”‚                                  â”‚
â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                  â”‚
â”‚                             â”‚                                           â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”‚
â”‚              â–¼              â–¼              â–¼                            â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚         â”‚ Findingâ”‚    â”‚ No      â”‚    â”‚ Improve â”‚                       â”‚
â”‚         â”‚ = IR   â”‚    â”‚ Finding â”‚    â”‚ Detectionâ”‚                      â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
â”‚                             â”‚                                           â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”                                  â”‚
â”‚                    â”‚  4. DOCUMENT    â”‚                                  â”‚
â”‚                    â”‚   & IMPROVE     â”‚                                  â”‚
â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                  â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</pre>
            </div>

            <h2>Hypothesis-Driven Hunting</h2>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">Hypothesis Development</span>
                    <button class="code-copy">ğŸ“‹ Copy</button>
                </div>
                <div class="code-content">
<pre><code>HYPOTHESIS TEMPLATE:

"Given [THREAT/TTP], I believe [ATTACKER BEHAVIOR] 
 may be occurring in [ENVIRONMENT/SCOPE] 
 because [REASONING/INTELLIGENCE]"

EXAMPLE HYPOTHESES:

1. THREAT INTEL DRIVEN:
   "Given recent Emotet campaigns targeting our industry,
    I believe malicious Office documents may have delivered
    malware via email in the past 30 days because we received
    threat intel about active campaigns."

2. MITRE ATT&CK DRIVEN:
   "Given T1055 (Process Injection) is common in APT attacks,
    I believe attackers may be injecting code into legitimate
    processes on our endpoints because we have gaps in this
    detection area."

3. ANOMALY DRIVEN:
   "Given baseline network behavior patterns,
    I believe unusual outbound connections may indicate C2
    communication because we detected statistical outliers
    in DNS query volumes."

4. INCIDENT DRIVEN:
   "Given the recent phishing incident affecting HR,
    I believe similar attacks may have succeeded against
    other departments because the campaign was widespread."

HYPOTHESIS VALIDATION:
â”œâ”€â”€ Define success criteria
â”œâ”€â”€ Identify data sources needed
â”œâ”€â”€ Set time scope
â”œâ”€â”€ Document search methodology
â””â”€â”€ Plan escalation path if threat found</code></pre>
                </div>
            </div>

            <h2>Structured Hunt Template</h2>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">Hunt Documentation Template</span>
                    <button class="code-copy">ğŸ“‹ Copy</button>
                </div>
                <div class="code-content">
<pre><code>â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                    THREAT HUNT TEMPLATE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

HUNT ID: TH-2024-001
DATE: [Date]
HUNTER: [Name]
STATUS: Planning / Active / Complete

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
HYPOTHESIS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Statement: [Clear hypothesis statement]
Trigger: [What prompted this hunt - TI, incident, gap analysis]
MITRE ATT&CK: [Relevant techniques - e.g., T1059.001]
Priority: High / Medium / Low

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
SCOPE
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Time Range: [e.g., Last 30 days]
Devices: [All / Specific groups / Specific devices]
Data Sources: [Tables to query]
Estimated Effort: [Hours]

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
METHODOLOGY
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Step 1: [Initial broad search]
Step 2: [Narrow based on results]
Step 3: [Deep dive on anomalies]
Step 4: [Validate/correlate findings]

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
QUERIES USED
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Query 1: [KQL query]
Purpose: [What this query looks for]
Results: [Count / summary]

Query 2: [KQL query]
Purpose: [What this query looks for]
Results: [Count / summary]

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
FINDINGS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[ ] No suspicious activity found
[ ] Suspicious activity - requires investigation
[ ] Confirmed threat - escalated to IR

Details: [Description of findings]
Evidence: [Links to queries, screenshots, device IDs]

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
OUTCOMES
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[ ] New detection rule created: [Rule name]
[ ] Existing detection tuned: [Rule name]
[ ] Incident created: [Incident ID]
[ ] No action required
[ ] Baseline updated

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
LESSONS LEARNED
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[What worked, what didn't, improvements for next time]

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</code></pre>
                </div>
            </div>

            <h2>Weekly Hunt Schedule</h2>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">Sample Hunt Schedule</span>
                    <button class="code-copy">ğŸ“‹ Copy</button>
                </div>
                <div class="code-content">
<pre><code>WEEKLY THREAT HUNTING SCHEDULE:

MONDAY: INITIAL ACCESS
â”œâ”€â”€ Hunt: Suspicious email attachments
â”œâ”€â”€ Hunt: Malicious downloads
â”œâ”€â”€ Hunt: Drive-by compromise indicators
â””â”€â”€ Tables: EmailEvents, DeviceFileEvents, DeviceNetworkEvents

TUESDAY: EXECUTION & PERSISTENCE  
â”œâ”€â”€ Hunt: Suspicious PowerShell execution
â”œâ”€â”€ Hunt: Scheduled task creation
â”œâ”€â”€ Hunt: Registry persistence mechanisms
â””â”€â”€ Tables: DeviceProcessEvents, DeviceRegistryEvents

WEDNESDAY: CREDENTIAL ACCESS
â”œâ”€â”€ Hunt: LSASS access attempts
â”œâ”€â”€ Hunt: Credential dumping tools
â”œâ”€â”€ Hunt: Suspicious authentication patterns
â””â”€â”€ Tables: DeviceProcessEvents, DeviceLogonEvents

THURSDAY: LATERAL MOVEMENT
â”œâ”€â”€ Hunt: Remote service creation
â”œâ”€â”€ Hunt: Admin tool usage (PsExec, WMI)
â”œâ”€â”€ Hunt: Unusual SMB connections
â””â”€â”€ Tables: DeviceNetworkEvents, DeviceProcessEvents

FRIDAY: EXFILTRATION & C2
â”œâ”€â”€ Hunt: Data staging
â”œâ”€â”€ Hunt: Unusual outbound traffic
â”œâ”€â”€ Hunt: DNS tunneling indicators
â””â”€â”€ Tables: DeviceNetworkEvents, DeviceFileEvents

RECURRING (MONTHLY):
â”œâ”€â”€ Full MITRE ATT&CK coverage review
â”œâ”€â”€ Threat intelligence-driven hunts
â”œâ”€â”€ Hunt backlog review
â””â”€â”€ Detection gap analysis</code></pre>
                </div>
            </div>

            <h2>Hunt Execution Workflow</h2>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">KQL - Sample Hunt Workflow</span>
                    <button class="code-copy">ğŸ“‹ Copy</button>
                </div>
                <div class="code-content">
<pre><code><span class="comment">// HUNT: Suspicious PowerShell Activity</span>
<span class="comment">// Hypothesis: Attackers may be using encoded PowerShell</span>

<span class="comment">// STEP 1: Broad search for encoded commands</span>
<span class="variable">DeviceProcessEvents</span>
<span class="operator">|</span> <span class="keyword">where</span> Timestamp <span class="operator">></span> <span class="function">ago</span>(<span class="number">7</span>d)
<span class="operator">|</span> <span class="keyword">where</span> FileName <span class="operator">=~</span> <span class="string">"powershell.exe"</span>
<span class="operator">|</span> <span class="keyword">where</span> ProcessCommandLine <span class="function">has_any</span> (
    <span class="string">"-enc"</span>, <span class="string">"-encodedcommand"</span>, <span class="string">"-e "</span>
)
<span class="operator">|</span> <span class="keyword">summarize</span> Count = <span class="function">count</span>() <span class="keyword">by</span> DeviceName, AccountName
<span class="operator">|</span> <span class="keyword">order by</span> Count <span class="keyword">desc</span>

<span class="comment">// STEP 2: Examine specific devices with high counts</span>
<span class="variable">DeviceProcessEvents</span>
<span class="operator">|</span> <span class="keyword">where</span> Timestamp <span class="operator">></span> <span class="function">ago</span>(<span class="number">7</span>d)
<span class="operator">|</span> <span class="keyword">where</span> DeviceName <span class="operator">==</span> <span class="string">"SUSPICIOUS-DEVICE"</span>
<span class="operator">|</span> <span class="keyword">where</span> FileName <span class="operator">=~</span> <span class="string">"powershell.exe"</span>
<span class="operator">|</span> <span class="keyword">project</span> Timestamp, ProcessCommandLine, AccountName,
         InitiatingProcessFileName

<span class="comment">// STEP 3: Check parent processes for anomalies</span>
<span class="variable">DeviceProcessEvents</span>
<span class="operator">|</span> <span class="keyword">where</span> Timestamp <span class="operator">></span> <span class="function">ago</span>(<span class="number">7</span>d)
<span class="operator">|</span> <span class="keyword">where</span> FileName <span class="operator">=~</span> <span class="string">"powershell.exe"</span>
<span class="operator">|</span> <span class="keyword">where</span> InitiatingProcessFileName <span class="function">!in~</span> (
    <span class="string">"explorer.exe"</span>, <span class="string">"cmd.exe"</span>, <span class="string">"powershell.exe"</span>,
    <span class="string">"svchost.exe"</span>, <span class="string">"services.exe"</span>
)
<span class="operator">|</span> <span class="keyword">summarize</span> Count = <span class="function">count</span>() <span class="keyword">by</span> InitiatingProcessFileName
<span class="operator">|</span> <span class="keyword">order by</span> Count <span class="keyword">desc</span>

<span class="comment">// STEP 4: Correlate with network activity</span>
<span class="keyword">let</span> SuspiciousDevices = 
    <span class="variable">DeviceProcessEvents</span>
    <span class="operator">|</span> <span class="keyword">where</span> Timestamp <span class="operator">></span> <span class="function">ago</span>(<span class="number">7</span>d)
    <span class="operator">|</span> <span class="keyword">where</span> FileName <span class="operator">=~</span> <span class="string">"powershell.exe"</span>
    <span class="operator">|</span> <span class="keyword">where</span> ProcessCommandLine <span class="function">has</span> <span class="string">"-enc"</span>
    <span class="operator">|</span> <span class="keyword">distinct</span> DeviceId;
<span class="variable">DeviceNetworkEvents</span>
<span class="operator">|</span> <span class="keyword">where</span> Timestamp <span class="operator">></span> <span class="function">ago</span>(<span class="number">7</span>d)
<span class="operator">|</span> <span class="keyword">where</span> DeviceId <span class="function">in</span> (SuspiciousDevices)
<span class="operator">|</span> <span class="keyword">where</span> InitiatingProcessFileName <span class="operator">=~</span> <span class="string">"powershell.exe"</span>
<span class="operator">|</span> <span class="keyword">summarize</span> <span class="function">count</span>() <span class="keyword">by</span> DeviceName, RemoteIP, RemotePort</code></pre>
                </div>
            </div>

            <h2>Hunt Metrics & KPIs</h2>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">Hunting Program Metrics</span>
                    <button class="code-copy">ğŸ“‹ Copy</button>
                </div>
                <div class="code-content">
<pre><code>HUNTING PROGRAM METRICS:

ACTIVITY METRICS:
â”œâ”€â”€ Hunts conducted per month
â”œâ”€â”€ Hours spent hunting
â”œâ”€â”€ Data sources queried
â”œâ”€â”€ MITRE techniques covered
â””â”€â”€ Threat intel items actioned

OUTCOME METRICS:
â”œâ”€â”€ Threats discovered
â”œâ”€â”€ True positive rate
â”œâ”€â”€ Time to discovery (vs automated)
â”œâ”€â”€ New detections created
â”œâ”€â”€ Detections improved
â””â”€â”€ Incidents prevented/contained early

COVERAGE METRICS:
â”œâ”€â”€ % of MITRE ATT&CK techniques hunted
â”œâ”€â”€ % of devices covered
â”œâ”€â”€ % of data sources utilized
â”œâ”€â”€ Time since last hunt per technique
â””â”€â”€ Gap analysis score

EFFICIENCY METRICS:
â”œâ”€â”€ Hours per threat discovered
â”œâ”€â”€ Query reuse rate
â”œâ”€â”€ False positive rate in hunts
â”œâ”€â”€ Automation opportunities identified
â””â”€â”€ Detection rule conversion rate

SAMPLE DASHBOARD:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Hunting Dashboard - Q4 2024               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Hunts Completed:        24                â”‚
â”‚ Threats Discovered:      3                â”‚
â”‚ New Detections Created:  8                â”‚
â”‚ MITRE Coverage:         67%               â”‚
â”‚ Hours Invested:        120                â”‚
â”‚ ROI (threats/hour):    0.025              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre>
                </div>
            </div>

            <div class="callout tip">
                <div class="callout-icon">ğŸ’¡</div>
                <div class="callout-content">
                    <h5>Hunting Best Practices</h5>
                    <ul>
                        <li><strong>Start with hypothesis</strong>: Don't just run random queries</li>
                        <li><strong>Know your baseline</strong>: Understand normal before finding abnormal</li>
                        <li><strong>Document everything</strong>: Queries, findings, and outcomes</li>
                        <li><strong>Convert to detections</strong>: Successful hunts should become automated rules</li>
                        <li><strong>Iterate and improve</strong>: Refine techniques based on results</li>
                    </ul>
                </div>
            </div>

            <!-- Interview Tips -->
            <div class="interview-tips">
                <h3>ğŸ’¡ Key Interview Points</h3>
                <ul>
                    <li><strong>Hypothesis-driven</strong>: Start with a theory, then validate with data</li>
                    <li><strong>Three approaches</strong>: TI-driven, MITRE-driven, anomaly-based</li>
                    <li><strong>Outcome types</strong>: Threat found â†’ IR, or no threat â†’ improve detection</li>
                    <li><strong>Documentation</strong>: Essential for repeatability and knowledge sharing</li>
                    <li><strong>Success metric</strong>: Not just threats found, but detection improvements made</li>
                </ul>
            </div>

            <nav class="page-nav">
                <a href="5-9-hunting-queries-malware.html" class="page-nav-link prev">
                    <span class="page-nav-label">â† Previous</span>
                    <span class="page-nav-title">Malware Hunting Queries</span>
                </a>
                <a href="6-1-remediation-actions.html" class="page-nav-link next">
                    <span class="page-nav-label">Next â†’</span>
                    <span class="page-nav-title">Remediation Actions</span>
                </a>
            </nav>
        </div>
    </main>

    <div class="search-modal">
        <div class="search-modal-content">
            <div class="search-modal-input-wrapper">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="11" cy="11" r="8"></circle>
                    <path d="M21 21l-4.35-4.35"></path>
                </svg>
                <input type="text" class="search-modal-input" placeholder="Search pages..." autofocus>
                <button class="search-modal-close">ESC</button>
            </div>
            <div class="search-results"></div>
        </div>
    </div>
    <script src="main.js"></script>
</body>
</html>
