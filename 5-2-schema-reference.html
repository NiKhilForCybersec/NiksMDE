<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Schema Reference | MDE Ultimate Guide</title>
    <link rel="stylesheet" href="main.css">
</head>
<body>
    <header class="header">
        <div class="header-left">
            <button class="mobile-menu-btn" aria-label="Toggle menu">â˜°</button>
            <a href="index.html" class="logo">
                <div class="logo-icon">MDE</div>
                <div class="logo-text"><span>MDE</span> Ultimate Guide</div>
            </a>
        </div>
        <div class="search-container">
            <button class="search-btn">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="11" cy="11" r="8"></circle>
                    <path d="M21 21l-4.35-4.35"></path>
                </svg>
                <span>Search documentation...</span>
                <span class="search-shortcut"><kbd>âŒ˜</kbd><kbd>K</kbd></span>
            </button>
        </div>
        <div class="header-right">
            <a href="12-2-interview-questions.html" class="header-link">Interview Prep</a>
            <a href="5-3-kql-fundamentals.html" class="header-link">KQL Guide</a>
        </div>
    </header>

    <div class="sidebar-overlay"></div>
    <aside class="sidebar"></aside>

    <main class="main-content">
        <div class="content-wrapper">
            <div class="overview-box">
                <h4>ğŸ¯ What This Page Covers</h4>
                <p>Complete reference for Advanced Hunting schema tables in Microsoft 365 Defender. Learn all available tables, their key columns, what data they contain, and when to use each table for threat hunting.</p>
            </div>

            <h1>Advanced Hunting Schema Reference</h1>

            <p>The Advanced Hunting schema contains tables with endpoint, identity, email, and cloud app data. Understanding the schema is essential for effective threat hunting.</p>

            <h2>Schema Overview</h2>

            <div class="flow-diagram">
                <div class="diagram-title">Schema Categories</div>
<pre>
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ADVANCED HUNTING SCHEMA                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  ENDPOINT TABLES (MDE)           â”‚  IDENTITY TABLES (MDI)              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ DeviceProcessEvents         â”‚ â”‚  â”‚ IdentityLogonEvents         â”‚    â”‚
â”‚  â”‚ DeviceNetworkEvents         â”‚ â”‚  â”‚ IdentityQueryEvents         â”‚    â”‚
â”‚  â”‚ DeviceFileEvents            â”‚ â”‚  â”‚ IdentityDirectoryEvents     â”‚    â”‚
â”‚  â”‚ DeviceRegistryEvents        â”‚ â”‚  â”‚ AADSignInEventsBeta         â”‚    â”‚
â”‚  â”‚ DeviceLogonEvents           â”‚ â”‚  â”‚ AADSpnSignInEventsBeta      â”‚    â”‚
â”‚  â”‚ DeviceImageLoadEvents       â”‚ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚  â”‚ DeviceEvents                â”‚ â”‚                                      â”‚
â”‚  â”‚ DeviceInfo                  â”‚ â”‚  EMAIL TABLES (MDO)                 â”‚
â”‚  â”‚ DeviceFileCertificateInfo   â”‚ â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚ EmailEvents                 â”‚    â”‚
â”‚                                   â”‚  â”‚ EmailAttachmentInfo         â”‚    â”‚
â”‚  ALERT/INCIDENT TABLES           â”‚  â”‚ EmailUrlInfo                â”‚    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚ EmailPostDeliveryEvents     â”‚    â”‚
â”‚  â”‚ AlertInfo                   â”‚ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚  â”‚ AlertEvidence               â”‚ â”‚                                      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  CLOUD APPS (MDCA)                  â”‚
â”‚                                   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  VULNERABILITY TABLES            â”‚  â”‚ CloudAppEvents              â”‚    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚  â”‚ DeviceTvmSoftwareInventory  â”‚ â”‚                                      â”‚
â”‚  â”‚ DeviceTvmSoftwareVulner...  â”‚ â”‚                                      â”‚
â”‚  â”‚ DeviceTvmSecureConfig...    â”‚ â”‚                                      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚                                      â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</pre>
            </div>

            <h2>Core Endpoint Tables</h2>

            <h3>DeviceProcessEvents</h3>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">DeviceProcessEvents - Process Creation</span>
                    <button class="code-copy">ğŸ“‹ Copy</button>
                </div>
                <div class="code-content">
<pre><code>PURPOSE: Process creation and termination events
USE FOR: Execution analysis, process trees, command line hunting

KEY COLUMNS:
â”œâ”€â”€ Timestamp              - When event occurred
â”œâ”€â”€ DeviceId              - Unique device identifier
â”œâ”€â”€ DeviceName            - Computer name
â”œâ”€â”€ ActionType            - ProcessCreated, ProcessTerminated
â”œâ”€â”€ FileName              - Process file name (e.g., cmd.exe)
â”œâ”€â”€ FolderPath            - Full path to executable
â”œâ”€â”€ SHA256                - File hash
â”œâ”€â”€ ProcessId             - Process ID
â”œâ”€â”€ ProcessCommandLine    - Full command line (CRITICAL)
â”œâ”€â”€ InitiatingProcessFileName    - Parent process name
â”œâ”€â”€ InitiatingProcessCommandLine - Parent command line
â”œâ”€â”€ InitiatingProcessId   - Parent PID
â”œâ”€â”€ AccountDomain         - User domain
â”œâ”€â”€ AccountName           - Username
â”œâ”€â”€ AccountSid            - User SID
â”œâ”€â”€ LogonId               - Logon session ID
â””â”€â”€ ProcessTokenElevation - Token elevation type

EXAMPLE QUERY:
<span class="variable">DeviceProcessEvents</span>
<span class="operator">|</span> <span class="keyword">where</span> Timestamp <span class="operator">></span> <span class="function">ago</span>(<span class="number">1</span>d)
<span class="operator">|</span> <span class="keyword">where</span> FileName <span class="operator">=~</span> <span class="string">"powershell.exe"</span>
<span class="operator">|</span> <span class="keyword">project</span> Timestamp, DeviceName, ProcessCommandLine, AccountName</code></pre>
                </div>
            </div>

            <h3>DeviceNetworkEvents</h3>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">DeviceNetworkEvents - Network Connections</span>
                    <button class="code-copy">ğŸ“‹ Copy</button>
                </div>
                <div class="code-content">
<pre><code>PURPOSE: Network connection events
USE FOR: C2 detection, data exfiltration, lateral movement

KEY COLUMNS:
â”œâ”€â”€ Timestamp              - When connection occurred
â”œâ”€â”€ DeviceId              - Device identifier
â”œâ”€â”€ DeviceName            - Computer name
â”œâ”€â”€ ActionType            - ConnectionSuccess, ConnectionFailed, etc.
â”œâ”€â”€ RemoteIP              - Destination IP address
â”œâ”€â”€ RemotePort            - Destination port
â”œâ”€â”€ RemoteUrl             - Full URL if available
â”œâ”€â”€ LocalIP               - Source IP
â”œâ”€â”€ LocalPort             - Source port
â”œâ”€â”€ Protocol              - TCP, UDP
â”œâ”€â”€ InitiatingProcessFileName    - Process making connection
â”œâ”€â”€ InitiatingProcessCommandLine - Process command line
â”œâ”€â”€ InitiatingProcessId   - Process ID
â”œâ”€â”€ RemoteIPType          - Public, Private, Reserved
â””â”€â”€ AdditionalFields      - Extra metadata (JSON)

EXAMPLE QUERY:
<span class="variable">DeviceNetworkEvents</span>
<span class="operator">|</span> <span class="keyword">where</span> Timestamp <span class="operator">></span> <span class="function">ago</span>(<span class="number">1</span>d)
<span class="operator">|</span> <span class="keyword">where</span> RemotePort <span class="function">in</span> (<span class="number">4444</span>, <span class="number">5555</span>, <span class="number">6666</span>)  <span class="comment">// Common C2 ports</span>
<span class="operator">|</span> <span class="keyword">project</span> Timestamp, DeviceName, RemoteIP, RemotePort, InitiatingProcessFileName</code></pre>
                </div>
            </div>

            <h3>DeviceFileEvents</h3>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">DeviceFileEvents - File Operations</span>
                    <button class="code-copy">ğŸ“‹ Copy</button>
                </div>
                <div class="code-content">
<pre><code>PURPOSE: File system operations
USE FOR: Malware drops, data staging, ransomware detection

KEY COLUMNS:
â”œâ”€â”€ Timestamp              - When file operation occurred
â”œâ”€â”€ DeviceId              - Device identifier
â”œâ”€â”€ DeviceName            - Computer name
â”œâ”€â”€ ActionType            - FileCreated, FileModified, FileDeleted, FileRenamed
â”œâ”€â”€ FileName              - File name
â”œâ”€â”€ FolderPath            - Full path
â”œâ”€â”€ SHA256                - File hash (when available)
â”œâ”€â”€ SHA1                  - SHA1 hash
â”œâ”€â”€ MD5                   - MD5 hash
â”œâ”€â”€ FileSize              - Size in bytes
â”œâ”€â”€ FileOriginUrl         - Download source URL
â”œâ”€â”€ FileOriginReferrerUrl - Referrer URL
â”œâ”€â”€ InitiatingProcessFileName    - Process that created/modified
â”œâ”€â”€ InitiatingProcessCommandLine - Process command line
â”œâ”€â”€ InitiatingProcessId   - Process ID
â”œâ”€â”€ SensitivityLabel      - Data classification label
â””â”€â”€ IsAzureInfoProtectionApplied - AIP protected

EXAMPLE QUERY:
<span class="variable">DeviceFileEvents</span>
<span class="operator">|</span> <span class="keyword">where</span> Timestamp <span class="operator">></span> <span class="function">ago</span>(<span class="number">1</span>d)
<span class="operator">|</span> <span class="keyword">where</span> ActionType <span class="operator">==</span> <span class="string">"FileCreated"</span>
<span class="operator">|</span> <span class="keyword">where</span> FolderPath <span class="function">has</span> <span class="string">"Downloads"</span>
<span class="operator">|</span> <span class="keyword">where</span> FileName <span class="function">endswith</span> <span class="string">".exe"</span>
<span class="operator">|</span> <span class="keyword">project</span> Timestamp, DeviceName, FileName, FolderPath, SHA256</code></pre>
                </div>
            </div>

            <h3>DeviceRegistryEvents</h3>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">DeviceRegistryEvents - Registry Changes</span>
                    <button class="code-copy">ğŸ“‹ Copy</button>
                </div>
                <div class="code-content">
<pre><code>PURPOSE: Registry key and value modifications
USE FOR: Persistence detection, configuration changes

KEY COLUMNS:
â”œâ”€â”€ Timestamp              - When registry change occurred
â”œâ”€â”€ DeviceId              - Device identifier
â”œâ”€â”€ DeviceName            - Computer name
â”œâ”€â”€ ActionType            - RegistryKeyCreated, RegistryValueSet, RegistryKeyDeleted
â”œâ”€â”€ RegistryKey           - Full registry path
â”œâ”€â”€ RegistryValueName     - Value name
â”œâ”€â”€ RegistryValueType     - REG_SZ, REG_DWORD, etc.
â”œâ”€â”€ RegistryValueData     - Value data
â”œâ”€â”€ PreviousRegistryKey   - Previous key (for renames)
â”œâ”€â”€ PreviousRegistryValueData - Previous value
â”œâ”€â”€ InitiatingProcessFileName    - Process making change
â”œâ”€â”€ InitiatingProcessCommandLine - Process command line
â””â”€â”€ InitiatingProcessId   - Process ID

PERSISTENCE LOCATIONS TO MONITOR:
â”œâ”€â”€ HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run
â”œâ”€â”€ HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run
â”œâ”€â”€ HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnce
â”œâ”€â”€ HKLM\SYSTEM\CurrentControlSet\Services
â””â”€â”€ HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon

EXAMPLE QUERY:
<span class="variable">DeviceRegistryEvents</span>
<span class="operator">|</span> <span class="keyword">where</span> Timestamp <span class="operator">></span> <span class="function">ago</span>(<span class="number">1</span>d)
<span class="operator">|</span> <span class="keyword">where</span> RegistryKey <span class="function">has</span> <span class="string">"CurrentVersion\\Run"</span>
<span class="operator">|</span> <span class="keyword">project</span> Timestamp, DeviceName, ActionType, RegistryKey, RegistryValueName, RegistryValueData</code></pre>
                </div>
            </div>

            <h3>DeviceLogonEvents</h3>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">DeviceLogonEvents - Authentication</span>
                    <button class="code-copy">ğŸ“‹ Copy</button>
                </div>
                <div class="code-content">
<pre><code>PURPOSE: User logon events on endpoints
USE FOR: Lateral movement, credential use, access patterns

KEY COLUMNS:
â”œâ”€â”€ Timestamp              - When logon occurred
â”œâ”€â”€ DeviceId              - Device identifier
â”œâ”€â”€ DeviceName            - Computer name
â”œâ”€â”€ ActionType            - LogonSuccess, LogonFailed
â”œâ”€â”€ LogonType             - Interactive, Network, RemoteInteractive, etc.
â”œâ”€â”€ AccountDomain         - Domain
â”œâ”€â”€ AccountName           - Username
â”œâ”€â”€ AccountSid            - User SID
â”œâ”€â”€ RemoteIP              - Source IP (for network logons)
â”œâ”€â”€ RemoteDeviceName      - Source computer name
â”œâ”€â”€ IsLocalAdmin          - Is user local admin
â”œâ”€â”€ FailureReason         - Reason for failed logon
â””â”€â”€ Protocol              - Kerberos, NTLM, etc.

LOGON TYPES:
â”œâ”€â”€ 2  - Interactive (local keyboard)
â”œâ”€â”€ 3  - Network (file share, etc.)
â”œâ”€â”€ 4  - Batch (scheduled task)
â”œâ”€â”€ 5  - Service
â”œâ”€â”€ 7  - Unlock
â”œâ”€â”€ 8  - NetworkCleartext
â”œâ”€â”€ 9  - NewCredentials (runas /netonly)
â”œâ”€â”€ 10 - RemoteInteractive (RDP)
â”œâ”€â”€ 11 - CachedInteractive
â””â”€â”€ 12 - CachedRemoteInteractive

EXAMPLE QUERY:
<span class="variable">DeviceLogonEvents</span>
<span class="operator">|</span> <span class="keyword">where</span> Timestamp <span class="operator">></span> <span class="function">ago</span>(<span class="number">1</span>d)
<span class="operator">|</span> <span class="keyword">where</span> LogonType <span class="operator">==</span> <span class="string">"RemoteInteractive"</span>  <span class="comment">// RDP</span>
<span class="operator">|</span> <span class="keyword">where</span> ActionType <span class="operator">==</span> <span class="string">"LogonSuccess"</span>
<span class="operator">|</span> <span class="keyword">project</span> Timestamp, DeviceName, AccountName, RemoteIP</code></pre>
                </div>
            </div>

            <h3>DeviceEvents</h3>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">DeviceEvents - Miscellaneous Events</span>
                    <button class="code-copy">ğŸ“‹ Copy</button>
                </div>
                <div class="code-content">
<pre><code>PURPOSE: Catch-all for various security events
USE FOR: ASR, exploit guard, AMSI, tamper protection, etc.

COMMON ACTION TYPES:
â”œâ”€â”€ AntivirusDetection              - AV detection
â”œâ”€â”€ AntivirusScanCompleted          - Scan completed
â”œâ”€â”€ AsrLsassCredentialTheftBlocked  - LSASS protection
â”œâ”€â”€ AsrOfficeChildProcessBlocked    - Office rule
â”œâ”€â”€ AsrExecutableEmailContentBlocked - Email executable
â”œâ”€â”€ ControlledFolderAccessViolationBlocked - CFA block
â”œâ”€â”€ ExploitGuardNetworkProtectionBlocked   - NP block
â”œâ”€â”€ TamperProtection                 - Tamper attempt
â”œâ”€â”€ AmsiScriptContent               - AMSI script scan
â”œâ”€â”€ SmartScreenUrlWarning           - SmartScreen
â”œâ”€â”€ UsbDriveMounted                 - USB connected
â”œâ”€â”€ UsbDriveUnmounted               - USB removed
â”œâ”€â”€ PowerShellCommand               - PS command logged
â””â”€â”€ ServiceInstalled                - Service created

EXAMPLE QUERY - ASR Blocks:
<span class="variable">DeviceEvents</span>
<span class="operator">|</span> <span class="keyword">where</span> Timestamp <span class="operator">></span> <span class="function">ago</span>(<span class="number">7</span>d)
<span class="operator">|</span> <span class="keyword">where</span> ActionType <span class="function">startswith</span> <span class="string">"Asr"</span>
<span class="operator">|</span> <span class="keyword">summarize</span> Count = <span class="function">count</span>() <span class="keyword">by</span> ActionType
<span class="operator">|</span> <span class="keyword">order by</span> Count <span class="keyword">desc</span></code></pre>
                </div>
            </div>

            <h3>DeviceImageLoadEvents</h3>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">DeviceImageLoadEvents - DLL Loads</span>
                    <button class="code-copy">ğŸ“‹ Copy</button>
                </div>
                <div class="code-content">
<pre><code>PURPOSE: DLL and driver loads
USE FOR: DLL injection, sideloading, driver attacks

KEY COLUMNS:
â”œâ”€â”€ Timestamp              - When DLL loaded
â”œâ”€â”€ DeviceId              - Device identifier
â”œâ”€â”€ DeviceName            - Computer name
â”œâ”€â”€ ActionType            - ImageLoaded
â”œâ”€â”€ FileName              - DLL name
â”œâ”€â”€ FolderPath            - Full path
â”œâ”€â”€ SHA256                - DLL hash
â”œâ”€â”€ InitiatingProcessFileName    - Process loading DLL
â”œâ”€â”€ InitiatingProcessCommandLine - Process command line
â”œâ”€â”€ InitiatingProcessId   - Process ID
â””â”€â”€ SignatureStatus       - Valid, Invalid, Unsigned

EXAMPLE QUERY - Unsigned DLLs loaded by Office:
<span class="variable">DeviceImageLoadEvents</span>
<span class="operator">|</span> <span class="keyword">where</span> Timestamp <span class="operator">></span> <span class="function">ago</span>(<span class="number">1</span>d)
<span class="operator">|</span> <span class="keyword">where</span> InitiatingProcessFileName <span class="function">in~</span> (<span class="string">"winword.exe"</span>, <span class="string">"excel.exe"</span>, <span class="string">"powerpnt.exe"</span>)
<span class="operator">|</span> <span class="keyword">where</span> SignatureStatus <span class="operator">!=</span> <span class="string">"Valid"</span>
<span class="operator">|</span> <span class="keyword">project</span> Timestamp, DeviceName, FileName, FolderPath, InitiatingProcessFileName</code></pre>
                </div>
            </div>

            <h2>Alert Tables</h2>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">AlertInfo and AlertEvidence</span>
                    <button class="code-copy">ğŸ“‹ Copy</button>
                </div>
                <div class="code-content">
<pre><code>AlertInfo - ALERT METADATA:
â”œâ”€â”€ Timestamp              - Alert time
â”œâ”€â”€ AlertId               - Unique alert ID
â”œâ”€â”€ Title                 - Alert name
â”œâ”€â”€ Severity              - High, Medium, Low, Informational
â”œâ”€â”€ Category              - MITRE category
â”œâ”€â”€ AttackTechniques      - MITRE techniques
â”œâ”€â”€ ServiceSource         - Detection source
â”œâ”€â”€ DetectionSource       - AV, EDR, etc.
â”œâ”€â”€ IncidentId            - Linked incident
â””â”€â”€ InvestigationId       - Investigation ID

AlertEvidence - ALERT EVIDENCE:
â”œâ”€â”€ AlertId               - Links to AlertInfo
â”œâ”€â”€ EntityType            - Process, File, IP, URL, etc.
â”œâ”€â”€ EvidenceRole          - Impacted, Related, etc.
â”œâ”€â”€ FileName              - File name
â”œâ”€â”€ SHA256                - Hash
â”œâ”€â”€ RemoteIP              - IP address
â”œâ”€â”€ RemoteUrl             - URL
â”œâ”€â”€ ProcessCommandLine    - Command line
â””â”€â”€ DeviceId              - Device

EXAMPLE - Join alerts with evidence:
<span class="variable">AlertInfo</span>
<span class="operator">|</span> <span class="keyword">where</span> Timestamp <span class="operator">></span> <span class="function">ago</span>(<span class="number">7</span>d)
<span class="operator">|</span> <span class="keyword">where</span> Severity <span class="operator">==</span> <span class="string">"High"</span>
<span class="operator">|</span> <span class="keyword">join</span> <span class="keyword">kind=inner</span> <span class="variable">AlertEvidence</span> <span class="keyword">on</span> AlertId
<span class="operator">|</span> <span class="keyword">where</span> EntityType <span class="operator">==</span> <span class="string">"File"</span>
<span class="operator">|</span> <span class="keyword">project</span> Timestamp, Title, FileName, SHA256</code></pre>
                </div>
            </div>

            <h2>Vulnerability Tables</h2>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">TVM Tables</span>
                    <button class="code-copy">ğŸ“‹ Copy</button>
                </div>
                <div class="code-content">
<pre><code>DeviceTvmSoftwareInventory:
â”œâ”€â”€ DeviceId              - Device
â”œâ”€â”€ SoftwareName          - Software name
â”œâ”€â”€ SoftwareVendor        - Vendor
â”œâ”€â”€ SoftwareVersion       - Version
â”œâ”€â”€ EndOfSupportStatus    - EOS status
â””â”€â”€ NumberOfWeaknesses    - Vulnerability count

DeviceTvmSoftwareVulnerabilities:
â”œâ”€â”€ DeviceId              - Device
â”œâ”€â”€ CveId                 - CVE identifier
â”œâ”€â”€ VulnerabilitySeverityLevel - Critical, High, etc.
â”œâ”€â”€ SoftwareName          - Affected software
â”œâ”€â”€ SoftwareVersion       - Version
â””â”€â”€ RecommendedSecurityUpdate - Patch KB

DeviceTvmSecureConfigurationAssessment:
â”œâ”€â”€ DeviceId              - Device
â”œâ”€â”€ ConfigurationId       - Config ID
â”œâ”€â”€ ConfigurationCategory - Category
â”œâ”€â”€ ConfigurationSubcategory - Subcategory
â”œâ”€â”€ IsCompliant           - True/False
â””â”€â”€ IsApplicable          - True/False

EXAMPLE - Find devices with critical CVEs:
<span class="variable">DeviceTvmSoftwareVulnerabilities</span>
<span class="operator">|</span> <span class="keyword">where</span> VulnerabilitySeverityLevel <span class="operator">==</span> <span class="string">"Critical"</span>
<span class="operator">|</span> <span class="keyword">summarize</span> CriticalVulns = <span class="function">dcount</span>(CveId) <span class="keyword">by</span> DeviceId
<span class="operator">|</span> <span class="keyword">order by</span> CriticalVulns <span class="keyword">desc</span></code></pre>
                </div>
            </div>

            <h2>Common Column Reference</h2>

            <div class="table-wrapper">
                <table>
                    <thead>
                        <tr>
                            <th>Column</th>
                            <th>Description</th>
                            <th>Found In</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>Timestamp</code></td>
                            <td>Event time (UTC)</td>
                            <td>All tables</td>
                        </tr>
                        <tr>
                            <td><code>DeviceId</code></td>
                            <td>Unique device GUID</td>
                            <td>All device tables</td>
                        </tr>
                        <tr>
                            <td><code>DeviceName</code></td>
                            <td>Computer name</td>
                            <td>All device tables</td>
                        </tr>
                        <tr>
                            <td><code>SHA256</code></td>
                            <td>File hash</td>
                            <td>Process, File, Image</td>
                        </tr>
                        <tr>
                            <td><code>ProcessCommandLine</code></td>
                            <td>Full command line</td>
                            <td>Process, most events</td>
                        </tr>
                        <tr>
                            <td><code>InitiatingProcess*</code></td>
                            <td>Parent process info</td>
                            <td>All action tables</td>
                        </tr>
                        <tr>
                            <td><code>AccountName</code></td>
                            <td>Username</td>
                            <td>Process, Logon</td>
                        </tr>
                        <tr>
                            <td><code>RemoteIP</code></td>
                            <td>Destination IP</td>
                            <td>Network, Logon</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- Day-to-Day Section -->
            <div class="day-to-day">
                <h3>ğŸ”§ Day-to-Day Usage</h3>
                <ul>
                    <li>Use DeviceProcessEvents for execution hunting</li>
                    <li>Use DeviceNetworkEvents for C2 detection</li>
                    <li>Use DeviceFileEvents for malware drops</li>
                    <li>Use DeviceRegistryEvents for persistence</li>
                    <li>Join tables for complete attack picture</li>
                </ul>
            </div>

            <!-- Interview Tips -->
            <div class="interview-tips">
                <h3>ğŸ’¡ Key Interview Points</h3>
                <ul>
                    <li><strong>Core tables</strong>: Process, Network, File, Registry, Logon, Events</li>
                    <li><strong>DeviceEvents</strong>: Catch-all for ASR, AMSI, CFA, etc.</li>
                    <li><strong>InitiatingProcess*</strong>: Parent process columns for tree building</li>
                    <li><strong>Retention</strong>: 30 days default, extendable to 180 days</li>
                    <li><strong>Common joins</strong>: AlertInfo + AlertEvidence, Process + Network</li>
                </ul>
            </div>

            <nav class="page-nav">
                <a href="5-1-advanced-hunting-overview.html" class="page-nav-link prev">
                    <span class="page-nav-label">â† Previous</span>
                    <span class="page-nav-title">Advanced Hunting Overview</span>
                </a>
                <a href="5-3-kql-fundamentals.html" class="page-nav-link next">
                    <span class="page-nav-label">Next â†’</span>
                    <span class="page-nav-title">KQL Fundamentals</span>
                </a>
            </nav>
        </div>
    </main>

    <div class="search-modal">
        <div class="search-modal-content">
            <div class="search-modal-input-wrapper">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="11" cy="11" r="8"></circle>
                    <path d="M21 21l-4.35-4.35"></path>
                </svg>
                <input type="text" class="search-modal-input" placeholder="Search pages..." autofocus>
                <button class="search-modal-close">ESC</button>
            </div>
            <div class="search-results"></div>
        </div>
    </div>
    <script src="main.js"></script>
</body>
</html>
