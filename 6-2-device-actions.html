<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Device Actions | MDE Ultimate Guide</title>
    <link rel="stylesheet" href="main.css">
</head>
<body>
    <header class="header">
        <div class="header-left">
            <button class="mobile-menu-btn" aria-label="Toggle menu">â˜°</button>
            <a href="index.html" class="logo">
                <div class="logo-icon">MDE</div>
                <div class="logo-text"><span>MDE</span> Ultimate Guide</div>
            </a>
        </div>
        <div class="search-container">
            <button class="search-btn">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="11" cy="11" r="8"></circle>
                    <path d="M21 21l-4.35-4.35"></path>
                </svg>
                <span>Search documentation...</span>
                <span class="search-shortcut"><kbd>âŒ˜</kbd><kbd>K</kbd></span>
            </button>
        </div>
        <div class="header-right">
            <a href="12-2-interview-questions.html" class="header-link">Interview Prep</a>
            <a href="5-3-kql-fundamentals.html" class="header-link">KQL Guide</a>
        </div>
    </header>

    <div class="sidebar-overlay"></div>
    <aside class="sidebar"></aside>

    <main class="main-content">
        <div class="content-wrapper">
            <div class="overview-box">
                <h4>ğŸ¯ What This Page Covers</h4>
                <p>Complete guide to MDE device response actions. Learn how to isolate devices, run scans, collect evidence, and manage device restrictions during incident response.</p>
            </div>

            <h1>Device Response Actions</h1>

            <p>Device actions allow security teams to remotely contain threats and collect evidence from compromised endpoints. These actions are critical for effective incident response.</p>

            <h2>Available Device Actions</h2>

            <div class="flow-diagram">
                <div class="diagram-title">Device Response Actions</div>
<pre>
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    DEVICE RESPONSE ACTIONS                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  CONTAINMENT                      INVESTIGATION                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ â€¢ Isolate device           â”‚ â”‚ â€¢ Collect investigation     â”‚       â”‚
â”‚  â”‚   â””â”€â”€ Full isolation       â”‚ â”‚   package                   â”‚       â”‚
â”‚  â”‚   â””â”€â”€ Selective isolation  â”‚ â”‚ â€¢ Initiate automated       â”‚       â”‚
â”‚  â”‚ â€¢ Restrict app execution   â”‚ â”‚   investigation            â”‚       â”‚
â”‚  â”‚ â€¢ Contain device (Preview) â”‚ â”‚ â€¢ Run antivirus scan       â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â””â”€â”€ Quick scan           â”‚       â”‚
â”‚                                   â”‚   â””â”€â”€ Full scan            â”‚       â”‚
â”‚  REMEDIATION                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                        â”‚
â”‚  â”‚ â€¢ Run antivirus scan       â”‚ MANAGEMENT                             â”‚
â”‚  â”‚ â€¢ Stop and quarantine file â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ â€¢ Request sample           â”‚ â”‚ â€¢ Manage tags              â”‚       â”‚
â”‚  â”‚ â€¢ Block file org-wide      â”‚ â”‚ â€¢ Consult threat expert    â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â€¢ Offboard device          â”‚       â”‚
â”‚                                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                                                                          â”‚
â”‚  LIVE RESPONSE (Advanced)                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚ â€¢ Interactive shell session                                   â”‚      â”‚
â”‚  â”‚ â€¢ Run commands, scripts, collect files                        â”‚      â”‚
â”‚  â”‚ â€¢ Requires elevated permissions                               â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</pre>
            </div>

            <h2>Device Isolation</h2>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">Device Isolation</span>
                    <button class="code-copy">ğŸ“‹ Copy</button>
                </div>
                <div class="code-content">
<pre><code>DEVICE ISOLATION:
Purpose: Prevent lateral movement and C2 communication

ISOLATION TYPES:

FULL ISOLATION:
â”œâ”€â”€ Blocks ALL network connections
â”œâ”€â”€ Except: MDE cloud service communication
â”œâ”€â”€ User cannot access any network resources
â”œâ”€â”€ Use for: Confirmed compromise, active threat
â””â”€â”€ Impact: High - user cannot work

SELECTIVE ISOLATION:
â”œâ”€â”€ Blocks most network connections
â”œâ”€â”€ Allows: Outlook, Teams, OneDrive
â”œâ”€â”€ User can continue limited work
â”œâ”€â”€ Use for: Suspected compromise, investigation needed
â””â”€â”€ Impact: Medium - limited functionality

HOW TO ISOLATE:

PORTAL METHOD:
1. Device inventory â†’ Select device
2. Click "..." (More actions)
3. Select "Isolate device"
4. Choose: Full or Selective
5. Enter reason/comment (required)
6. Confirm action

API METHOD:
POST /api/machines/{id}/isolate
{
  "Comment": "Isolated due to ransomware alert",
  "IsolationType": "Full"  // or "Selective"
}

RELEASE FROM ISOLATION:
â”œâ”€â”€ Device page â†’ Release from isolation
â”œâ”€â”€ Or API: POST /api/machines/{id}/unisolate
â”œâ”€â”€ Requires comment
â””â”€â”€ Takes effect within minutes

VERIFICATION:
â”œâ”€â”€ Device status shows "Isolated"
â”œâ”€â”€ Timeline shows isolation action
â”œâ”€â”€ User sees isolation notification
â””â”€â”€ Network connections blocked (except MDE)</code></pre>
                </div>
            </div>

            <h2>Antivirus Scan</h2>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">Run Antivirus Scan</span>
                    <button class="code-copy">ğŸ“‹ Copy</button>
                </div>
                <div class="code-content">
<pre><code>ANTIVIRUS SCAN:
Purpose: Detect and remediate malware on device

SCAN TYPES:

QUICK SCAN:
â”œâ”€â”€ Scans common malware locations
â”œâ”€â”€ Duration: 5-15 minutes
â”œâ”€â”€ Locations: Memory, startup items, registry, common folders
â”œâ”€â”€ Use for: Initial assessment, routine check
â””â”€â”€ Lower impact on device performance

FULL SCAN:
â”œâ”€â”€ Scans entire file system
â”œâ”€â”€ Duration: 1-4+ hours (depends on disk size)
â”œâ”€â”€ Locations: All files, all drives
â”œâ”€â”€ Use for: Deep investigation, post-remediation verification
â””â”€â”€ Higher impact on performance

HOW TO RUN:

PORTAL METHOD:
1. Device page â†’ Response actions
2. Select "Run antivirus scan"
3. Choose: Quick scan or Full scan
4. Enter comment
5. Confirm

API METHOD:
POST /api/machines/{id}/runAntiVirusScan
{
  "Comment": "Scanning after alert investigation",
  "ScanType": "Quick"  // or "Full"
}

MONITORING:
â”œâ”€â”€ Action Center shows scan status
â”œâ”€â”€ Timeline shows when scan started/completed
â”œâ”€â”€ Threats found appear as alerts
â””â”€â”€ Remediation actions logged

BEST PRACTICE:
â”œâ”€â”€ Quick scan first for immediate assessment
â”œâ”€â”€ Full scan after remediation to verify clean
â”œâ”€â”€ Schedule during low-usage hours for full scans
â””â”€â”€ Document findings in investigation notes</code></pre>
                </div>
            </div>

            <h2>App Execution Restriction</h2>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">Restrict App Execution</span>
                    <button class="code-copy">ğŸ“‹ Copy</button>
                </div>
                <div class="code-content">
<pre><code>APP EXECUTION RESTRICTION:
Purpose: Allow only Microsoft-signed executables to run

BEHAVIOR:
â”œâ”€â”€ Blocks all non-Microsoft signed executables
â”œâ”€â”€ Allows Windows and Microsoft applications
â”œâ”€â”€ Prevents unknown malware from executing
â”œâ”€â”€ Very restrictive - may impact user productivity

USE CASES:
â”œâ”€â”€ Active malware infection
â”œâ”€â”€ Ransomware containment
â”œâ”€â”€ Unknown threat investigation
â”œâ”€â”€ High-confidence compromise

HOW TO ENABLE:

PORTAL METHOD:
1. Device page â†’ Response actions
2. Select "Restrict app execution"
3. Enter comment explaining reason
4. Confirm action

API METHOD:
POST /api/machines/{id}/restrictCodeExecution
{
  "Comment": "Restricting due to active malware"
}

REMOVE RESTRICTION:
â”œâ”€â”€ Device page â†’ Remove app restrictions
â”œâ”€â”€ Or API: POST /api/machines/{id}/unrestrictCodeExecution
â””â”€â”€ Takes effect within minutes

USER IMPACT:
â”œâ”€â”€ Cannot run third-party applications
â”œâ”€â”€ Cannot run custom scripts
â”œâ”€â”€ Cannot run unsigned installers
â”œâ”€â”€ May need to coordinate with user

VERIFICATION:
â”œâ”€â”€ Device status shows restriction
â”œâ”€â”€ User attempts to run blocked app â†’ fails
â”œâ”€â”€ Event logged in device timeline
â””â”€â”€ Action logged in Action Center</code></pre>
                </div>
            </div>

            <h2>Investigation Package</h2>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">Collect Investigation Package</span>
                    <button class="code-copy">ğŸ“‹ Copy</button>
                </div>
                <div class="code-content">
<pre><code>INVESTIGATION PACKAGE:
Purpose: Collect forensic evidence from device

PACKAGE CONTENTS:
â”œâ”€â”€ Autoruns (startup items, services)
â”œâ”€â”€ Installed programs
â”œâ”€â”€ Network connections
â”œâ”€â”€ Scheduled tasks
â”œâ”€â”€ Security event logs
â”œâ”€â”€ Services
â”œâ”€â”€ SMB sessions
â”œâ”€â”€ System information
â”œâ”€â”€ Temp directories
â”œâ”€â”€ Users and groups
â”œâ”€â”€ Windows Prefetch
â”œâ”€â”€ WMI subscriptions
â””â”€â”€ More...

HOW TO COLLECT:

PORTAL METHOD:
1. Device page â†’ Response actions
2. Select "Collect investigation package"
3. Enter comment
4. Confirm action
5. Wait for collection (10-30 minutes)
6. Download from Action Center

API METHOD:
POST /api/machines/{id}/collectInvestigationPackage
{
  "Comment": "Collecting for incident INC-2024-001"
}

GET PACKAGE:
GET /api/machineactions/{actionId}/getPackageUri

PACKAGE FORMAT:
â”œâ”€â”€ ZIP file containing collected data
â”œâ”€â”€ CSV files for structured data
â”œâ”€â”€ Text files for logs
â”œâ”€â”€ Binary files (prefetch, registry)
â””â”€â”€ Can be analyzed with forensic tools

ANALYSIS TIPS:
â”œâ”€â”€ Review autoruns for persistence mechanisms
â”œâ”€â”€ Check network connections for C2
â”œâ”€â”€ Examine prefetch for execution evidence
â”œâ”€â”€ Review scheduled tasks for persistence
â””â”€â”€ Correlate with timeline data in MDE</code></pre>
                </div>
            </div>

            <h2>Action Center</h2>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">Action Center Overview</span>
                    <button class="code-copy">ğŸ“‹ Copy</button>
                </div>
                <div class="code-content">
<pre><code>ACTION CENTER:
Location: Defender Portal â†’ Actions & submissions â†’ Action center

PURPOSE:
â”œâ”€â”€ Track all response actions
â”œâ”€â”€ View action status
â”œâ”€â”€ Download collected data
â”œâ”€â”€ Review action history

ACTION STATUSES:
â”œâ”€â”€ Pending: Action queued, waiting for device
â”œâ”€â”€ In progress: Action executing on device
â”œâ”€â”€ Completed: Action finished successfully
â”œâ”€â”€ Failed: Action could not complete
â””â”€â”€ Cancelled: Action was cancelled

TABS:

PENDING ACTIONS:
â”œâ”€â”€ Actions waiting for device to come online
â”œâ”€â”€ Actions in progress
â”œâ”€â”€ Can cancel pending actions
â””â”€â”€ Shows estimated completion time

HISTORY:
â”œâ”€â”€ All completed actions
â”œâ”€â”€ Filter by: Device, action type, date, user
â”œâ”€â”€ Download investigation packages
â”œâ”€â”€ View action details and comments

COMMON ISSUES:

ACTION STUCK PENDING:
â”œâ”€â”€ Device offline
â”œâ”€â”€ Device not communicating with MDE
â”œâ”€â”€ Network issues
â””â”€â”€ Solution: Verify device connectivity

ACTION FAILED:
â”œâ”€â”€ Permission denied
â”œâ”€â”€ Resource unavailable
â”œâ”€â”€ Sensor issues
â””â”€â”€ Solution: Check device health, retry</code></pre>
                </div>
            </div>

            <div class="callout tip">
                <div class="callout-icon">ğŸ’¡</div>
                <div class="callout-content">
                    <h5>Best Practices</h5>
                    <ul>
                        <li><strong>Document everything</strong>: Always add meaningful comments to actions</li>
                        <li><strong>Coordinate with users</strong>: Notify before disruptive actions when possible</li>
                        <li><strong>Collect evidence first</strong>: Get investigation package before remediation</li>
                        <li><strong>Use appropriate isolation</strong>: Selective for investigation, Full for active threats</li>
                        <li><strong>Verify actions complete</strong>: Check Action Center for status</li>
                    </ul>
                </div>
            </div>

            <!-- Day-to-Day Section -->
            <div class="day-to-day">
                <h3>ğŸ”§ Security Engineer Day-to-Day Tasks</h3>
                
                <h4>Common Response Workflows</h4>
                <div class="ticket-item">
                    <span class="ticket-type">"Ransomware detected"</span>
                    <span class="ticket-solution">â†’ Immediately isolate (Full), collect investigation package, run full scan after isolation.</span>
                </div>
                <div class="ticket-item">
                    <span class="ticket-type">"Suspicious activity, needs investigation"</span>
                    <span class="ticket-solution">â†’ Selective isolation, collect package, review timeline, run quick scan.</span>
                </div>
                <div class="ticket-item">
                    <span class="ticket-type">"Malware cleaned, verify remediation"</span>
                    <span class="ticket-solution">â†’ Run full scan, review results, release isolation if clean.</span>
                </div>
            </div>

            <!-- Interview Tips -->
            <div class="interview-tips">
                <h3>ğŸ’¡ Key Interview Points</h3>
                <ul>
                    <li><strong>Isolation types</strong>: Full (all network blocked) vs Selective (allows O365)</li>
                    <li><strong>Scan types</strong>: Quick (5-15 min, common locations) vs Full (1-4+ hrs, everything)</li>
                    <li><strong>App restriction</strong>: Only Microsoft-signed executables can run</li>
                    <li><strong>Investigation package</strong>: Autoruns, network connections, logs, prefetch</li>
                    <li><strong>Action Center</strong>: Track status, download packages, view history</li>
                </ul>
            </div>

            <nav class="page-nav">
                <a href="6-1-remediation-actions.html" class="page-nav-link prev">
                    <span class="page-nav-label">â† Previous</span>
                    <span class="page-nav-title">Remediation Actions</span>
                </a>
                <a href="6-3-investigation-package.html" class="page-nav-link next">
                    <span class="page-nav-label">Next â†’</span>
                    <span class="page-nav-title">Investigation Package</span>
                </a>
            </nav>
        </div>
    </main>

    <div class="search-modal">
        <div class="search-modal-content">
            <div class="search-modal-input-wrapper">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="11" cy="11" r="8"></circle>
                    <path d="M21 21l-4.35-4.35"></path>
                </svg>
                <input type="text" class="search-modal-input" placeholder="Search pages..." autofocus>
                <button class="search-modal-close">ESC</button>
            </div>
            <div class="search-results"></div>
        </div>
    </div>
    <script src="main.js"></script>
</body>
</html>
