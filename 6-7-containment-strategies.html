<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Containment Strategies | MDE Ultimate Guide</title>
    <link rel="stylesheet" href="main.css">
</head>
<body>
    <header class="header">
        <div class="header-left">
            <button class="mobile-menu-btn" aria-label="Toggle menu">â˜°</button>
            <a href="index.html" class="logo">
                <div class="logo-icon">MDE</div>
                <div class="logo-text"><span>MDE</span> Ultimate Guide</div>
            </a>
        </div>
        <div class="search-container">
            <button class="search-btn">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="11" cy="11" r="8"></circle>
                    <path d="M21 21l-4.35-4.35"></path>
                </svg>
                <span>Search documentation...</span>
                <span class="search-shortcut"><kbd>âŒ˜</kbd><kbd>K</kbd></span>
            </button>
        </div>
        <div class="header-right">
            <a href="12-2-interview-questions.html" class="header-link">Interview Prep</a>
            <a href="5-3-kql-fundamentals.html" class="header-link">KQL Guide</a>
        </div>
    </header>

    <div class="sidebar-overlay"></div>
    <aside class="sidebar"></aside>

    <main class="main-content">
        <div class="content-wrapper">
            <div class="overview-box">
                <h4>ğŸ¯ What This Page Covers</h4>
                <p>Complete guide to threat containment strategies with MDE. Learn when and how to isolate devices, block threats, and prevent lateral movement during active incidents.</p>
            </div>

            <h1>Containment Strategies</h1>

            <p>Containment is the critical phase between detection and remediation. The goal is to stop the threat from spreading while preserving evidence and minimizing business impact.</p>

            <h2>Containment Decision Framework</h2>

            <div class="flow-diagram">
                <div class="diagram-title">Containment Decision Tree</div>
<pre>
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    CONTAINMENT DECISION FRAMEWORK                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  THREAT DETECTED                                                        â”‚
â”‚        â”‚                                                                â”‚
â”‚        â–¼                                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ Is the threat actively executing/spreading?                  â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                             â”‚                                           â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”‚
â”‚              â–¼                             â–¼                            â”‚
â”‚         YES: ACTIVE                   NO: BLOCKED/DORMANT              â”‚
â”‚              â”‚                             â”‚                            â”‚
â”‚              â–¼                             â–¼                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚  â”‚ IMMEDIATE ISOLATION â”‚        â”‚ INVESTIGATE FIRST   â”‚                â”‚
â”‚  â”‚ â€¢ Full isolation    â”‚        â”‚ â€¢ Assess scope      â”‚                â”‚
â”‚  â”‚ â€¢ Block org-wide    â”‚        â”‚ â€¢ Collect evidence  â”‚                â”‚
â”‚  â”‚ â€¢ Disable accounts  â”‚        â”‚ â€¢ Selective contain â”‚                â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚                                                                          â”‚
â”‚  SEVERITY-BASED RESPONSE:                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ CRITICAL      â”‚ Immediate full isolation, escalate, all hands  â”‚    â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”‚
â”‚  â”‚ HIGH          â”‚ Rapid containment, investigate in parallel     â”‚    â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”‚
â”‚  â”‚ MEDIUM        â”‚ Investigate, selective containment as needed   â”‚    â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”‚
â”‚  â”‚ LOW           â”‚ Standard investigation, monitor for escalation â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</pre>
            </div>

            <h2>MDE Containment Actions</h2>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">Available Containment Actions</span>
                    <button class="code-copy">ğŸ“‹ Copy</button>
                </div>
                <div class="code-content">
<pre><code>MDE CONTAINMENT ACTIONS:

1. DEVICE ISOLATION
   â”œâ”€â”€ Full Isolation: Blocks ALL network (except MDE)
   â”œâ”€â”€ Selective Isolation: Allows O365 apps
   â”œâ”€â”€ Speed: Takes effect in minutes
   â”œâ”€â”€ Reversible: Yes, release from portal
   â””â”€â”€ Use: Compromised devices, active threats

2. APP EXECUTION RESTRICTION
   â”œâ”€â”€ Effect: Only Microsoft-signed apps can run
   â”œâ”€â”€ Blocks: All third-party executables
   â”œâ”€â”€ Speed: Takes effect in minutes
   â”œâ”€â”€ Reversible: Yes, remove restriction
   â””â”€â”€ Use: Active malware, prevent execution

3. FILE BLOCKING (INDICATORS)
   â”œâ”€â”€ Block by: SHA256, SHA1, MD5 hash
   â”œâ”€â”€ Scope: Organization-wide
   â”œâ”€â”€ Effect: File quarantined if found
   â”œâ”€â”€ Speed: Propagates within ~15 minutes
   â””â”€â”€ Use: Known malware, prevent spread

4. NETWORK BLOCKING (INDICATORS)
   â”œâ”€â”€ Block: IP addresses, URLs, domains
   â”œâ”€â”€ Requires: Network Protection enabled
   â”œâ”€â”€ Effect: Connection blocked + logged
   â”œâ”€â”€ Speed: Propagates within ~15 minutes
   â””â”€â”€ Use: C2 servers, malicious sites

5. ACCOUNT DISABLING (Azure AD)
   â”œâ”€â”€ Location: Azure AD portal
   â”œâ”€â”€ Effect: Prevents all authentication
   â”œâ”€â”€ Related: Revoke active sessions
   â””â”€â”€ Use: Compromised accounts

6. CONDITIONAL ACCESS BLOCK
   â”œâ”€â”€ Block: Risky sign-ins
   â”œâ”€â”€ Block: Specific devices/locations
   â”œâ”€â”€ Effect: Immediate access denial
   â””â”€â”€ Use: Prevent account misuse</code></pre>
                </div>
            </div>

            <h2>Containment Scenarios</h2>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">Scenario-Based Containment</span>
                    <button class="code-copy">ğŸ“‹ Copy</button>
                </div>
                <div class="code-content">
<pre><code>SCENARIO 1: ACTIVE RANSOMWARE
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Indicators:
â”œâ”€â”€ Mass file encryption in progress
â”œâ”€â”€ Shadow copy deletion commands
â”œâ”€â”€ Ransom note creation
â””â”€â”€ Lateral movement attempts

Containment Actions:
1. IMMEDIATE: Full isolate affected device(s)
2. IMMEDIATE: Disable compromised account(s)
3. URGENT: Block ransomware hash org-wide
4. URGENT: Block any identified C2 IPs
5. Consider: Network segmentation at firewall
6. Consider: Disable file shares temporarily

Timeline: Seconds to minutes - every second counts!

SCENARIO 2: CREDENTIAL THEFT DETECTED
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Indicators:
â”œâ”€â”€ LSASS memory access
â”œâ”€â”€ Mimikatz or similar tool
â”œâ”€â”€ Credential dumping activity
â””â”€â”€ Suspicious authentication patterns

Containment Actions:
1. IMMEDIATE: Disable affected privileged accounts
2. IMMEDIATE: Revoke active sessions
3. If DC: Do NOT isolate (breaks AD)
4. Reset KRBTGT (if domain compromise suspected)
5. Block dumping tool hashes org-wide
6. Force password reset for affected accounts

Timeline: Minutes - assume credentials are stolen

SCENARIO 3: MALWARE WITH C2 CONNECTION
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Indicators:
â”œâ”€â”€ Malware detected on endpoint
â”œâ”€â”€ Outbound connection to suspicious IP
â”œâ”€â”€ Beaconing pattern detected
â””â”€â”€ May have data exfiltration

Containment Actions:
1. Full isolate the device
2. Block C2 IP/domain org-wide
3. Block malware hash org-wide
4. Search for C2 connections from other devices
5. Check for lateral movement

Timeline: Minutes - prevent command execution

SCENARIO 4: PHISHING - FILE EXECUTED
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Indicators:
â”œâ”€â”€ User opened malicious attachment
â”œâ”€â”€ Macro executed PowerShell
â”œâ”€â”€ Suspicious child processes
â””â”€â”€ May have persistence installed

Containment Actions:
1. Selective isolate (user can still work on O365)
2. Block file hash org-wide
3. Delete malicious email from other mailboxes
4. Check for persistence mechanisms
5. Run AV scan

Timeline: Minutes to hours - depends on threat</code></pre>
                </div>
            </div>

            <h2>Lateral Movement Prevention</h2>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">Preventing Spread</span>
                    <button class="code-copy">ğŸ“‹ Copy</button>
                </div>
                <div class="code-content">
<pre><code>LATERAL MOVEMENT PREVENTION:

IMMEDIATE ACTIONS:
â”œâ”€â”€ Isolate compromised devices
â”œâ”€â”€ Disable compromised accounts
â”œâ”€â”€ Block attacker tools (PsExec, Mimikatz hashes)
â”œâ”€â”€ Block known attacker IPs
â””â”€â”€ Increase monitoring on critical assets

KQL - FIND LATERAL MOVEMENT:</code></pre>
                </div>
            </div>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">KQL - Lateral Movement Detection</span>
                    <button class="code-copy">ğŸ“‹ Copy</button>
                </div>
                <div class="code-content">
<pre><code><span class="comment">// Find devices connected to by compromised device</span>
<span class="keyword">let</span> CompromisedDevice = <span class="string">"WKSTN-HR-042"</span>;
<span class="variable">DeviceNetworkEvents</span>
<span class="operator">|</span> <span class="keyword">where</span> Timestamp <span class="operator">></span> <span class="function">ago</span>(<span class="number">24</span>h)
<span class="operator">|</span> <span class="keyword">where</span> DeviceName <span class="operator">==</span> CompromisedDevice
<span class="operator">|</span> <span class="keyword">where</span> RemotePort <span class="function">in</span> (<span class="number">445</span>, <span class="number">135</span>, <span class="number">3389</span>, <span class="number">5985</span>, <span class="number">5986</span>)
<span class="operator">|</span> <span class="keyword">summarize</span> Connections = <span class="function">count</span>() <span class="keyword">by</span> RemoteIP, RemotePort
<span class="operator">|</span> <span class="keyword">order by</span> Connections <span class="keyword">desc</span>

<span class="comment">// Find use of remote admin tools</span>
<span class="variable">DeviceProcessEvents</span>
<span class="operator">|</span> <span class="keyword">where</span> Timestamp <span class="operator">></span> <span class="function">ago</span>(<span class="number">24</span>h)
<span class="operator">|</span> <span class="keyword">where</span> FileName <span class="function">in~</span> (
    <span class="string">"psexec.exe"</span>, <span class="string">"psexec64.exe"</span>,
    <span class="string">"wmic.exe"</span>, <span class="string">"mstsc.exe"</span>
)
<span class="operator">|</span> <span class="keyword">project</span> Timestamp, DeviceName, FileName, ProcessCommandLine, AccountName

<span class="comment">// Find suspicious logons from compromised account</span>
<span class="keyword">let</span> CompromisedAccount = <span class="string">"john.smith"</span>;
<span class="variable">DeviceLogonEvents</span>
<span class="operator">|</span> <span class="keyword">where</span> Timestamp <span class="operator">></span> <span class="function">ago</span>(<span class="number">24</span>h)
<span class="operator">|</span> <span class="keyword">where</span> AccountName <span class="operator">=~</span> CompromisedAccount
<span class="operator">|</span> <span class="keyword">where</span> LogonType <span class="function">in</span> (<span class="string">"Network"</span>, <span class="string">"RemoteInteractive"</span>)
<span class="operator">|</span> <span class="keyword">summarize</span> Logons = <span class="function">count</span>() <span class="keyword">by</span> DeviceName
<span class="operator">|</span> <span class="keyword">order by</span> Logons <span class="keyword">desc</span></code></pre>
                </div>
            </div>

            <h2>Containment Playbook</h2>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">Standard Containment Procedure</span>
                    <button class="code-copy">ğŸ“‹ Copy</button>
                </div>
                <div class="code-content">
<pre><code>CONTAINMENT PLAYBOOK:

PHASE 1: RAPID ASSESSMENT (1-5 minutes)
â”œâ”€â”€ What is the threat? (malware type, severity)
â”œâ”€â”€ Is it actively executing?
â”œâ”€â”€ How many devices affected?
â”œâ”€â”€ Are credentials compromised?
â””â”€â”€ Is data being exfiltrated?

PHASE 2: IMMEDIATE CONTAINMENT (5-15 minutes)
â”œâ”€â”€ Isolate affected device(s)
â”œâ”€â”€ Block known malicious IOCs
â”œâ”€â”€ Disable compromised accounts
â”œâ”€â”€ Notify key stakeholders
â””â”€â”€ Begin evidence preservation

PHASE 3: SCOPE ASSESSMENT (15-60 minutes)
â”œâ”€â”€ Search for IOCs across environment
â”œâ”€â”€ Identify all affected devices
â”œâ”€â”€ Identify all compromised accounts
â”œâ”€â”€ Map attacker's activity timeline
â””â”€â”€ Identify initial access vector

PHASE 4: EXPANDED CONTAINMENT (as needed)
â”œâ”€â”€ Isolate additional devices
â”œâ”€â”€ Block additional IOCs
â”œâ”€â”€ Consider network segmentation
â”œâ”€â”€ Enhanced monitoring on critical assets
â””â”€â”€ Coordinate with network/IT teams

PHASE 5: CONTAINMENT VERIFICATION
â”œâ”€â”€ Confirm all threats isolated
â”œâ”€â”€ Verify no active C2 connections
â”œâ”€â”€ Check for new infection attempts
â”œâ”€â”€ Monitor for re-infection
â””â”€â”€ Document containment actions

COMMUNICATION CHECKLIST:
â”œâ”€â”€ IT leadership notified
â”œâ”€â”€ Business unit leadership notified
â”œâ”€â”€ Legal/compliance notified (if breach)
â”œâ”€â”€ Affected users notified
â””â”€â”€ Executive summary prepared</code></pre>
                </div>
            </div>

            <div class="callout warning">
                <div class="callout-icon">âš ï¸</div>
                <div class="callout-content">
                    <h5>Containment Pitfalls</h5>
                    <ul>
                        <li><strong>Never isolate Domain Controllers</strong>: This breaks Active Directory</li>
                        <li><strong>Don't power off devices</strong>: You lose volatile memory evidence</li>
                        <li><strong>Collect evidence first</strong>: Get investigation package before remediation</li>
                        <li><strong>Document everything</strong>: Actions taken, times, who did what</li>
                        <li><strong>Consider business impact</strong>: Balance security with operations</li>
                    </ul>
                </div>
            </div>

            <!-- Interview Tips -->
            <div class="interview-tips">
                <h3>ğŸ’¡ Key Interview Points</h3>
                <ul>
                    <li><strong>Speed matters</strong>: Active threats need immediate containment</li>
                    <li><strong>Isolation types</strong>: Full (all network) vs Selective (allows O365)</li>
                    <li><strong>Scope first</strong>: Know how many devices before deciding action</li>
                    <li><strong>Preserve evidence</strong>: Collect package before remediation</li>
                    <li><strong>DC exception</strong>: Never isolate Domain Controllers</li>
                </ul>
            </div>

            <nav class="page-nav">
                <a href="6-6-forensics-evidence.html" class="page-nav-link prev">
                    <span class="page-nav-label">â† Previous</span>
                    <span class="page-nav-title">Forensics & Evidence</span>
                </a>
                <a href="6-8-recovery-procedures.html" class="page-nav-link next">
                    <span class="page-nav-label">Next â†’</span>
                    <span class="page-nav-title">Recovery Procedures</span>
                </a>
            </nav>
        </div>
    </main>

    <div class="search-modal">
        <div class="search-modal-content">
            <div class="search-modal-input-wrapper">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="11" cy="11" r="8"></circle>
                    <path d="M21 21l-4.35-4.35"></path>
                </svg>
                <input type="text" class="search-modal-input" placeholder="Search pages..." autofocus>
                <button class="search-modal-close">ESC</button>
            </div>
            <div class="search-results"></div>
        </div>
    </div>
    <script src="main.js"></script>
</body>
</html>
