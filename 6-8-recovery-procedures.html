<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Recovery Procedures | MDE Ultimate Guide</title>
    <link rel="stylesheet" href="main.css">
</head>
<body>
    <header class="header">
        <div class="header-left">
            <button class="mobile-menu-btn" aria-label="Toggle menu">â˜°</button>
            <a href="index.html" class="logo">
                <div class="logo-icon">MDE</div>
                <div class="logo-text"><span>MDE</span> Ultimate Guide</div>
            </a>
        </div>
        <div class="search-container">
            <button class="search-btn">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="11" cy="11" r="8"></circle>
                    <path d="M21 21l-4.35-4.35"></path>
                </svg>
                <span>Search documentation...</span>
                <span class="search-shortcut"><kbd>âŒ˜</kbd><kbd>K</kbd></span>
            </button>
        </div>
        <div class="header-right">
            <a href="12-2-interview-questions.html" class="header-link">Interview Prep</a>
            <a href="5-3-kql-fundamentals.html" class="header-link">KQL Guide</a>
        </div>
    </header>

    <div class="sidebar-overlay"></div>
    <aside class="sidebar"></aside>

    <main class="main-content">
        <div class="content-wrapper">
            <div class="overview-box">
                <h4>ğŸ¯ What This Page Covers</h4>
                <p>Complete guide to recovery procedures after security incidents. Learn post-incident recovery, system restoration, credential resets, and return-to-operations procedures.</p>
            </div>

            <h1>Recovery Procedures</h1>

            <p>Recovery is the final phase of incident response, focused on restoring systems to normal operations while ensuring the threat is fully eliminated and preventing recurrence.</p>

            <h2>Recovery Workflow</h2>

            <div class="flow-diagram">
                <div class="diagram-title">Incident Recovery Process</div>
<pre>
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    INCIDENT RECOVERY WORKFLOW                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  1. VERIFICATION          2. REMEDIATION         3. RESTORATION         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ â€¢ Threat gone   â”‚ â”€â”€â–¶ â”‚ â€¢ Remove malwareâ”‚ â”€â”€â–¶â”‚ â€¢ Restore data  â”‚    â”‚
â”‚  â”‚ â€¢ Scope known   â”‚     â”‚ â€¢ Fix vulns     â”‚    â”‚ â€¢ Rebuild if    â”‚    â”‚
â”‚  â”‚ â€¢ Evidence savedâ”‚     â”‚ â€¢ Reset creds   â”‚    â”‚   needed        â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚           â”‚                      â”‚                      â”‚               â”‚
â”‚           â–¼                      â–¼                      â–¼               â”‚
â”‚  4. VALIDATION           5. MONITORING          6. CLOSURE             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ â€¢ Test systems  â”‚ â”€â”€â–¶ â”‚ â€¢ Enhanced      â”‚ â”€â”€â–¶â”‚ â€¢ Document      â”‚    â”‚
â”‚  â”‚ â€¢ Verify clean  â”‚     â”‚   monitoring    â”‚    â”‚ â€¢ Lessons       â”‚    â”‚
â”‚  â”‚ â€¢ User testing  â”‚     â”‚ â€¢ Watch for     â”‚    â”‚   learned       â”‚    â”‚
â”‚  â”‚                 â”‚     â”‚   re-infection  â”‚    â”‚ â€¢ Close case    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                          â”‚
â”‚  KEY PRINCIPLE: Never rush recovery - ensure threat is fully gone      â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</pre>
            </div>

            <h2>Pre-Recovery Verification</h2>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">Verification Checklist</span>
                    <button class="code-copy">ğŸ“‹ Copy</button>
                </div>
                <div class="code-content">
<pre><code>PRE-RECOVERY VERIFICATION:

BEFORE ANY RECOVERY ACTIONS:

1. CONFIRM THREAT ELIMINATED
   [ ] All malicious files quarantined/removed
   [ ] All persistence mechanisms removed
   [ ] C2 connections blocked
   [ ] Malicious accounts disabled
   [ ] No active attacker presence

2. CONFIRM SCOPE IS KNOWN
   [ ] All affected devices identified
   [ ] All compromised accounts identified
   [ ] Data exfiltration scope understood
   [ ] Initial access vector identified
   [ ] Lateral movement mapped

3. EVIDENCE PRESERVED
   [ ] Investigation packages collected
   [ ] Memory dumps (if needed)
   [ ] Log data exported
   [ ] Timeline documented
   [ ] IOCs catalogued</code></pre>
                </div>
            </div>

            <h2>Device Recovery Options</h2>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">Recovery Decision Matrix</span>
                    <button class="code-copy">ğŸ“‹ Copy</button>
                </div>
                <div class="code-content">
<pre><code>DEVICE RECOVERY OPTIONS:

OPTION 1: CLEAN IN PLACE (Low severity)
When: Simple malware, no persistence, limited impact
Steps:
â”œâ”€â”€ Run full AV scan (verify clean)
â”œâ”€â”€ Remove app execution restrictions
â”œâ”€â”€ Release from isolation
â”œâ”€â”€ Verify all services running
â”œâ”€â”€ Test user functionality
â””â”€â”€ Monitor for 24-48 hours

MDE ACTIONS:
1. Device page â†’ Run antivirus scan (Full)
2. Wait for scan completion
3. Verify no threats found
4. Release from isolation
5. Remove app restrictions (if applied)

OPTION 2: RESTORE FROM BACKUP (Medium severity)
When: Persistence present, unknown scope
Steps:
â”œâ”€â”€ Identify clean backup point
â”œâ”€â”€ Restore system from backup
â”œâ”€â”€ Apply latest security patches
â”œâ”€â”€ Re-run onboarding if needed
â”œâ”€â”€ Verify MDE connectivity
â””â”€â”€ Monitor closely

OPTION 3: FULL REBUILD (High severity)
When: Rootkit, bootkit, deep compromise
Steps:
â”œâ”€â”€ Wipe device completely
â”œâ”€â”€ Reinstall OS from known-good media
â”œâ”€â”€ Apply all security patches
â”œâ”€â”€ Install required applications
â”œâ”€â”€ Restore user data from backup
â”œâ”€â”€ Re-onboard to MDE
â””â”€â”€ Return to user

DECISION MATRIX:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Scenario                    â”‚ Recommended Action            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Simple malware, blocked     â”‚ Clean in place               â”‚
â”‚ Malware executed, no persistâ”‚ Clean in place + monitor     â”‚
â”‚ Persistence found           â”‚ Restore from backup          â”‚
â”‚ Credential theft            â”‚ Clean + credential reset     â”‚
â”‚ Rootkit/bootkit             â”‚ Full rebuild                 â”‚
â”‚ Unknown scope               â”‚ Full rebuild (safest)        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre>
                </div>
            </div>

            <h2>Credential Recovery</h2>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">Credential Reset Procedures</span>
                    <button class="code-copy">ğŸ“‹ Copy</button>
                </div>
                <div class="code-content">
<pre><code>CREDENTIAL RECOVERY BY SEVERITY:

STANDARD USER ACCOUNT:
â”œâ”€â”€ Force password reset
â”œâ”€â”€ Revoke active sessions
â”œâ”€â”€ Review recent activity
â”œâ”€â”€ Re-enable MFA if disabled
â””â”€â”€ Monitor for suspicious use

PRIVILEGED ACCOUNT COMPROMISE:
â”œâ”€â”€ Immediately disable account
â”œâ”€â”€ Reset password
â”œâ”€â”€ Revoke all sessions
â”œâ”€â”€ Review privileged access
â”œâ”€â”€ Check for created accounts
â””â”€â”€ Audit admin actions

DOMAIN ADMIN COMPROMISE (CRITICAL):
â”œâ”€â”€ Disable compromised account immediately
â”œâ”€â”€ Reset KRBTGT password (twice, 10+ hours apart)
â”œâ”€â”€ Reset all Domain Admin passwords
â”œâ”€â”€ Reset all service account passwords
â”œâ”€â”€ Check for Golden Ticket attacks
â”œâ”€â”€ Review AD for backdoor accounts
â””â”€â”€ Consider full AD recovery

# Azure AD - Force password reset
Set-AzureADUserPassword -ObjectId "<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="a8dddbcddae8cbc7c5d8c9c6d186cbc7c5">[email&#160;protected]</a>" `
    -Password $NewPassword -ForceChangePasswordNextLogin $true

# Revoke all sessions
Revoke-AzureADUserAllRefreshToken -ObjectId "<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="86f3f5e3f4c6e5e9ebf6e7e8ffa8e5e9eb">[email&#160;protected]</a>"</code></pre>
                </div>
            </div>

            <h2>Post-Recovery Monitoring</h2>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">KQL - Enhanced Monitoring</span>
                    <button class="code-copy">ğŸ“‹ Copy</button>
                </div>
                <div class="code-content">
<pre><code><span class="comment">// Monitor recovered devices for 30 days</span>
<span class="keyword">let</span> RecoveredDevices = <span class="function">dynamic</span>([<span class="string">"WKSTN-HR-042"</span>]);
<span class="keyword">let</span> ThreatIndicators = <span class="function">dynamic</span>([<span class="string">"malware.exe"</span>]);
<span class="variable">DeviceProcessEvents</span>
<span class="operator">|</span> <span class="keyword">where</span> Timestamp <span class="operator">></span> <span class="function">ago</span>(<span class="number">7</span>d)
<span class="operator">|</span> <span class="keyword">where</span> DeviceName <span class="function">in</span> (RecoveredDevices)
<span class="operator">|</span> <span class="keyword">where</span> FileName <span class="function">in</span> (ThreatIndicators) <span class="operator">or</span> 
        ProcessCommandLine <span class="function">has_any</span> (<span class="string">"-enc"</span>, <span class="string">"downloadstring"</span>)</code></pre>
                </div>
            </div>

            <div class="callout warning">
                <div class="callout-icon">âš ï¸</div>
                <div class="callout-content">
                    <h5>Critical Recovery Rules</h5>
                    <ul>
                        <li><strong>Never rush</strong>: Incomplete recovery leads to re-infection</li>
                        <li><strong>Verify clean</strong>: Run full scans before releasing devices</li>
                        <li><strong>Reset credentials</strong>: Assume compromised if any doubt</li>
                        <li><strong>Monitor closely</strong>: 30+ days enhanced monitoring</li>
                    </ul>
                </div>
            </div>

            <!-- Interview Tips -->
            <div class="interview-tips">
                <h3>ğŸ’¡ Key Interview Points</h3>
                <ul>
                    <li><strong>Recovery options</strong>: Clean in place, restore from backup, full rebuild</li>
                    <li><strong>KRBTGT reset</strong>: Twice, 10+ hours apart for domain compromise</li>
                    <li><strong>Verification</strong>: Never release without confirming clean</li>
                    <li><strong>Post-recovery</strong>: 30-day enhanced monitoring period</li>
                </ul>
            </div>

            <nav class="page-nav">
                <a href="6-7-containment-strategies.html" class="page-nav-link prev">
                    <span class="page-nav-label">â† Previous</span>
                    <span class="page-nav-title">Containment Strategies</span>
                </a>
                <a href="7-1-tvm-overview.html" class="page-nav-link next">
                    <span class="page-nav-label">Next â†’</span>
                    <span class="page-nav-title">TVM Overview</span>
                </a>
            </nav>
        </div>
    </main>

    <div class="search-modal">
        <div class="search-modal-content">
            <div class="search-modal-input-wrapper">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="11" cy="11" r="8"></circle>
                    <path d="M21 21l-4.35-4.35"></path>
                </svg>
                <input type="text" class="search-modal-input" placeholder