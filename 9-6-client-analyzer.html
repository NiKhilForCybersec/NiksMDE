<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Client Analyzer | MDE Ultimate Guide</title>
    <link rel="stylesheet" href="main.css">
</head>
<body>
    <header class="header">
        <div class="header-left">
            <button class="mobile-menu-btn" aria-label="Toggle menu">â˜°</button>
            <a href="index.html" class="logo">
                <div class="logo-icon">MDE</div>
                <div class="logo-text"><span>MDE</span> Ultimate Guide</div>
            </a>
        </div>
        <div class="search-container">
            <button class="search-btn">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="11" cy="11" r="8"></circle>
                    <path d="M21 21l-4.35-4.35"></path>
                </svg>
                <span>Search documentation...</span>
                <span class="search-shortcut"><kbd>âŒ˜</kbd><kbd>K</kbd></span>
            </button>
        </div>
        <div class="header-right">
            <a href="12-2-interview-questions.html" class="header-link">Interview Prep</a>
            <a href="5-3-kql-fundamentals.html" class="header-link">KQL Guide</a>
        </div>
    </header>

    <div class="sidebar-overlay"></div>
    <aside class="sidebar"></aside>

    <main class="main-content">
        <div class="content-wrapper">
            <div class="overview-box">
                <h4>ğŸ¯ What This Page Covers</h4>
                <p>Complete guide to the MDE Client Analyzer tool. Learn to diagnose client-side issues, collect diagnostic data, and troubleshoot sensor problems.</p>
            </div>

            <h1>MDE Client Analyzer</h1>

            <p>The MDE Client Analyzer is a diagnostic tool that collects detailed information about the MDE sensor and Defender Antivirus to troubleshoot issues.</p>

            <h2>Client Analyzer Overview</h2>

            <div class="flow-diagram">
                <div class="diagram-title">Client Analyzer Capabilities</div>
<pre>
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    MDE CLIENT ANALYZER                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  DOWNLOAD:                                                              â”‚
â”‚  https://aka.ms/MDEClientAnalyzer                                       â”‚
â”‚                                                                          â”‚
â”‚  COLLECTS:                                                              â”‚
â”‚  â”œâ”€â”€ Sensor configuration and status                                   â”‚
â”‚  â”œâ”€â”€ Connectivity test results                                         â”‚
â”‚  â”œâ”€â”€ Event logs (Defender, SENSE)                                      â”‚
â”‚  â”œâ”€â”€ Registry settings                                                 â”‚
â”‚  â”œâ”€â”€ Policy configurations                                             â”‚
â”‚  â”œâ”€â”€ Performance data                                                  â”‚
â”‚  â”œâ”€â”€ Certificate information                                           â”‚
â”‚  â””â”€â”€ Network configuration                                             â”‚
â”‚                                                                          â”‚
â”‚  OUTPUT:                                                                â”‚
â”‚  â”œâ”€â”€ MDEClientAnalyzerResult.zip                                       â”‚
â”‚  â”‚   â”œâ”€â”€ SystemInfo.txt                                                â”‚
â”‚  â”‚   â”œâ”€â”€ EventLogs/                                                    â”‚
â”‚  â”‚   â”œâ”€â”€ RegistryExports/                                              â”‚
â”‚  â”‚   â”œâ”€â”€ ConnectivityTests/                                            â”‚
â”‚  â”‚   â””â”€â”€ DefenderInfo/                                                 â”‚
â”‚  â””â”€â”€ Console summary with Pass/Fail checks                             â”‚
â”‚                                                                          â”‚
â”‚  PLATFORMS: Windows, macOS, Linux                                       â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</pre>
            </div>

            <h2>Running the Analyzer</h2>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">Windows Usage</span>
                    <button class="code-copy">ğŸ“‹ Copy</button>
                </div>
                <div class="code-content">
<pre><code>RUNNING MDE CLIENT ANALYZER (Windows):

STEP 1: DOWNLOAD
â”œâ”€â”€ Download from: https://aka.ms/MDEClientAnalyzer
â”œâ”€â”€ Or use PowerShell:
â”‚   Invoke-WebRequest -Uri "https://aka.ms/MDEClientAnalyzer" `
â”‚       -OutFile MDEClientAnalyzer.zip
â””â”€â”€ Extract the ZIP file

STEP 2: RUN (Elevated Command Prompt)
cd C:\path\to\MDEClientAnalyzer
MDEClientAnalyzer.cmd

STEP 3: WAIT FOR COMPLETION
â”œâ”€â”€ Takes 5-15 minutes
â”œâ”€â”€ Runs connectivity tests
â”œâ”€â”€ Collects logs and config
â””â”€â”€ Generates summary

STEP 4: REVIEW OUTPUT
â”œâ”€â”€ Console shows Pass/Fail summary
â”œâ”€â”€ Results in: MDEClientAnalyzerResult.zip
â””â”€â”€ Upload to support case if needed

COMMAND LINE OPTIONS:
MDEClientAnalyzer.cmd              # Standard run
MDEClientAnalyzer.cmd -h           # Help
MDEClientAnalyzer.cmd -o C:\output # Custom output path
MDEClientAnalyzer.cmd -d           # Debug mode
MDEClientAnalyzer.cmd -t           # Trace mode (detailed)

LIVE RESPONSE:
# Run from Live Response session
library MDEClientAnalyzer.zip
run MDEClientAnalyzerCMD.cmd</code></pre>
                </div>
            </div>

            <h2>Key Diagnostic Checks</h2>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">Diagnostic Checks Performed</span>
                    <button class="code-copy">ğŸ“‹ Copy</button>
                </div>
                <div class="code-content">
<pre><code>KEY DIAGNOSTIC CHECKS:

ONBOARDING STATUS:
â”œâ”€â”€ âœ“ Device is onboarded
â”œâ”€â”€ âœ“ Organization ID configured
â”œâ”€â”€ âœ“ Onboarding timestamp valid
â””â”€â”€ âœ— Onboarding failed (shows error)

SERVICE STATUS:
â”œâ”€â”€ âœ“ SENSE service running
â”œâ”€â”€ âœ“ WinDefend service running
â”œâ”€â”€ âœ“ Services start automatically
â””â”€â”€ âœ— Service stopped/disabled

CONNECTIVITY:
â”œâ”€â”€ âœ“ Can reach MDE cloud endpoints
â”œâ”€â”€ âœ“ SSL/TLS certificates valid
â”œâ”€â”€ âœ“ Proxy configured correctly
â””â”€â”€ âœ— Connectivity blocked (shows URL)

CONFIGURATION:
â”œâ”€â”€ âœ“ Telemetry level sufficient
â”œâ”€â”€ âœ“ Cloud protection enabled
â”œâ”€â”€ âœ“ Real-time protection enabled
â””â”€â”€ âœ— Feature disabled (shows setting)

COMMON CHECK RESULTS:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Check                          â”‚ Status  â”‚ Action          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Onboarding state               â”‚ PASS    â”‚ None needed     â”‚
â”‚ SENSE service                  â”‚ PASS    â”‚ None needed     â”‚
â”‚ Cloud connectivity             â”‚ FAIL    â”‚ Check firewall  â”‚
â”‚ Telemetry level                â”‚ WARN    â”‚ Increase level  â”‚
â”‚ Certificate validation         â”‚ PASS    â”‚ None needed     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre>
                </div>
            </div>

            <h2>Analyzing Results</h2>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">Result Analysis</span>
                    <button class="code-copy">ğŸ“‹ Copy</button>
                </div>
                <div class="code-content">
<pre><code>ANALYZING CLIENT ANALYZER RESULTS:

ZIP FILE CONTENTS:
MDEClientAnalyzerResult.zip/
â”œâ”€â”€ SystemInfoNetworkConfig.txt
â”‚   â””â”€â”€ OS version, network adapters, proxy
â”œâ”€â”€ EventLogs/
â”‚   â”œâ”€â”€ SENSE-Operational.evtx
â”‚   â”œâ”€â”€ WindowsDefender-Operational.evtx
â”‚   â””â”€â”€ System-Errors.evtx
â”œâ”€â”€ RegistryExports/
â”‚   â”œâ”€â”€ HKLM-ATP.reg
â”‚   â”œâ”€â”€ HKLM-Defender.reg
â”‚   â””â”€â”€ HKLM-Policies.reg
â”œâ”€â”€ ConnectivityResults/
â”‚   â”œâ”€â”€ URLConnectivity.txt
â”‚   â””â”€â”€ CertificateInfo.txt
â””â”€â”€ MDEClientAnalyzer.htm
    â””â”€â”€ Summary report (open in browser)

KEY FILES TO CHECK:

1. MDEClientAnalyzer.htm
   â”œâ”€â”€ Visual summary of all checks
   â”œâ”€â”€ Pass/Fail status
   â”œâ”€â”€ Recommendations
   â””â”€â”€ Start here for troubleshooting

2. ConnectivityResults/URLConnectivity.txt
   â”œâ”€â”€ Each URL tested
   â”œâ”€â”€ Success or failure
   â””â”€â”€ Error codes if failed

3. EventLogs/SENSE-Operational.evtx
   â”œâ”€â”€ Sensor events
   â”œâ”€â”€ Error details
   â””â”€â”€ Communication failures

4. RegistryExports/HKLM-ATP.reg
   â”œâ”€â”€ Onboarding configuration
   â”œâ”€â”€ Organization ID
   â””â”€â”€ Sensor settings</code></pre>
                </div>
            </div>

            <h2>Common Issues and Fixes</h2>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">Troubleshooting Guide</span>
                    <button class="code-copy">ğŸ“‹ Copy</button>
                </div>
                <div class="code-content">
<pre><code>COMMON ISSUES FROM CLIENT ANALYZER:

ISSUE: Connectivity Failed
Analyzer shows: "Cannot connect to [URL]"
Causes:
â”œâ”€â”€ Firewall blocking outbound
â”œâ”€â”€ Proxy not configured
â”œâ”€â”€ SSL inspection breaking certs
â””â”€â”€ Network policy blocking

Fix:
â”œâ”€â”€ Allow MDE URLs in firewall
â”œâ”€â”€ Configure proxy: Set-MpPreference -ProxyServer
â”œâ”€â”€ Add SSL inspection bypass for MDE
â””â”€â”€ Check with network team

ISSUE: Service Not Running
Analyzer shows: "SENSE service stopped"
Causes:
â”œâ”€â”€ Disabled by GPO
â”œâ”€â”€ Third-party conflict
â”œâ”€â”€ Corruption
â””â”€â”€ Resource exhaustion

Fix:
â”œâ”€â”€ Check GPO settings
â”œâ”€â”€ Remove conflicting software
â”œâ”€â”€ Re-run onboarding script
â””â”€â”€ Check system resources

ISSUE: Not Onboarded
Analyzer shows: "OnboardingState = 0"
Causes:
â”œâ”€â”€ Onboarding script never ran
â”œâ”€â”€ Script failed silently
â”œâ”€â”€ Wrong tenant configuration
â””â”€â”€ Prerequisites not met

Fix:
â”œâ”€â”€ Re-run onboarding script
â”œâ”€â”€ Check script output
â”œâ”€â”€ Verify tenant ID
â””â”€â”€ Check Windows version

ISSUE: Telemetry Level Too Low
Analyzer shows: "Telemetry level insufficient"
Causes:
â”œâ”€â”€ GPO set to minimal
â”œâ”€â”€ Privacy settings
â””â”€â”€ Policy conflict

Fix:
â”œâ”€â”€ Set telemetry to Basic (1) minimum
â”œâ”€â”€ Check GPO: Computer Config â†’ Admin Templates â†’
â”‚   Windows Components â†’ Data Collection
â””â”€â”€ Required for MDE functionality</code></pre>
                </div>
            </div>

            <h2>Platform-Specific Usage</h2>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">macOS and Linux</span>
                    <button class="code-copy">ğŸ“‹ Copy</button>
                </div>
                <div class="code-content">
<pre><code>MACOS CLIENT ANALYZER:

Download: https://aka.ms/MDEClientAnalyzerMacOS

Run:
chmod +x MDEClientAnalyzer.sh
sudo ./MDEClientAnalyzer.sh

Output: MDEClientAnalyzerResult.zip

Checks:
â”œâ”€â”€ MDE for Mac installation
â”œâ”€â”€ Service status (wdavdaemon)
â”œâ”€â”€ Configuration
â”œâ”€â”€ Connectivity
â””â”€â”€ System requirements

LINUX CLIENT ANALYZER:

Download: https://aka.ms/MDEClientAnalyzerLinux

Run:
chmod +x MDEClientAnalyzer.sh
sudo ./MDEClientAnalyzer.sh

Output: MDEClientAnalyzerResult.zip

Checks:
â”œâ”€â”€ MDE for Linux installation
â”œâ”€â”€ Service status (mdatp)
â”œâ”€â”€ Configuration
â”œâ”€â”€ Connectivity
â””â”€â”€ Distribution compatibility

COMMON CROSS-PLATFORM CHECKS:
â”œâ”€â”€ Product version installed
â”œâ”€â”€ Definitions age
â”œâ”€â”€ Real-time protection status
â”œâ”€â”€ Cloud connectivity
â””â”€â”€ License status</code></pre>
                </div>
            </div>

            <div class="callout tip">
                <div class="callout-icon">ğŸ’¡</div>
                <div class="callout-content">
                    <h5>Best Practices</h5>
                    <ul>
                        <li><strong>Run as admin</strong>: Requires elevated privileges for full data</li>
                        <li><strong>Collect fresh data</strong>: Run immediately when issue occurs</li>
                        <li><strong>Check HTML report first</strong>: Start with the summary report</li>
                        <li><strong>Include in support cases</strong>: Attach ZIP to Microsoft support tickets</li>
                    </ul>
                </div>
            </div>

            <!-- Interview Tips -->
            <div class="interview-tips">
                <h3>ğŸ’¡ Key Interview Points</h3>
                <ul>
                    <li><strong>Purpose</strong>: Collect diagnostic data for MDE troubleshooting</li>
                    <li><strong>Download</strong>: https://aka.ms/MDEClientAnalyzer</li>
                    <li><strong>Output</strong>: MDEClientAnalyzerResult.zip with logs, config, tests</li>
                    <li><strong>Key checks</strong>: Onboarding, services, connectivity, configuration</li>
                    <li><strong>Cross-platform</strong>: Available for Windows, macOS, Linux</li>
                </ul>
            </div>

            <nav class="page-nav">
                <a href="9-5-protection-issues.html" class="page-nav-link prev">
                    <span class="page-nav-label">â† Previous</span>
                    <span class="page-nav-title">Protection Issues</span>
                </a>
                <a href="10-1-deployment-planning.html" class="page-nav-link next">
                    <span class="page-nav-label">Next â†’</span>
                    <span class="page-nav-title">Deployment Planning</span>
                </a>
            </nav>
        </div>
    </main>

    <div class="search-modal">
        <div class="search-modal-content">
            <div class="search-modal-input-wrapper">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="11" cy="11" r="8"></circle>
                    <path d="M21 21l-4.35-4.35"></path>
                </svg>
                <input type="text" class="search-modal-input" placeholder="Search pages..." autofocus>
                <button class="search-modal-close">ESC</button>
            </div>
            <div class="search-results"></div>
        </div>
    </div>
    <script src="main.js"></script>
</body>
</html>
