<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="MDE ASR Rules - Complete Guide to All 19 Attack Surface Reduction Rules">
    <title>ASR Rules - MDE Ultimate Guide</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="navbar-container">
            <a href="index.html" class="navbar-brand">
                <span class="brand-icon">ğŸ›¡ï¸</span>
                <span>MDE Ultimate Guide</span>
            </a>
            <button class="navbar-toggle">â˜°</button>
            <ul class="navbar-nav">
                <li class="nav-item"><a href="index.html" class="nav-link">Home</a></li>
                <li class="nav-item"><a href="architecture.html" class="nav-link">Architecture</a></li>
                <li class="nav-item"><a href="deployment.html" class="nav-link">Deployment</a></li>
               <li class="nav-item"><a href="features.html" class="nav-link">Features</a></li>
                <li class="nav-item"><a href="tvm.html" class="nav-link">TVM</a></li>
                <li class="nav-item"><a href="asr-rules.html" class="nav-link">ASR Rules</a></li>
                <li class="nav-item"><a href="analyst-engineer.html" class="nav-link">Analyst vs Engineer</a></li>
                <li class="nav-item"><a href="troubleshooting.html" class="nav-link">Troubleshooting</a></li>
                <li class="nav-item"><a href="licensing.html" class="nav-link">Licensing & Comparison</a></li>
                <li class="nav-item"><a href="kql-rules.html" class="nav-link">KQL Rules</a></li>
                <li class="nav-item"><a href="use-cases.html" class="nav-link">Use Cases</a></li>
                <li class="nav-item"><a href="automation.html" class="nav-link">Automation</a></li>
                <li class="nav-item"><a href="best-practices.html" class="nav-link">Best Practices</a></li>
            </ul>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="main-container">
        <div class="content-wrapper">
            <!-- Sidebar -->
            <aside class="sidebar">
                <nav class="sidebar-nav">
                    <div class="sidebar-title">On This Page</div>
                    <ul class="sidebar-links">
                        <li><a href="#overview">Overview</a></li>
                        <li><a href="#configuration">Configuration</a></li>
                        <li><a href="#office-rules">Office Application Rules</a></li>
                        <li><a href="#script-rules">Script & Execution Rules</a></li>
                        <li><a href="#credential-rules">Credential Protection</a></li>
                        <li><a href="#other-rules">Other Rules</a></li>
                        <li><a href="#exclusions">Exclusions</a></li>
                        <li><a href="#monitoring">Monitoring & Reporting</a></li>
                        <li><a href="#rollout">Rollout Strategy</a></li>
                    </ul>
                </nav>
            </aside>

            <!-- Main Content Area -->
            <div class="content">
                <h1>ğŸ›¡ï¸ Attack Surface Reduction Rules</h1>
                <p class="section-desc">
                    Complete reference for all 19 ASR rules with GUIDs, recommended modes, 
                    common exclusions, and rollout guidance.
                </p>

                <!-- Overview -->
                <section id="overview">
                    <h2>Overview</h2>
                    
                    <div class="card">
                        <div class="card-body">
                            <p>
                                <strong>Attack Surface Reduction (ASR) rules</strong> are behavioral controls that 
                                block specific techniques commonly used by malware. They operate at the prevention 
                                layer, stopping attacks before they execute. ASR is part of MDE Plan 1 and higher.
                            </p>
                        </div>
                    </div>

                    <h3>ASR Rule Modes</h3>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>Mode</th>
                                    <th>Value</th>
                                    <th>Behavior</th>
                                    <th>Use Case</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><span class="badge badge-secondary">Disabled</span></td>
                                    <td>0</td>
                                    <td>Rule not active, no logging</td>
                                    <td>Rule causes production issues</td>
                                </tr>
                                <tr>
                                    <td><span class="badge badge-danger">Block</span></td>
                                    <td>1</td>
                                    <td>Block action and generate event</td>
                                    <td>Production enforcement</td>
                                </tr>
                                <tr>
                                    <td><span class="badge badge-warning">Audit</span></td>
                                    <td>2</td>
                                    <td>Log event but allow action</td>
                                    <td>Testing before enabling block</td>
                                </tr>
                                <tr>
                                    <td><span class="badge badge-info">Warn</span></td>
                                    <td>6</td>
                                    <td>Show user warning, allow bypass</td>
                                    <td>User education phase</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="alert alert-warning">
                        <div class="alert-icon">âš ï¸</div>
                        <div class="alert-content">
                            <div class="alert-title">Best Practice</div>
                            <p>
                                Always enable rules in <strong>Audit mode first</strong> for 2-4 weeks before 
                                switching to Block mode. Review ASR reports in the portal to identify 
                                potential business impact and create necessary exclusions.
                            </p>
                        </div>
                    </div>
                </section>

                <!-- Configuration -->
                <section id="configuration">
                    <h2>Configuration Methods</h2>
                    
                    <h3>Intune Configuration</h3>
                    <div class="code-block">
                        <div class="code-header">
                            <span class="code-lang">Intune Path</span>
                            <button class="code-copy">Copy</button>
                        </div>
                        <pre><code>Endpoint Security â†’ Attack Surface Reduction â†’ Create Policy
Platform: Windows 10, Windows 11, and Windows Server
Profile: Attack Surface Reduction Rules

OR

Devices â†’ Configuration profiles â†’ Create profile
Platform: Windows 10 and later
Profile type: Templates â†’ Endpoint Protection â†’ Microsoft Defender Exploit Guard</code></pre>
                    </div>

                    <h3>Group Policy Configuration</h3>
                    <div class="code-block">
                        <div class="code-header">
                            <span class="code-lang">GPO Path</span>
                            <button class="code-copy">Copy</button>
                        </div>
                        <pre><code>Computer Configuration â†’ Policies â†’ Administrative Templates â†’ 
  Windows Components â†’ Microsoft Defender Antivirus â†’ 
    Microsoft Defender Exploit Guard â†’ Attack Surface Reduction

Configure Attack Surface Reduction rules: Enabled
Configure the state for each ASR rule: 
  [GUID]=0 (Disabled)
  [GUID]=1 (Block)
  [GUID]=2 (Audit)
  [GUID]=6 (Warn)</code></pre>
                    </div>

                    <h3>PowerShell Configuration</h3>
                    <div class="code-block">
                        <div class="code-header">
                            <span class="code-lang">PowerShell</span>
                            <button class="code-copy">Copy</button>
                        </div>
                        <pre><code># Enable single rule in Block mode
Add-MpPreference -AttackSurfaceReductionRules_Ids "GUID-HERE" -AttackSurfaceReductionRules_Actions Enabled

# Enable rule in Audit mode
Add-MpPreference -AttackSurfaceReductionRules_Ids "GUID-HERE" -AttackSurfaceReductionRules_Actions AuditMode

# Enable multiple rules at once
$rules = @{
    "BE9BA2D9-53EA-4CDC-84E5-9B1EEEE46550" = 1  # Block executable from email
    "D4F940AB-401B-4EFC-AADC-AD5F3C50688A" = 2  # Audit Office child process
    "3B576869-A4EC-4529-8536-B80A7769E899" = 1  # Block Office executable creation
}
foreach ($rule in $rules.GetEnumerator()) {
    Add-MpPreference -AttackSurfaceReductionRules_Ids $rule.Key -AttackSurfaceReductionRules_Actions $rule.Value
}

# View current ASR configuration
Get-MpPreference | Select-Object -ExpandProperty AttackSurfaceReductionRules_Ids
Get-MpPreference | Select-Object -ExpandProperty AttackSurfaceReductionRules_Actions

# Disable specific rule
Set-MpPreference -AttackSurfaceReductionRules_Ids "GUID-HERE" -AttackSurfaceReductionRules_Actions Disabled</code></pre>
                    </div>
                </section>

                <!-- Office Application Rules -->
                <section id="office-rules">
                    <h2>Office Application Rules</h2>
                    
                    <div class="card">
                        <div class="card-header">
                            <div class="card-icon">ğŸ“§</div>
                            <div>
                                <h4 class="card-title">Block executable content from email client and webmail</h4>
                                <p class="card-subtitle">GUID: BE9BA2D9-53EA-4CDC-84E5-9B1EEEE46550</p>
                            </div>
                        </div>
                        <div class="card-body">
                            <p><strong>What it does:</strong> Blocks executable files (.exe, .dll, .scr) and scripts launched from Outlook and webmail.</p>
                            <p><strong>Attack blocked:</strong> Email-based malware distribution</p>
                            <p><strong>Recommendation:</strong> <span class="badge badge-danger">Block</span></p>
                            <p><strong>Business impact:</strong> Low - legitimate executables shouldn't come via email</p>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-header">
                            <div class="card-icon">ğŸ“„</div>
                            <div>
                                <h4 class="card-title">Block Office applications from creating child processes</h4>
                                <p class="card-subtitle">GUID: D4F940AB-401B-4EFC-AADC-AD5F3C50688A</p>
                            </div>
                        </div>
                        <div class="card-body">
                            <p><strong>What it does:</strong> Prevents Word, Excel, PowerPoint from launching child processes like cmd.exe or PowerShell.</p>
                            <p><strong>Attack blocked:</strong> Macro-based malware, document exploits</p>
                            <p><strong>Recommendation:</strong> <span class="badge badge-warning">Audit first</span> then <span class="badge badge-danger">Block</span></p>
                            <p><strong>Business impact:</strong> Medium - may affect legitimate macros that launch external tools</p>
                            <p><strong>Common exclusions:</strong> Specific business macros, automation tools</p>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-header">
                            <div class="card-icon">ğŸ’¾</div>
                            <div>
                                <h4 class="card-title">Block Office applications from creating executable content</h4>
                                <p class="card-subtitle">GUID: 3B576869-A4EC-4529-8536-B80A7769E899</p>
                            </div>
                        </div>
                        <div class="card-body">
                            <p><strong>What it does:</strong> Prevents Office apps from writing executable files to disk.</p>
                            <p><strong>Attack blocked:</strong> Macro droppers, document-based malware</p>
                            <p><strong>Recommendation:</strong> <span class="badge badge-danger">Block</span></p>
                            <p><strong>Business impact:</strong> Low - Office shouldn't create executables</p>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-header">
                            <div class="card-icon">ğŸ’‰</div>
                            <div>
                                <h4 class="card-title">Block Office applications from injecting code into other processes</h4>
                                <p class="card-subtitle">GUID: 75668C1F-73B5-4CF0-BB93-3ECF5CB7CC84</p>
                            </div>
                        </div>
                        <div class="card-body">
                            <p><strong>What it does:</strong> Blocks process injection techniques from Office applications.</p>
                            <p><strong>Attack blocked:</strong> Process hollowing, DLL injection from macros</p>
                            <p><strong>Recommendation:</strong> <span class="badge badge-danger">Block</span></p>
                            <p><strong>Business impact:</strong> Low - injection is not legitimate behavior</p>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-header">
                            <div class="card-icon">ğŸ”—</div>
                            <div>
                                <h4 class="card-title">Block Win32 API calls from Office macros</h4>
                                <p class="card-subtitle">GUID: 92E97FA1-2EDF-4476-BDD6-9DD0B4DDDC7B</p>
                            </div>
                        </div>
                        <div class="card-body">
                            <p><strong>What it does:</strong> Prevents VBA macros from calling Win32 APIs directly.</p>
                            <p><strong>Attack blocked:</strong> Advanced macro-based attacks using direct API calls</p>
                            <p><strong>Recommendation:</strong> <span class="badge badge-warning">Audit first</span></p>
                            <p><strong>Business impact:</strong> Medium-High - some legitimate macros use Win32 APIs</p>
                            <p><strong>Common exclusions:</strong> Business-critical macro applications</p>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-header">
                            <div class="card-icon">ğŸ“</div>
                            <div>
                                <h4 class="card-title">Block Office communication apps from creating child processes</h4>
                                <p class="card-subtitle">GUID: 26190899-1602-49E8-8B27-EB1D0A1CE869</p>
                            </div>
                        </div>
                        <div class="card-body">
                            <p><strong>What it does:</strong> Blocks Outlook from spawning child processes.</p>
                            <p><strong>Attack blocked:</strong> Outlook-based attacks, email exploits</p>
                            <p><strong>Recommendation:</strong> <span class="badge badge-warning">Audit first</span></p>
                            <p><strong>Business impact:</strong> Medium - may affect Outlook plugins</p>
                        </div>
                    </div>
                </section>

                <!-- Script & Execution Rules -->
                <section id="script-rules">
                    <h2>Script & Execution Rules</h2>
                    
                    <div class="card">
                        <div class="card-header">
                            <div class="card-icon">ğŸ”’</div>
                            <div>
                                <h4 class="card-title">Block execution of potentially obfuscated scripts</h4>
                                <p class="card-subtitle">GUID: 5BEB7EFE-FD9A-4556-801D-275E5FFC04CC</p>
                            </div>
                        </div>
                        <div class="card-body">
                            <p><strong>What it does:</strong> Uses ML to detect and block obfuscated JavaScript, VBScript, PowerShell.</p>
                            <p><strong>Attack blocked:</strong> Obfuscated malware scripts, encoded payloads</p>
                            <p><strong>Recommendation:</strong> <span class="badge badge-danger">Block</span></p>
                            <p><strong>Business impact:</strong> Low-Medium - may affect minified JavaScript</p>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-header">
                            <div class="card-icon">ğŸ“œ</div>
                            <div>
                                <h4 class="card-title">Block JavaScript or VBScript from launching downloaded executable content</h4>
                                <p class="card-subtitle">GUID: D3E037E1-3EB8-44C8-A917-57927947596D</p>
                            </div>
                        </div>
                        <div class="card-body">
                            <p><strong>What it does:</strong> Blocks scripts from launching downloaded executables.</p>
                            <p><strong>Attack blocked:</strong> Drive-by downloads, malicious script loaders</p>
                            <p><strong>Recommendation:</strong> <span class="badge badge-danger">Block</span></p>
                            <p><strong>Business impact:</strong> Low - scripts shouldn't download and run executables</p>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-header">
                            <div class="card-icon">âš™ï¸</div>
                            <div>
                                <h4 class="card-title">Block process creations originating from PSExec and WMI commands</h4>
                                <p class="card-subtitle">GUID: D1E49AAC-8F56-4280-B9BA-993A6D77406C</p>
                            </div>
                        </div>
                        <div class="card-body">
                            <p><strong>What it does:</strong> Blocks processes spawned by PSExec and WMI remote commands.</p>
                            <p><strong>Attack blocked:</strong> Lateral movement, remote code execution</p>
                            <p><strong>Recommendation:</strong> <span class="badge badge-warning">Audit first</span></p>
                            <p><strong>Business impact:</strong> High - affects admin tools, SCCM, remote management</p>
                            <p><strong>Common exclusions:</strong> SCCM, monitoring tools, IT automation</p>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-header">
                            <div class="card-icon">ğŸ”„</div>
                            <div>
                                <h4 class="card-title">Block untrusted and unsigned processes that run from USB</h4>
                                <p class="card-subtitle">GUID: B2B3F03D-6A65-4F7B-A9C7-1C7EF74A9BA4</p>
                            </div>
                        </div>
                        <div class="card-body">
                            <p><strong>What it does:</strong> Blocks execution of unsigned executables from USB drives.</p>
                            <p><strong>Attack blocked:</strong> USB-based malware, BadUSB attacks</p>
                            <p><strong>Recommendation:</strong> <span class="badge badge-danger">Block</span></p>
                            <p><strong>Business impact:</strong> Medium - affects portable apps run from USB</p>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-header">
                            <div class="card-icon">ğŸ“¥</div>
                            <div>
                                <h4 class="card-title">Block executable files from running unless they meet prevalence, age, or trusted list criteria</h4>
                                <p class="card-subtitle">GUID: 01443614-CD74-433A-B99E-2ECDC07BFC25</p>
                            </div>
                        </div>
                        <div class="card-body">
                            <p><strong>What it does:</strong> Blocks low-reputation executables based on cloud intelligence.</p>
                            <p><strong>Attack blocked:</strong> New/unknown malware, zero-day threats</p>
                            <p><strong>Recommendation:</strong> <span class="badge badge-warning">Audit first</span></p>
                            <p><strong>Business impact:</strong> High - may block new internal applications</p>
                            <p><strong>Common exclusions:</strong> Internal app paths, development tools</p>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-header">
                            <div class="card-icon">â¬‡ï¸</div>
                            <div>
                                <h4 class="card-title">Use advanced protection against ransomware</h4>
                                <p class="card-subtitle">GUID: C1DB55AB-C21A-4637-BB3F-A12568109D35</p>
                            </div>
                        </div>
                        <div class="card-body">
                            <p><strong>What it does:</strong> Additional heuristics to identify ransomware behavior.</p>
                            <p><strong>Attack blocked:</strong> Ransomware encryption activities</p>
                            <p><strong>Recommendation:</strong> <span class="badge badge-danger">Block</span></p>
                            <p><strong>Business impact:</strong> Low - specifically targets ransomware patterns</p>
                        </div>
                    </div>
                </section>

                <!-- Credential Protection Rules -->
                <section id="credential-rules">
                    <h2>Credential Protection Rules</h2>
                    
                    <div class="card">
                        <div class="card-header">
                            <div class="card-icon">ğŸ”</div>
                            <div>
                                <h4 class="card-title">Block credential stealing from Windows LSASS</h4>
                                <p class="card-subtitle">GUID: 9E6C4E1F-7D60-472F-BA1A-A39EF669E4B2</p>
                            </div>
                        </div>
                        <div class="card-body">
                            <p><strong>What it does:</strong> Blocks processes from reading LSASS memory.</p>
                            <p><strong>Attack blocked:</strong> Mimikatz, credential dumping, pass-the-hash</p>
                            <p><strong>Recommendation:</strong> <span class="badge badge-danger">Block</span></p>
                            <p><strong>Business impact:</strong> Low - legitimate apps rarely access LSASS</p>
                            <p><strong>Note:</strong> Consider enabling Credential Guard (HVCI) for additional protection</p>
                        </div>
                    </div>
                </section>

                <!-- Other Rules -->
                <section id="other-rules">
                    <h2>Other Rules</h2>
                    
                    <div class="card">
                        <div class="card-header">
                            <div class="card-icon">ğŸ–¥ï¸</div>
                            <div>
                                <h4 class="card-title">Block persistence through WMI event subscription</h4>
                                <p class="card-subtitle">GUID: E6DB77E5-3DF2-4CF1-B95A-636979351E5B</p>
                            </div>
                        </div>
                        <div class="card-body">
                            <p><strong>What it does:</strong> Blocks creation of WMI event subscriptions for persistence.</p>
                            <p><strong>Attack blocked:</strong> WMI-based persistence mechanisms</p>
                            <p><strong>Recommendation:</strong> <span class="badge badge-warning">Audit first</span></p>
                            <p><strong>Business impact:</strong> Medium - may affect monitoring/management tools</p>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-header">
                            <div class="card-icon">ğŸ“</div>
                            <div>
                                <h4 class="card-title">Block abuse of exploited vulnerable signed drivers</h4>
                                <p class="card-subtitle">GUID: 56A863A9-875E-4185-98A7-B882C64B5CE5</p>
                            </div>
                        </div>
                        <div class="card-body">
                            <p><strong>What it does:</strong> Blocks loading of known-vulnerable signed drivers.</p>
                            <p><strong>Attack blocked:</strong> BYOVD (Bring Your Own Vulnerable Driver) attacks</p>
                            <p><strong>Recommendation:</strong> <span class="badge badge-danger">Block</span></p>
                            <p><strong>Business impact:</strong> Low - blocks known bad drivers</p>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-header">
                            <div class="card-icon">ğŸŒ</div>
                            <div>
                                <h4 class="card-title">Block Adobe Reader from creating child processes</h4>
                                <p class="card-subtitle">GUID: 7674BA52-37EB-4A4F-A9A1-F0F9A1619A2C</p>
                            </div>
                        </div>
                        <div class="card-body">
                            <p><strong>What it does:</strong> Prevents Adobe Reader from spawning child processes.</p>
                            <p><strong>Attack blocked:</strong> PDF-based exploits and malware</p>
                            <p><strong>Recommendation:</strong> <span class="badge badge-danger">Block</span></p>
                            <p><strong>Business impact:</strong> Low - Reader shouldn't spawn processes</p>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-header">
                            <div class="card-icon">ğŸ”§</div>
                            <div>
                                <h4 class="card-title">Block Webshell creation for Servers</h4>
                                <p class="card-subtitle">GUID: A8F5898E-1DC8-49A9-9878-85004B8A61E6</p>
                            </div>
                        </div>
                        <div class="card-body">
                            <p><strong>What it does:</strong> Blocks web server processes from creating script files.</p>
                            <p><strong>Attack blocked:</strong> Webshell deployment on IIS/Exchange</p>
                            <p><strong>Recommendation:</strong> <span class="badge badge-danger">Block</span> (on servers)</p>
                            <p><strong>Business impact:</strong> Low on servers - web servers shouldn't write scripts</p>
                        </div>
                    </div>
                </section>

                <!-- Complete GUID Reference Table -->
                <section id="guid-reference">
                    <h2>Complete ASR Rules GUID Reference</h2>
                    
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>Rule Name</th>
                                    <th>GUID</th>
                                    <th>Rec. Mode</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Block executable content from email</td>
                                    <td><code>BE9BA2D9-53EA-4CDC-84E5-9B1EEEE46550</code></td>
                                    <td><span class="badge badge-danger">Block</span></td>
                                </tr>
                                <tr>
                                    <td>Block Office apps creating child processes</td>
                                    <td><code>D4F940AB-401B-4EFC-AADC-AD5F3C50688A</code></td>
                                    <td><span class="badge badge-warning">Audit</span></td>
                                </tr>
                                <tr>
                                    <td>Block Office apps creating executable content</td>
                                    <td><code>3B576869-A4EC-4529-8536-B80A7769E899</code></td>
                                    <td><span class="badge badge-danger">Block</span></td>
                                </tr>
                                <tr>
                                    <td>Block Office apps injecting code</td>
                                    <td><code>75668C1F-73B5-4CF0-BB93-3ECF5CB7CC84</code></td>
                                    <td><span class="badge badge-danger">Block</span></td>
                                </tr>
                                <tr>
                                    <td>Block Win32 API calls from Office macros</td>
                                    <td><code>92E97FA1-2EDF-4476-BDD6-9DD0B4DDDC7B</code></td>
                                    <td><span class="badge badge-warning">Audit</span></td>
                                </tr>
                                <tr>
                                    <td>Block Office communication apps child processes</td>
                                    <td><code>26190899-1602-49E8-8B27-EB1D0A1CE869</code></td>
                                    <td><span class="badge badge-warning">Audit</span></td>
                                </tr>
                                <tr>
                                    <td>Block obfuscated scripts</td>
                                    <td><code>5BEB7EFE-FD9A-4556-801D-275E5FFC04CC</code></td>
                                    <td><span class="badge badge-danger">Block</span></td>
                                </tr>
                                <tr>
                                    <td>Block JS/VBS launching downloaded executables</td>
                                    <td><code>D3E037E1-3EB8-44C8-A917-57927947596D</code></td>
                                    <td><span class="badge badge-danger">Block</span></td>
                                </tr>
                                <tr>
                                    <td>Block PSExec and WMI process creation</td>
                                    <td><code>D1E49AAC-8F56-4280-B9BA-993A6D77406C</code></td>
                                    <td><span class="badge badge-warning">Audit</span></td>
                                </tr>
                                <tr>
                                    <td>Block unsigned processes from USB</td>
                                    <td><code>B2B3F03D-6A65-4F7B-A9C7-1C7EF74A9BA4</code></td>
                                    <td><span class="badge badge-danger">Block</span></td>
                                </tr>
                                <tr>
                                    <td>Block low-prevalence executables</td>
                                    <td><code>01443614-CD74-433A-B99E-2ECDC07BFC25</code></td>
                                    <td><span class="badge badge-warning">Audit</span></td>
                                </tr>
                                <tr>
                                    <td>Advanced ransomware protection</td>
                                    <td><code>C1DB55AB-C21A-4637-BB3F-A12568109D35</code></td>
                                    <td><span class="badge badge-danger">Block</span></td>
                                </tr>
                                <tr>
                                    <td>Block credential stealing from LSASS</td>
                                    <td><code>9E6C4E1F-7D60-472F-BA1A-A39EF669E4B2</code></td>
                                    <td><span class="badge badge-danger">Block</span></td>
                                </tr>
                                <tr>
                                    <td>Block WMI persistence</td>
                                    <td><code>E6DB77E5-3DF2-4CF1-B95A-636979351E5B</code></td>
                                    <td><span class="badge badge-warning">Audit</span></td>
                                </tr>
                                <tr>
                                    <td>Block vulnerable signed drivers</td>
                                    <td><code>56A863A9-875E-4185-98A7-B882C64B5CE5</code></td>
                                    <td><span class="badge badge-danger">Block</span></td>
                                </tr>
                                <tr>
                                    <td>Block Adobe Reader child processes</td>
                                    <td><code>7674BA52-37EB-4A4F-A9A1-F0F9A1619A2C</code></td>
                                    <td><span class="badge badge-danger">Block</span></td>
                                </tr>
                                <tr>
                                    <td>Block Webshell creation</td>
                                    <td><code>A8F5898E-1DC8-49A9-9878-85004B8A61E6</code></td>
                                    <td><span class="badge badge-danger">Block</span></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </section>

                <!-- Exclusions -->
                <section id="exclusions">
                    <h2>Managing Exclusions</h2>
                    
                    <div class="card">
                        <div class="card-body">
                            <p>
                                ASR exclusions allow specific files, folders, or processes to bypass certain rules. 
                                Exclusions should be used sparingly and only when necessary.
                            </p>
                        </div>
                    </div>

                    <h3>Exclusion Types</h3>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>Type</th>
                                    <th>Format</th>
                                    <th>Example</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>File Path</strong></td>
                                    <td>Full path to file</td>
                                    <td><code>C:\Program Files\App\app.exe</code></td>
                                </tr>
                                <tr>
                                    <td><strong>Folder Path</strong></td>
                                    <td>Path with trailing backslash</td>
                                    <td><code>C:\Program Files\App\</code></td>
                                </tr>
                                <tr>
                                    <td><strong>Process</strong></td>
                                    <td>Full path to process</td>
                                    <td><code>C:\Windows\System32\cmd.exe</code></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <h3>PowerShell Exclusion Management</h3>
                    <div class="code-block">
                        <div class="code-header">
                            <span class="code-lang">PowerShell</span>
                            <button class="code-copy">Copy</button>
                        </div>
                        <pre><code># Add ASR exclusion
Add-MpPreference -AttackSurfaceReductionOnlyExclusions "C:\CustomApp\app.exe"

# Add folder exclusion
Add-MpPreference -AttackSurfaceReductionOnlyExclusions "C:\CustomApp\"

# View current exclusions
Get-MpPreference | Select-Object -ExpandProperty AttackSurfaceReductionOnlyExclusions

# Remove exclusion
Remove-MpPreference -AttackSurfaceReductionOnlyExclusions "C:\CustomApp\app.exe"</code></pre>
                    </div>

                    <div class="alert alert-warning">
                        <div class="alert-icon">âš ï¸</div>
                        <div class="alert-content">
                            <div class="alert-title">Exclusion Best Practices</div>
                            <ul>
                                <li>Document all exclusions with business justification</li>
                                <li>Prefer specific file paths over folder exclusions</li>
                                <li>Review exclusions quarterly for necessity</li>
                                <li>Never exclude entire drives or large directory trees</li>
                                <li>Test in audit mode before adding exclusions</li>
                            </ul>
                        </div>
                    </div>
                </section>

                <!-- Monitoring -->
                <section id="monitoring">
                    <h2>Monitoring & Reporting</h2>
                    
                    <h3>Portal Location</h3>
                    <div class="code-block">
                        <div class="code-header">
                            <span class="code-lang">Navigation</span>
                            <button class="code-copy">Copy</button>
                        </div>
                        <pre><code>security.microsoft.com â†’ Reports â†’ Attack Surface Reduction Rules

- View block/audit events by rule
- Identify top triggered rules  
- See affected devices and users
- Export for analysis</code></pre>
                    </div>

                    <h3>KQL Query for ASR Events</h3>
                    <div class="code-block">
                        <div class="code-header">
                            <span class="code-lang">KQL</span>
                            <button class="code-copy">Copy</button>
                        </div>
                        <pre><code>// ASR Events from DeviceEvents table
DeviceEvents
| where Timestamp > ago(7d)
| where ActionType startswith "Asr"
| summarize EventCount=count() by ActionType, DeviceName
| order by EventCount desc

// Detailed ASR audit events
DeviceEvents
| where Timestamp > ago(24h)
| where ActionType contains "AsrOfficeChildProcess"
| project Timestamp, DeviceName, ActionType, FileName, 
          InitiatingProcessFileName, InitiatingProcessCommandLine
| order by Timestamp desc</code></pre>
                    </div>
                </section>

                <!-- Rollout Strategy -->
                <section id="rollout">
                    <h2>Rollout Strategy</h2>
                    
                    <div class="diagram-container">
                        <div class="diagram-title">ASR Rollout Phases</div>
                        <pre style="font-family: var(--font-mono); font-size: 0.75rem; line-height: 1.3; color: var(--text-secondary);">
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        ASR ROLLOUT STRATEGY                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚   PHASE 1: AUDIT (Weeks 1-4)                                            â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚  â€¢ Enable ALL rules in Audit mode                                â”‚  â”‚
â”‚   â”‚  â€¢ Deploy to pilot group (IT, Security team)                    â”‚  â”‚
â”‚   â”‚  â€¢ Monitor ASR reports daily                                    â”‚  â”‚
â”‚   â”‚  â€¢ Document legitimate triggers                                  â”‚  â”‚
â”‚   â”‚  â€¢ Create initial exclusion list                                â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                              â–¼                                          â”‚
â”‚   PHASE 2: BLOCK LOW-RISK (Weeks 5-6)                                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚  â€¢ Enable Block mode for low-impact rules:                       â”‚  â”‚
â”‚   â”‚    - Email executable content                                    â”‚  â”‚
â”‚   â”‚    - Office creating executables                                â”‚  â”‚
â”‚   â”‚    - Office injecting code                                      â”‚  â”‚
â”‚   â”‚    - Ransomware protection                                      â”‚  â”‚
â”‚   â”‚    - Adobe Reader child processes                               â”‚  â”‚
â”‚   â”‚  â€¢ Continue monitoring audit events for remaining rules         â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                              â–¼                                          â”‚
â”‚   PHASE 3: EXPAND BLOCKING (Weeks 7-10)                                â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚  â€¢ Enable Block for medium-impact rules:                        â”‚  â”‚
â”‚   â”‚    - Obfuscated scripts                                         â”‚  â”‚
â”‚   â”‚    - JS/VBS launching executables                               â”‚  â”‚
â”‚   â”‚    - USB unsigned processes                                     â”‚  â”‚
â”‚   â”‚    - LSASS credential stealing                                  â”‚  â”‚
â”‚   â”‚  â€¢ Apply exclusions from Phase 1/2 analysis                     â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                              â–¼                                          â”‚
â”‚   PHASE 4: HIGH-IMPACT RULES (Weeks 11+)                               â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚  â€¢ Carefully enable remaining rules:                             â”‚  â”‚
â”‚   â”‚    - Office child processes (with exclusions)                   â”‚  â”‚
â”‚   â”‚    - Win32 API from macros (with exclusions)                    â”‚  â”‚
â”‚   â”‚    - PSExec/WMI (with IT tool exclusions)                       â”‚  â”‚
â”‚   â”‚    - Low-prevalence executables (with dev exclusions)           â”‚  â”‚
â”‚   â”‚  â€¢ Document all exclusions with business owner approval         â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        </pre>
                    </div>
                </section>

                <!-- Navigation -->
                <div class="flex-between mt-4">
                    <a href="features.html" class="btn btn-secondary">â† Features</a>
                    <a href="analyst-engineer.html" class="btn btn-primary">Analyst vs Engineer â†’</a>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-content">
            <p class="footer-text">MDE Ultimate Guide | For Security Analysts & Engineers</p>
        </div>
    </footer>

    <script src="js/main.js"></script>
</body>
</html>
