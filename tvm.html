<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Threat & Vulnerability Management - MDE Ultimate Guide</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <nav class="navbar">
        <div class="navbar-container">
            <a href="index.html" class="navbar-brand"><span class="brand-icon">ğŸ›¡ï¸</span><span>MDE Ultimate Guide</span></a>
            <button class="navbar-toggle">â˜°</button>
            <ul class="navbar-nav">
                <li class="nav-item"><a href="index.html" class="nav-link">Home</a></li>
                <li class="nav-item"><a href="architecture.html" class="nav-link">Architecture</a></li>
                <li class="nav-item"><a href="deployment.html" class="nav-link">Deployment</a></li>
                <li class="nav-item"><a href="features.html" class="nav-link">Features</a></li>
                <li class="nav-item"><a href="tvm.html" class="nav-link active">TVM</a></li>
                <li class="nav-item"><a href="asr-rules.html" class="nav-link">ASR Rules</a></li>
                <li class="nav-item"><a href="analyst-engineer.html" class="nav-link">Analyst vs Engineer</a></li>
                <li class="nav-item"><a href="troubleshooting.html" class="nav-link">Troubleshooting</a></li>
                <li class="nav-item"><a href="licensing.html" class="nav-link">Licensing & Comparison</a></li>
                <li class="nav-item"><a href="kql-rules.html" class="nav-link">KQL Rules</a></li>
                <li class="nav-item"><a href="use-cases.html" class="nav-link">Use Cases</a></li>
                <li class="nav-item"><a href="automation.html" class="nav-link">Automation</a></li>
                <li class="nav-item"><a href="best-practices.html" class="nav-link">Best Practices</a></li>
            </ul>
        </div>
    </nav>

    <main class="main-container">
        <div class="content-wrapper">
            <aside class="sidebar">
                <nav class="sidebar-nav">
                    <div class="sidebar-title">On This Page</div>
                    <ul class="sidebar-links">
                        <li><a href="#overview">Overview</a></li>
                        <li><a href="#dashboard">TVM Dashboard</a></li>
                        <li><a href="#exposure-score">Exposure Score</a></li>
                        <li><a href="#secure-score">Secure Score for Devices</a></li>
                        <li><a href="#recommendations">Security Recommendations</a></li>
                        <li><a href="#software-inventory">Software Inventory</a></li>
                        <li><a href="#vulnerabilities">Vulnerabilities (CVEs)</a></li>
                        <li><a href="#weaknesses">Weaknesses</a></li>
                        <li><a href="#baselines">Security Baselines</a></li>
                        <li><a href="#remediation">Remediation Workflow</a></li>
                        <li><a href="#automation">TVM Automation</a></li>
                        <li><a href="#export-reports">Export & Reports</a></li>
                        <li><a href="#kql-queries">TVM KQL Queries</a></li>
                        <li><a href="#api">TVM API Operations</a></li>
                    </ul>
                </nav>
            </aside>

            <div class="content">
                <h1>ğŸ“Š Threat & Vulnerability Management (TVM)</h1>
                <p class="section-desc">Comprehensive guide to MDE's Threat and Vulnerability Management - discover, prioritize, and remediate vulnerabilities across your endpoints.</p>

                <section id="overview">
                    <h2>TVM Overview</h2>
                    
                    <div class="card">
                        <div class="card-body">
                            <p>Threat and Vulnerability Management (TVM) is MDE's built-in vulnerability assessment and management solution. It provides real-time visibility into software vulnerabilities, misconfigurations, and security weaknesses across all onboarded endpoints without requiring additional agents or scans.</p>
                        </div>
                    </div>

                    <div class="diagram-container">
                        <div class="diagram-title">TVM End-to-End Workflow</div>
                        <pre style="font-family: var(--font-mono); font-size: 0.7rem; line-height: 1.2; color: var(--text-secondary);">
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        TVM END-TO-END WORKFLOW                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚   â”‚  DISCOVER   â”‚â”€â”€â”€â–ºâ”‚ PRIORITIZE  â”‚â”€â”€â”€â–ºâ”‚  REMEDIATE  â”‚â”€â”€â”€â–ºâ”‚   VERIFY    â”‚     â”‚
â”‚   â”‚             â”‚    â”‚             â”‚    â”‚             â”‚    â”‚             â”‚     â”‚
â”‚   â”‚â€¢ Software   â”‚    â”‚â€¢ Exposure   â”‚    â”‚â€¢ Intune     â”‚    â”‚â€¢ Rescan     â”‚     â”‚
â”‚   â”‚  Inventory  â”‚    â”‚  Score      â”‚    â”‚  Tasks      â”‚    â”‚â€¢ Validate   â”‚     â”‚
â”‚   â”‚â€¢ CVEs       â”‚    â”‚â€¢ CVSS +     â”‚    â”‚â€¢ ServiceNow â”‚    â”‚  Fix        â”‚     â”‚
â”‚   â”‚â€¢ Misconfig  â”‚    â”‚  Exploits   â”‚    â”‚â€¢ Manual     â”‚    â”‚â€¢ Track      â”‚     â”‚
â”‚   â”‚â€¢ Weaknesses â”‚    â”‚â€¢ Business   â”‚    â”‚  Tickets    â”‚    â”‚  Progress   â”‚     â”‚
â”‚   â”‚             â”‚    â”‚  Context    â”‚    â”‚             â”‚    â”‚             â”‚     â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚         â”‚                  â”‚                  â”‚                  â”‚              â”‚
â”‚         â–¼                  â–¼                  â–¼                  â–¼              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚                         TVM DASHBOARD                                    â”‚  â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚
â”‚   â”‚  â”‚  Exposure    â”‚ â”‚ Secure Score â”‚ â”‚   Top        â”‚ â”‚  Remediation â”‚   â”‚  â”‚
â”‚   â”‚  â”‚  Score: 45   â”‚ â”‚  Devices: 72 â”‚ â”‚   Recommend  â”‚ â”‚  Activities  â”‚   â”‚  â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                                  â”‚
â”‚   DATA SOURCES (Continuous - No Scans Required)                                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚  MDE Sensor â†’ Software Inventory â†’ CVE Correlation â†’ Risk Calculation   â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        </pre>
                    </div>

                    <h3>TVM Key Capabilities</h3>
                    <div class="table-container">
                        <table>
                            <thead><tr><th>Capability</th><th>Description</th><th>License</th></tr></thead>
                            <tbody>
                                <tr><td><strong>Software Inventory</strong></td><td>Real-time inventory of all installed software</td><td>P1/P2</td></tr>
                                <tr><td><strong>Vulnerability Assessment</strong></td><td>CVE detection without additional scans</td><td>P1 (Basic) / P2 (Full)</td></tr>
                                <tr><td><strong>Security Recommendations</strong></td><td>Prioritized remediation guidance</td><td>P2</td></tr>
                                <tr><td><strong>Exposure Score</strong></td><td>Organization-wide risk metric</td><td>P2</td></tr>
                                <tr><td><strong>Secure Score for Devices</strong></td><td>Security configuration scoring</td><td>P2</td></tr>
                                <tr><td><strong>Security Baselines</strong></td><td>Configuration compliance assessment</td><td>P2</td></tr>
                                <tr><td><strong>Remediation Tracking</strong></td><td>Intune/SCCM integration for patching</td><td>P2</td></tr>
                                <tr><td><strong>Block Vulnerable Apps</strong></td><td>Prevent execution of vulnerable software</td><td>P2</td></tr>
                            </tbody>
                        </table>
                    </div>
                </section>

                <section id="dashboard">
                    <h2>TVM Dashboard</h2>
                    
                    <div class="diagram-container">
                        <div class="diagram-title">TVM Dashboard Layout</div>
                        <pre style="font-family: var(--font-mono); font-size: 0.7rem; line-height: 1.2; color: var(--text-secondary);">
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  security.microsoft.com â†’ Endpoints â†’ Vulnerability Management â†’ Dashboard      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚      EXPOSURE SCORE            â”‚  â”‚     SECURE SCORE FOR DEVICES          â”‚â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚â”‚
â”‚  â”‚  â”‚                          â”‚  â”‚  â”‚  â”‚                                  â”‚ â”‚â”‚
â”‚  â”‚  â”‚         45/100           â”‚  â”‚  â”‚  â”‚          72/100                  â”‚ â”‚â”‚
â”‚  â”‚  â”‚      (Lower = Better)    â”‚  â”‚  â”‚  â”‚       (Higher = Better)          â”‚ â”‚â”‚
â”‚  â”‚  â”‚                          â”‚  â”‚  â”‚  â”‚                                  â”‚ â”‚â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚â”‚
â”‚  â”‚  â–¼ -3 from last week           â”‚  â”‚  â–² +5 from last week                  â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚                    TOP SECURITY RECOMMENDATIONS                            â”‚â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚â”‚
â”‚  â”‚  â”‚ 1. Update Google Chrome (CVE-2024-XXXX) - 2,450 devices - Critical   â”‚ â”‚â”‚
â”‚  â”‚  â”‚ 2. Enable BitLocker on OS drives - 1,890 devices - High              â”‚ â”‚â”‚
â”‚  â”‚  â”‚ 3. Update Adobe Reader (CVE-2024-YYYY) - 1,245 devices - High        â”‚ â”‚â”‚
â”‚  â”‚  â”‚ 4. Disable SMBv1 protocol - 890 devices - High                       â”‚ â”‚â”‚
â”‚  â”‚  â”‚ 5. Update Microsoft Edge - 756 devices - Medium                      â”‚ â”‚â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚    EXPOSED DEVICES              â”‚  â”‚     REMEDIATION ACTIVITIES           â”‚â”‚
â”‚  â”‚    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€             â”‚  â”‚     â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€              â”‚â”‚
â”‚  â”‚    Critical: 245                â”‚  â”‚     In Progress: 12                  â”‚â”‚
â”‚  â”‚    High: 1,890                  â”‚  â”‚     Completed: 45                    â”‚â”‚
â”‚  â”‚    Medium: 4,567                â”‚  â”‚     Pending: 8                       â”‚â”‚
â”‚  â”‚    Low: 8,234                   â”‚  â”‚     Overdue: 3                       â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        </pre>
                    </div>

                    <h3>Portal Navigation</h3>
                    <div class="code-block">
                        <div class="code-header"><span class="code-lang">Portal Navigation Paths</span></div>
                        <pre><code>security.microsoft.com
â”‚
â”œâ”€â”€ Endpoints
â”‚   â””â”€â”€ Vulnerability Management
â”‚       â”œâ”€â”€ Dashboard              # Main TVM overview
â”‚       â”œâ”€â”€ Recommendations        # Security recommendations list
â”‚       â”œâ”€â”€ Remediation            # Remediation activities tracker
â”‚       â”œâ”€â”€ Software inventory     # All software across endpoints
â”‚       â”œâ”€â”€ Weaknesses             # CVE database with affected devices
â”‚       â”œâ”€â”€ Event timeline         # TVM-related events
â”‚       â””â”€â”€ Baselines assessment   # Security baseline compliance
â”‚
â”œâ”€â”€ Reports
â”‚   â””â”€â”€ Vulnerabilities            # TVM reports and exports
â”‚
â””â”€â”€ Settings
    â””â”€â”€ Endpoints
        â””â”€â”€ Advanced features
            â””â”€â”€ Microsoft Intune connection  # Enable remediation integration</code></pre>
                    </div>
                </section>

                <section id="exposure-score">
                    <h2>Exposure Score</h2>
                    
                    <div class="card">
                        <div class="card-body">
                            <p>The <strong>Exposure Score</strong> (0-100) reflects your organization's collective vulnerability exposure. <strong>Lower is better.</strong> It's calculated based on vulnerability severity, exploit availability, and number of affected devices.</p>
                        </div>
                    </div>

                    <h3>Exposure Score Components</h3>
                    <div class="table-container">
                        <table>
                            <thead><tr><th>Factor</th><th>Weight</th><th>Description</th></tr></thead>
                            <tbody>
                                <tr><td><strong>Vulnerability Severity</strong></td><td>High</td><td>CVSS score of vulnerabilities</td></tr>
                                <tr><td><strong>Exploit Availability</strong></td><td>High</td><td>Public exploits, active exploitation</td></tr>
                                <tr><td><strong>Affected Devices</strong></td><td>Medium</td><td>Number/percentage of devices affected</td></tr>
                                <tr><td><strong>Asset Value</strong></td><td>Medium</td><td>Criticality of affected systems</td></tr>
                                <tr><td><strong>Threat Intelligence</strong></td><td>High</td><td>Active threat campaigns targeting vulnerability</td></tr>
                            </tbody>
                        </table>
                    </div>

                    <h3>Exposure Score Breakdown</h3>
                    <div class="code-block">
                        <div class="code-header"><span class="code-lang">Score Interpretation</span></div>
                        <pre><code>Exposure Score Ranges:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
0-29    â”‚ LOW       â”‚ Minimal exposure, well-managed
30-49   â”‚ MEDIUM    â”‚ Moderate risk, prioritize remediation  
50-69   â”‚ HIGH      â”‚ Significant exposure, urgent attention needed
70-100  â”‚ CRITICAL  â”‚ Severe exposure, immediate action required
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Score Reduction Strategies:
â€¢ Patch critical/high CVEs with exploits available
â€¢ Address vulnerabilities on high-value assets first
â€¢ Focus on recommendations with highest score impact</code></pre>
                    </div>
                </section>

                <section id="secure-score">
                    <h2>Secure Score for Devices</h2>
                    
                    <div class="card">
                        <div class="card-body">
                            <p><strong>Secure Score for Devices</strong> (0-100) measures how well your devices are configured against security best practices. <strong>Higher is better.</strong> It evaluates OS configurations, security features, and compliance with security baselines.</p>
                        </div>
                    </div>

                    <h3>Secure Score Categories</h3>
                    <div class="table-container">
                        <table>
                            <thead><tr><th>Category</th><th>Examples</th></tr></thead>
                            <tbody>
                                <tr><td><strong>Application</strong></td><td>Office macro settings, browser security, app updates</td></tr>
                                <tr><td><strong>Operating System</strong></td><td>Windows updates, feature configuration, services</td></tr>
                                <tr><td><strong>Network</strong></td><td>Firewall, SMB settings, network protection</td></tr>
                                <tr><td><strong>Accounts</strong></td><td>Password policies, admin accounts, guest accounts</td></tr>
                                <tr><td><strong>Security Controls</strong></td><td>BitLocker, Credential Guard, ASR rules, tamper protection</td></tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="alert alert-info">
                        <div class="alert-icon">ğŸ’¡</div>
                        <div class="alert-content">
                            <div class="alert-title">Score Improvement</div>
                            <p>Each security recommendation shows potential score impact. Focus on recommendations with "High" score improvement for fastest results.</p>
                        </div>
                    </div>
                </section>

                <section id="recommendations">
                    <h2>Security Recommendations</h2>
                    
                    <div class="diagram-container">
                        <div class="diagram-title">Security Recommendations Workflow</div>
                        <pre style="font-family: var(--font-mono); font-size: 0.7rem; line-height: 1.2; color: var(--text-secondary);">
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    SECURITY RECOMMENDATIONS WORKFLOW                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                  â”‚
â”‚   VIEW RECOMMENDATIONS                                                           â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚ Filter by: Category | Severity | Status | Related Component             â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                       â”‚                                         â”‚
â”‚                                       â–¼                                         â”‚
â”‚   SELECT RECOMMENDATION                                                          â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚ â€¢ Description: What needs to be fixed                                   â”‚  â”‚
â”‚   â”‚ â€¢ Exposed devices: List of affected endpoints                           â”‚  â”‚
â”‚   â”‚ â€¢ Related CVEs: Associated vulnerabilities                              â”‚  â”‚
â”‚   â”‚ â€¢ Score impact: Exposure/Secure score improvement                       â”‚  â”‚
â”‚   â”‚ â€¢ Remediation options: How to fix                                       â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                       â”‚                                         â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
â”‚                    â–¼                  â–¼                  â–¼                     â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚   â”‚  REQUEST         â”‚  â”‚  CREATE TICKET   â”‚  â”‚  EXCEPTION       â”‚            â”‚
â”‚   â”‚  REMEDIATION     â”‚  â”‚  (ServiceNow)    â”‚  â”‚  REQUEST         â”‚            â”‚
â”‚   â”‚                  â”‚  â”‚                  â”‚  â”‚                  â”‚            â”‚
â”‚   â”‚ â†’ Intune Task    â”‚  â”‚ â†’ Manual ITSM    â”‚  â”‚ â†’ Risk Accept    â”‚            â”‚
â”‚   â”‚ â†’ SCCM Task      â”‚  â”‚   Integration    â”‚  â”‚ â†’ Business Just  â”‚            â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                                       â”‚                                         â”‚
â”‚                                       â–¼                                         â”‚
â”‚   TRACK REMEDIATION                                                              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚ Status: In Progress | Completed | Failed | Pending                      â”‚  â”‚
â”‚   â”‚ Devices Remediated: 450/500 (90%)                                       â”‚  â”‚
â”‚   â”‚ Due Date: 2024-03-15                                                    â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        </pre>
                    </div>

                    <h3>Recommendation Types</h3>
                    <div class="table-container">
                        <table>
                            <thead><tr><th>Type</th><th>Examples</th><th>Remediation</th></tr></thead>
                            <tbody>
                                <tr>
                                    <td><strong>Software Updates</strong></td>
                                    <td>Update Chrome, Adobe Reader, Java</td>
                                    <td>Intune/SCCM deployment</td>
                                </tr>
                                <tr>
                                    <td><strong>OS Configuration</strong></td>
                                    <td>Enable BitLocker, disable SMBv1</td>
                                    <td>GPO/Intune policy</td>
                                </tr>
                                <tr>
                                    <td><strong>Security Features</strong></td>
                                    <td>Enable Credential Guard, ASR rules</td>
                                    <td>Intune security baseline</td>
                                </tr>
                                <tr>
                                    <td><strong>Zero-Day</strong></td>
                                    <td>Mitigate actively exploited CVEs</td>
                                    <td>Workaround/emergency patch</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </section>

                <section id="software-inventory">
                    <h2>Software Inventory</h2>
                    
                    <div class="card">
                        <div class="card-body">
                            <p>TVM automatically discovers and inventories all software installed across your endpoints. No agents or scans required - data comes from the MDE sensor.</p>
                        </div>
                    </div>

                    <h3>Software Inventory Data</h3>
                    <div class="table-container">
                        <table>
                            <thead><tr><th>Field</th><th>Description</th></tr></thead>
                            <tbody>
                                <tr><td><strong>Software Name</strong></td><td>Application name (e.g., Google Chrome)</td></tr>
                                <tr><td><strong>Vendor</strong></td><td>Software publisher</td></tr>
                                <tr><td><strong>Version</strong></td><td>Installed version number</td></tr>
                                <tr><td><strong>Weaknesses</strong></td><td>Number of CVEs affecting this software</td></tr>
                                <tr><td><strong>Threats</strong></td><td>Active threats targeting this software</td></tr>
                                <tr><td><strong>Exposed Devices</strong></td><td>Number of devices with this software</td></tr>
                                <tr><td><strong>Install Date</strong></td><td>When software was installed</td></tr>
                            </tbody>
                        </table>
                    </div>

                    <h3>Software Inventory Actions</h3>
                    <div class="code-block">
                        <div class="code-header"><span class="code-lang">Available Actions</span></div>
                        <pre><code>From Software Inventory page, you can:

1. VIEW DETAILS
   â€¢ See all versions installed across organization
   â€¢ View devices with each version
   â€¢ See related CVEs and recommendations

2. OPEN SOFTWARE PAGE
   â€¢ Detailed vulnerability information
   â€¢ Version distribution chart
   â€¢ Affected devices list

3. BLOCK VULNERABLE VERSIONS (P2 Feature)
   â€¢ Prevent execution of vulnerable software
   â€¢ Creates custom indicator to block

4. EXPORT TO CSV
   â€¢ Export full inventory for reporting
   â€¢ Include all fields or selected columns

5. REQUEST REMEDIATION
   â€¢ Create Intune task to update/remove software
   â€¢ Track remediation progress</code></pre>
                    </div>
                </section>

                <section id="vulnerabilities">
                    <h2>Vulnerabilities (CVEs)</h2>
                    
                    <div class="diagram-container">
                        <div class="diagram-title">CVE Detail View</div>
                        <pre style="font-family: var(--font-mono); font-size: 0.7rem; line-height: 1.2; color: var(--text-secondary);">
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  CVE-2024-12345 - Google Chrome Remote Code Execution                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                  â”‚
â”‚  SEVERITY: Critical    CVSS: 9.8    EXPLOIT: Available    ZERO-DAY: Yes         â”‚
â”‚                                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ DESCRIPTION                                                              â”‚   â”‚
â”‚  â”‚ A remote code execution vulnerability exists in Google Chrome versions  â”‚   â”‚
â”‚  â”‚ prior to 120.0.6099.130 when processing specially crafted HTML...       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ EXPOSED DEVICES      â”‚  â”‚ AFFECTED SOFTWARE    â”‚  â”‚ THREAT CONTEXT       â”‚ â”‚
â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€       â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€       â”‚ â”‚
â”‚  â”‚ Total: 2,450         â”‚  â”‚ Google Chrome        â”‚  â”‚ â€¢ Active exploit     â”‚ â”‚
â”‚  â”‚ Critical Assets: 45  â”‚  â”‚ < 120.0.6099.130     â”‚  â”‚ â€¢ Used by APT groups â”‚ â”‚
â”‚  â”‚ Servers: 12          â”‚  â”‚                      â”‚  â”‚ â€¢ Ransomware vector  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                                  â”‚
â”‚  REMEDIATION: Update Google Chrome to version 120.0.6099.130 or later          â”‚
â”‚  [Request Remediation]  [View Exposed Devices]  [Export CSV]                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        </pre>
                    </div>

                    <h3>CVE Prioritization Factors</h3>
                    <div class="table-container">
                        <table>
                            <thead><tr><th>Factor</th><th>Impact on Priority</th></tr></thead>
                            <tbody>
                                <tr><td><strong>CVSS Score</strong></td><td>Base severity (0-10 scale)</td></tr>
                                <tr><td><strong>Exploit Available</strong></td><td>Public exploit code exists</td></tr>
                                <tr><td><strong>Active Exploitation</strong></td><td>Being exploited in the wild</td></tr>
                                <tr><td><strong>Affected Devices</strong></td><td>Number of exposed endpoints</td></tr>
                                <tr><td><strong>Asset Criticality</strong></td><td>High-value targets affected</td></tr>
                                <tr><td><strong>Threat Intelligence</strong></td><td>Associated with threat actors</td></tr>
                            </tbody>
                        </table>
                    </div>
                </section>

                <section id="weaknesses">
                    <h2>Weaknesses Page</h2>
                    
                    <div class="card">
                        <div class="card-body">
                            <p>The <strong>Weaknesses</strong> page provides a searchable database of all CVEs detected across your organization, with filtering and export capabilities.</p>
                        </div>
                    </div>

                    <h3>Weaknesses Filters</h3>
                    <div class="code-block">
                        <div class="code-header"><span class="code-lang">Available Filters</span></div>
                        <pre><code>Filter Options:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Severity        â”‚ Critical, High, Medium, Low
Exploit         â”‚ Exploit available, No exploit
Status          â”‚ Active, Resolved
Age             â”‚ Last 30 days, Last 90 days, All time
Software        â”‚ Filter by specific application
Threat          â”‚ Zero-day, Active threat, Ransomware
Affected Devicesâ”‚ Range: 1-10, 10-100, 100+
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Quick Filters (Top Bar):
â€¢ Zero-day vulnerabilities
â€¢ Actively exploited
â€¢ Public exploit available
â€¢ Critical severity</code></pre>
                    </div>
                </section>

                <section id="baselines">
                    <h2>Security Baselines Assessment</h2>
                    
                    <div class="card">
                        <div class="card-body">
                            <p>TVM compares your device configurations against Microsoft security baselines (CIS, STIG, Microsoft recommended settings) and shows compliance gaps.</p>
                        </div>
                    </div>

                    <h3>Available Baselines</h3>
                    <div class="table-container">
                        <table>
                            <thead><tr><th>Baseline</th><th>Description</th></tr></thead>
                            <tbody>
                                <tr><td><strong>Windows Security Baseline</strong></td><td>Microsoft recommended Windows settings</td></tr>
                                <tr><td><strong>Microsoft Edge Baseline</strong></td><td>Browser security configuration</td></tr>
                                <tr><td><strong>Microsoft Office Baseline</strong></td><td>Office application security</td></tr>
                                <tr><td><strong>Windows Server Baseline</strong></td><td>Server-specific configurations</td></tr>
                            </tbody>
                        </table>
                    </div>

                    <h3>Baseline Compliance View</h3>
                    <div class="code-block">
                        <div class="code-header"><span class="code-lang">Compliance Dashboard</span></div>
                        <pre><code>Windows 11 Security Baseline - Version 23H2
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Overall Compliance: 78%
Compliant Devices: 1,560 / 2,000
Non-Compliant Settings: 45

Top Non-Compliant Settings:
1. BitLocker not enabled on OS drive (440 devices)
2. Windows Defender SmartScreen disabled (312 devices)
3. Credential Guard not configured (289 devices)
4. Audit policy not configured (256 devices)
5. Network protection in audit mode (198 devices)

[View All Settings]  [Export Report]  [Create Remediation Task]</code></pre>
                    </div>
                </section>

                <section id="remediation">
                    <h2>Remediation Workflow</h2>
                    
                    <div class="diagram-container">
                        <div class="diagram-title">Remediation Request Flow</div>
                        <pre style="font-family: var(--font-mono); font-size: 0.7rem; line-height: 1.2; color: var(--text-secondary);">
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        REMEDIATION REQUEST WORKFLOW                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                  â”‚
â”‚   1. SELECT RECOMMENDATION                                                       â”‚
â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚      â”‚ "Update Google Chrome" - 2,450 devices affected                    â”‚    â”‚
â”‚      â”‚ [Request Remediation] button                                       â”‚    â”‚
â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                       â”‚                                         â”‚
â”‚                                       â–¼                                         â”‚
â”‚   2. CONFIGURE REMEDIATION REQUEST                                              â”‚
â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚      â”‚ Remediation Type: [Software Update â–¼]                              â”‚    â”‚
â”‚      â”‚ Target: [All Exposed Devices â–¼] or [Select Device Groups]          â”‚    â”‚
â”‚      â”‚ Priority: [High â–¼]                                                 â”‚    â”‚
â”‚      â”‚ Due Date: [2024-03-15]                                             â”‚    â”‚
â”‚      â”‚ Notes: "Critical security update per TVM recommendation"           â”‚    â”‚
â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                       â”‚                                         â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
â”‚                    â–¼                                      â–¼                     â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚   â”‚    INTUNE INTEGRATION       â”‚      â”‚    SERVICENOW / ITSM        â”‚        â”‚
â”‚   â”‚    (Automatic)              â”‚      â”‚    (Manual Ticket)          â”‚        â”‚
â”‚   â”‚                             â”‚      â”‚                             â”‚        â”‚
â”‚   â”‚ â€¢ Creates Intune app        â”‚      â”‚ â€¢ Creates ticket with       â”‚        â”‚
â”‚   â”‚   deployment                â”‚      â”‚   CVE details               â”‚        â”‚
â”‚   â”‚ â€¢ Targets device groups     â”‚      â”‚ â€¢ Assigns to IT team        â”‚        â”‚
â”‚   â”‚ â€¢ Tracks installation       â”‚      â”‚ â€¢ Manual tracking           â”‚        â”‚
â”‚   â”‚ â€¢ Reports back to TVM       â”‚      â”‚                             â”‚        â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                       â”‚                                         â”‚
â”‚                                       â–¼                                         â”‚
â”‚   3. TRACK PROGRESS                                                             â”‚
â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚      â”‚ Remediation Activities â†’ View all requests                         â”‚    â”‚
â”‚      â”‚ Status: In Progress | Completed | Failed                           â”‚    â”‚
â”‚      â”‚ Progress: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 65% (1,592/2,450 devices)          â”‚    â”‚
â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        </pre>
                    </div>

                    <h3>Enable Intune Integration</h3>
                    <div class="code-block">
                        <div class="code-header"><span class="code-lang">Configuration Steps</span></div>
                        <pre><code>To enable Intune remediation integration:

1. Navigate to: security.microsoft.com
2. Go to: Settings â†’ Endpoints â†’ Advanced features
3. Enable: "Microsoft Intune connection"
4. Confirm in Intune admin center

Requirements:
â€¢ Microsoft Intune license
â€¢ Devices enrolled in Intune
â€¢ Appropriate admin permissions
â€¢ Same Azure AD tenant for MDE and Intune

Once enabled, "Request remediation" creates Intune tasks automatically.</code></pre>
                    </div>
                </section>

                <section id="automation">
                    <h2>TVM Automation</h2>
                    
                    <h3>Automated Remediation Options</h3>
                    <div class="table-container">
                        <table>
                            <thead><tr><th>Method</th><th>Use Case</th><th>Configuration</th></tr></thead>
                            <tbody>
                                <tr>
                                    <td><strong>Intune Auto-Update</strong></td>
                                    <td>Keep apps automatically updated</td>
                                    <td>Intune app policies with auto-update</td>
                                </tr>
                                <tr>
                                    <td><strong>Windows Update for Business</strong></td>
                                    <td>OS and driver updates</td>
                                    <td>Update rings in Intune</td>
                                </tr>
                                <tr>
                                    <td><strong>Block Vulnerable Apps</strong></td>
                                    <td>Prevent execution of vulnerable software</td>
                                    <td>TVM â†’ Software â†’ Block vulnerable versions</td>
                                </tr>
                                <tr>
                                    <td><strong>Logic Apps / Power Automate</strong></td>
                                    <td>Custom automation workflows</td>
                                    <td>Triggered by TVM API</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <h3>Block Vulnerable Applications</h3>
                    <div class="code-block">
                        <div class="code-header"><span class="code-lang">Block Vulnerable App Steps</span></div>
                        <pre><code>To block a vulnerable application version:

1. Navigate to: Vulnerability Management â†’ Software inventory
2. Search for the vulnerable software
3. Click on the software name to open details
4. Click "Block vulnerable versions"
5. Select versions to block
6. Confirm action

This creates a custom indicator that:
â€¢ Blocks execution of the vulnerable software
â€¢ Generates alerts if execution is attempted
â€¢ Can be managed in Settings â†’ Indicators

Note: Ensure you have a remediation plan before blocking
to avoid business disruption.</code></pre>
                    </div>
                </section>

                <section id="export-reports">
                    <h2>Export & Reports</h2>
                    
                    <h3>Available Exports</h3>
                    <div class="table-container">
                        <table>
                            <thead><tr><th>Report</th><th>Location</th><th>Format</th></tr></thead>
                            <tbody>
                                <tr><td><strong>Software Inventory</strong></td><td>Software inventory page â†’ Export</td><td>CSV</td></tr>
                                <tr><td><strong>Vulnerabilities (CVEs)</strong></td><td>Weaknesses page â†’ Export</td><td>CSV</td></tr>
                                <tr><td><strong>Security Recommendations</strong></td><td>Recommendations page â†’ Export</td><td>CSV</td></tr>
                                <tr><td><strong>Exposed Devices per CVE</strong></td><td>CVE detail page â†’ Export devices</td><td>CSV</td></tr>
                                <tr><td><strong>Baseline Compliance</strong></td><td>Baselines assessment â†’ Export</td><td>CSV</td></tr>
                                <tr><td><strong>Remediation Status</strong></td><td>Remediation page â†’ Export</td><td>CSV</td></tr>
                            </tbody>
                        </table>
                    </div>

                    <h3>Export via Portal</h3>
                    <div class="code-block">
                        <div class="code-header"><span class="code-lang">Manual Export Steps</span></div>
                        <pre><code>Export Software Inventory:
1. Go to: Vulnerability Management â†’ Software inventory
2. Apply filters as needed (vendor, vulnerabilities, etc.)
3. Click "Export" button (top right)
4. Select columns to include
5. Download CSV file

Export Vulnerabilities:
1. Go to: Vulnerability Management â†’ Weaknesses
2. Filter by severity, exploit status, etc.
3. Click "Export"
4. Download CSV with CVE details

Export Recommendations:
1. Go to: Vulnerability Management â†’ Recommendations
2. Filter by category, severity, status
3. Click "Export"
4. Download CSV with remediation guidance

Note: Exports are limited to 200,000 rows via portal.
Use API for larger exports.</code></pre>
                    </div>

                    <h3>Scheduled Reports</h3>
                    <div class="code-block">
                        <div class="code-header"><span class="code-lang">Email Report Configuration</span></div>
                        <pre><code>To create scheduled TVM reports:

1. Go to: Reports â†’ Vulnerabilities
2. Select report type (Summary, Detailed)
3. Click "Schedule report"
4. Configure:
   â€¢ Frequency: Daily, Weekly, Monthly
   â€¢ Recipients: Email addresses
   â€¢ Format: PDF or CSV
5. Save schedule

Available Scheduled Reports:
â€¢ Vulnerability summary by severity
â€¢ Top recommendations
â€¢ Exposure score trend
â€¢ Remediation progress
â€¢ Software inventory changes</code></pre>
                    </div>
                </section>

                <section id="kql-queries">
                    <h2>TVM KQL Queries</h2>
                    
                    <h3>Get All Vulnerabilities</h3>
                    <div class="code-block">
                        <div class="code-header"><span class="code-lang">KQL</span><button class="code-copy">Copy</button></div>
                        <pre><code>// List all vulnerabilities with severity and device count
DeviceTvmSoftwareVulnerabilities
| summarize AffectedDevices = dcount(DeviceId) by CveId, VulnerabilitySeverityLevel
| order by VulnerabilitySeverityLevel, AffectedDevices desc</code></pre>
                    </div>

                    <h3>Critical CVEs with Exploits</h3>
                    <div class="code-block">
                        <div class="code-header"><span class="code-lang">KQL</span><button class="code-copy">Copy</button></div>
                        <pre><code>// Critical vulnerabilities with public exploits
DeviceTvmSoftwareVulnerabilities
| where VulnerabilitySeverityLevel == "Critical"
| join kind=inner (
    DeviceTvmSoftwareVulnerabilitiesKB
    | where IsExploitAvailable == true
) on CveId
| summarize AffectedDevices = dcount(DeviceId), 
            Software = make_set(SoftwareName) by CveId
| order by AffectedDevices desc</code></pre>
                    </div>

                    <h3>Software Inventory Report</h3>
                    <div class="code-block">
                        <div class="code-header"><span class="code-lang">KQL</span><button class="code-copy">Copy</button></div>
                        <pre><code>// Software inventory with vulnerability counts
DeviceTvmSoftwareInventory
| summarize DeviceCount = dcount(DeviceId) by SoftwareName, SoftwareVendor, SoftwareVersion
| join kind=leftouter (
    DeviceTvmSoftwareVulnerabilities
    | summarize VulnCount = dcount(CveId) by SoftwareName, SoftwareVersion
) on SoftwareName, SoftwareVersion
| project SoftwareName, SoftwareVendor, SoftwareVersion, DeviceCount, 
          VulnCount = coalesce(VulnCount, 0)
| order by VulnCount desc, DeviceCount desc</code></pre>
                    </div>

                    <h3>Devices Missing Critical Patches</h3>
                    <div class="code-block">
                        <div class="code-header"><span class="code-lang">KQL</span><button class="code-copy">Copy</button></div>
                        <pre><code>// Devices with critical unpatched vulnerabilities
DeviceTvmSoftwareVulnerabilities
| where VulnerabilitySeverityLevel == "Critical"
| summarize CriticalCVEs = dcount(CveId), 
            CVEList = make_set(CveId, 10) by DeviceId, DeviceName
| where CriticalCVEs > 0
| order by CriticalCVEs desc
| take 100</code></pre>
                    </div>

                    <h3>Exposure Score Contributors</h3>
                    <div class="code-block">
                        <div class="code-header"><span class="code-lang">KQL</span><button class="code-copy">Copy</button></div>
                        <pre><code>// Top vulnerabilities contributing to exposure score
DeviceTvmSoftwareVulnerabilities
| join kind=inner (
    DeviceTvmSoftwareVulnerabilitiesKB
    | where IsExploitAvailable == true or IsZeroDay == true
) on CveId
| summarize AffectedDevices = dcount(DeviceId) by CveId, VulnerabilitySeverityLevel
| extend ScoreImpact = case(
    VulnerabilitySeverityLevel == "Critical", AffectedDevices * 10,
    VulnerabilitySeverityLevel == "High", AffectedDevices * 5,
    VulnerabilitySeverityLevel == "Medium", AffectedDevices * 2,
    AffectedDevices
)
| order by ScoreImpact desc
| take 20</code></pre>
                    </div>

                    <h3>Misconfiguration Report</h3>
                    <div class="code-block">
                        <div class="code-header"><span class="code-lang">KQL</span><button class="code-copy">Copy</button></div>
                        <pre><code>// Security misconfigurations across devices
DeviceTvmSecureConfigurationAssessment
| where IsCompliant == false
| summarize NonCompliantDevices = dcount(DeviceId) by ConfigurationId, ConfigurationName
| order by NonCompliantDevices desc
| take 20</code></pre>
                    </div>
                </section>

                <section id="api">
                    <h2>TVM API Operations</h2>
                    
                    <h3>API Endpoints</h3>
                    <div class="code-block">
                        <div class="code-header"><span class="code-lang">TVM API Endpoints</span></div>
                        <pre><code>Base URL: https://api.securitycenter.microsoft.com/api

Software Inventory:
GET /machines/{id}/software          # Software on specific device
GET /software                        # All software in organization

Vulnerabilities:
GET /vulnerabilities                 # All vulnerabilities
GET /machines/{id}/vulnerabilities   # Vulnerabilities on device
GET /software/{id}/vulnerabilities   # Vulnerabilities for software

Recommendations:
GET /recommendations                 # All recommendations
GET /recommendations/{id}            # Specific recommendation
GET /recommendations/{id}/machineReferences  # Affected devices

Remediation:
POST /remediationTasks               # Create remediation task
GET /remediationTasks                # List remediation tasks
GET /remediationTasks/{id}           # Task status</code></pre>
                    </div>

                    <h3>PowerShell: Export All Vulnerabilities</h3>
                    <div class="code-block">
                        <div class="code-header"><span class="code-lang">PowerShell</span><button class="code-copy">Copy</button></div>
                        <pre><code># Export all vulnerabilities to CSV via API
$tenantId = "your-tenant-id"
$clientId = "your-app-id"
$clientSecret = "your-secret"

# Get access token
$body = @{
    grant_type    = "client_credentials"
    client_id     = $clientId
    client_secret = $clientSecret
    scope         = "https://api.securitycenter.microsoft.com/.default"
}

$token = (Invoke-RestMethod -Uri "https://login.microsoftonline.com/$tenantId/oauth2/v2.0/token" `
    -Method POST -Body $body).access_token

$headers = @{ Authorization = "Bearer $token" }

# Get all vulnerabilities
$vulnerabilities = @()
$uri = "https://api.securitycenter.microsoft.com/api/vulnerabilities"

do {
    $response = Invoke-RestMethod -Uri $uri -Headers $headers
    $vulnerabilities += $response.value
    $uri = $response.'@odata.nextLink'
} while ($uri)

# Export to CSV
$vulnerabilities | Select-Object id, name, severity, exposedMachines, 
    publishedOn, updatedOn, exploitVerified | 
    Export-Csv -Path "TVM_Vulnerabilities_$(Get-Date -Format 'yyyyMMdd').csv" -NoTypeInformation

Write-Host "Exported $($vulnerabilities.Count) vulnerabilities"</code></pre>
                    </div>

                    <h3>PowerShell: Export Software Inventory</h3>
                    <div class="code-block">
                        <div class="code-header"><span class="code-lang">PowerShell</span><button class="code-copy">Copy</button></div>
                        <pre><code># Export software inventory via API
$uri = "https://api.securitycenter.microsoft.com/api/Software"
$software = @()

do {
    $response = Invoke-RestMethod -Uri $uri -Headers $headers
    $software += $response.value
    $uri = $response.'@odata.nextLink'
} while ($uri)

$software | Select-Object id, name, vendor, version, weaknesses, 
    exposedMachines, activeAlert | 
    Export-Csv -Path "TVM_Software_$(Get-Date -Format 'yyyyMMdd').csv" -NoTypeInformation

Write-Host "Exported $($software.Count) software items"</code></pre>
                    </div>

                    <h3>PowerShell: Get Recommendations</h3>
                    <div class="code-block">
                        <div class="code-header"><span class="code-lang">PowerShell</span><button class="code-copy">Copy</button></div>
                        <pre><code># Get security recommendations with affected device count
$uri = "https://api.securitycenter.microsoft.com/api/recommendations"
$recommendations = @()

do {
    $response = Invoke-RestMethod -Uri $uri -Headers $headers
    $recommendations += $response.value
    $uri = $response.'@odata.nextLink'
} while ($uri)

# Filter and export critical/high recommendations
$recommendations | 
    Where-Object { $_.severityScore -ge 7 } |
    Select-Object id, productName, recommendationName, severityScore, 
        exposedMachinesCount, recommendedProgram, remediationType |
    Export-Csv -Path "TVM_Recommendations_$(Get-Date -Format 'yyyyMMdd').csv" -NoTypeInformation

Write-Host "Exported $($recommendations.Count) recommendations"</code></pre>
                    </div>

                    <h3>Python: TVM Dashboard Report</h3>
                    <div class="code-block">
                        <div class="code-header"><span class="code-lang">Python</span><button class="code-copy">Copy</button></div>
                        <pre><code>import requests
import pandas as pd
from datetime import datetime

# Authentication (use MSAL in production)
def get_token(tenant_id, client_id, client_secret):
    url = f"https://login.microsoftonline.com/{tenant_id}/oauth2/v2.0/token"
    data = {
        "grant_type": "client_credentials",
        "client_id": client_id,
        "client_secret": client_secret,
        "scope": "https://api.securitycenter.microsoft.com/.default"
    }
    return requests.post(url, data=data).json()["access_token"]

def get_all_pages(url, headers):
    """Paginate through API results"""
    results = []
    while url:
        response = requests.get(url, headers=headers).json()
        results.extend(response.get("value", []))
        url = response.get("@odata.nextLink")
    return results

# Get data
token = get_token("tenant-id", "client-id", "secret")
headers = {"Authorization": f"Bearer {token}"}
base_url = "https://api.securitycenter.microsoft.com/api"

# Fetch TVM data
vulnerabilities = get_all_pages(f"{base_url}/vulnerabilities", headers)
software = get_all_pages(f"{base_url}/Software", headers)
recommendations = get_all_pages(f"{base_url}/recommendations", headers)

# Create summary report
report = {
    "Report Date": datetime.now().strftime("%Y-%m-%d"),
    "Total Vulnerabilities": len(vulnerabilities),
    "Critical CVEs": len([v for v in vulnerabilities if v.get("severity") == "Critical"]),
    "High CVEs": len([v for v in vulnerabilities if v.get("severity") == "High"]),
    "Exploitable CVEs": len([v for v in vulnerabilities if v.get("exploitVerified")]),
    "Total Software": len(software),
    "Vulnerable Software": len([s for s in software if s.get("weaknesses", 0) > 0]),
    "Open Recommendations": len([r for r in recommendations if r.get("status") == "Active"])
}

print("\n=== TVM DASHBOARD SUMMARY ===")
for key, value in report.items():
    print(f"{key}: {value}")

# Export detailed data
pd.DataFrame(vulnerabilities).to_csv(f"vulnerabilities_{datetime.now():%Y%m%d}.csv", index=False)
pd.DataFrame(software).to_csv(f"software_{datetime.now():%Y%m%d}.csv", index=False)
pd.DataFrame(recommendations).to_csv(f"recommendations_{datetime.now():%Y%m%d}.csv", index=False)</code></pre>
                    </div>

                    <h3>API Permissions Required</h3>
                    <div class="table-container">
                        <table>
                            <thead><tr><th>Operation</th><th>Permission</th></tr></thead>
                            <tbody>
                                <tr><td>Read vulnerabilities</td><td>Vulnerability.Read.All</td></tr>
                                <tr><td>Read software inventory</td><td>Software.Read.All</td></tr>
                                <tr><td>Read recommendations</td><td>SecurityRecommendation.Read.All</td></tr>
                                <tr><td>Create remediation tasks</td><td>RemediationTask.ReadWrite.All</td></tr>
                                <tr><td>Read device data</td><td>Machine.Read.All</td></tr>
                            </tbody>
                        </table>
                    </div>
                </section>

                <div class="alert alert-success">
                    <div class="alert-icon">âœ…</div>
                    <div class="alert-content">
                        <div class="alert-title">TVM Best Practices</div>
                        <ul>
                            <li>Review TVM dashboard daily for new critical vulnerabilities</li>
                            <li>Focus on CVEs with active exploits and high device exposure</li>
                            <li>Use Intune integration for automated remediation</li>
                            <li>Schedule weekly CSV exports for compliance reporting</li>
                            <li>Monitor Exposure Score trend to track security posture</li>
                        </ul>
                    </div>
                </div>

                <div class="flex-between mt-4">
                    <a href="features.html" class="btn btn-secondary">â† Features</a>
                    <a href="asr-rules.html" class="btn btn-primary">ASR Rules â†’</a>
                </div>
            </div>
        </div>
    </main>

    <footer class="footer">
        <div class="footer-content">
            <p class="footer-text">MDE Ultimate Guide | For Security Analysts & Engineers</p>
        </div>
    </footer>
    <script src="js/main.js"></script>
</body>
</html>
